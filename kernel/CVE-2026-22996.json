{
    "CVE-ID": "CVE-2026-22996",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/mlx5e: Don't store mlx5e_priv in mlx5e_dev devlink priv\n\nmlx5e_priv is an unstable structure that can be memset(0) if profile\nattaching fails, mlx5e_priv in mlx5e_dev devlink private is used to\nreference the netdev and mdev associated with that struct. Instead,\nstore netdev directly into mlx5e_dev and get mdev from the containing\nmlx5_adev aux device structure.\n\nThis fixes a kernel oops in mlx5e_remove when switchdev mode fails due\nto change profile failure.\n\n$ devlink dev eswitch set pci/0000:00:03.0 mode switchdev\nError: mlx5_core: Failed setting eswitch to offloads.\ndmesg:\nworkqueue: Failed to create a rescuer kthread for wq \"mlx5e\": -EINTR\nmlx5_core 0012:03:00.1: mlx5e_netdev_init_profile:6214:(pid 37199): mlx5e_priv_init failed, err=-12\nmlx5_core 0012:03:00.1 gpu3rdma1: mlx5e_netdev_change_profile: new profile init failed, -12\nworkqueue: Failed to create a rescuer kthread for wq \"mlx5e\": -EINTR\nmlx5_core 0012:03:00.1: mlx5e_netdev_init_profile:6214:(pid 37199): mlx5e_priv_init failed, err=-12\nmlx5_core 0012:03:00.1 gpu3rdma1: mlx5e_netdev_change_profile: failed to rollback to orig profile, -12\n\n$ devlink dev reload pci/0000:00:03.0 ==> oops\n\nBUG: kernel NULL pointer dereference, address: 0000000000000520\n #PF: supervisor read access in kernel mode\n #PF: error_code(0x0000) - not-present page\nPGD 0 P4D 0\nOops: Oops: 0000 [#1] SMP NOPTI\nCPU: 3 UID: 0 PID: 521 Comm: devlink Not tainted 6.18.0-rc5+ #117 PREEMPT(voluntary)\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-2.fc40 04/01/2014\nRIP: 0010:mlx5e_remove+0x68/0x130\nRSP: 0018:ffffc900034838f0 EFLAGS: 00010246\nRAX: ffff88810283c380 RBX: ffff888101874400 RCX: ffffffff826ffc45\nRDX: 0000000000000000 RSI: 0000000000000001 RDI: 0000000000000000\nRBP: ffff888102d789c0 R08: ffff8881007137f0 R09: ffff888100264e10\nR10: ffffc90003483898 R11: ffffc900034838a0 R12: ffff888100d261a0\nR13: ffff888100d261a0 R14: ffff8881018749a0 R15: ffff888101874400\nFS:  00007f8565fea740(0000) GS:ffff88856a759000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 0000000000000520 CR3: 000000010b11a004 CR4: 0000000000370ef0\nCall Trace:\n <TASK>\n device_release_driver_internal+0x19c/0x200\n bus_remove_device+0xc6/0x130\n device_del+0x160/0x3d0\n ? devl_param_driverinit_value_get+0x2d/0x90\n mlx5_detach_device+0x89/0xe0\n mlx5_unload_one_devl_locked+0x3a/0x70\n mlx5_devlink_reload_down+0xc8/0x220\n devlink_reload+0x7d/0x260\n devlink_nl_reload_doit+0x45b/0x5a0\n genl_family_rcv_msg_doit+0xe8/0x140",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.19:rc5",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.19:rc5:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.19:rc4",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.19:rc4:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.19:rc3",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.19:rc3:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.19:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.19:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.19:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.19:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.12",
                "VersionEndExcluding": "6.12.67",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.13",
                "VersionEndExcluding": "6.18.7",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "6.12.67": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.67"
            ]
        },
        "6.18.7": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.18.7"
            ]
        },
        "6.19": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.19"
            ]
        },
        "commit": {
            "net/mlx5e: Don't store mlx5e_priv in mlx5e_dev devlink priv": [
                {
                    "description": "net/mlx5e: Don't store mlx5e_priv in mlx5e_dev devlink priv",
                    "commit": "dcb2ad755a16cb0ecd2dc98234d71a6e216ae7fe",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.67",
                    "version": "6.12.67",
                    "upstream_commit": "123eda2e5b1638e298e3a66bb1e64a8da92de5e1",
                    "fixed": [
                        {
                            "fixed_commit": "ee75f1fc44dd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.3",
                            "fixed_commit_version": "6.3",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "c4d7eb57687f",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.12",
                            "fixed_commit_version": "5.12",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net/mlx5e: Don't store mlx5e_priv in mlx5e_dev devlink priv",
                    "commit": "a3d4f87d41f5140f1cf5c02fce5cdad2637f6244",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.18.7",
                    "version": "6.18.7",
                    "upstream_commit": "123eda2e5b1638e298e3a66bb1e64a8da92de5e1",
                    "fixed": [
                        {
                            "fixed_commit": "ee75f1fc44dd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.3",
                            "fixed_commit_version": "6.3",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "c4d7eb57687f",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.12",
                            "fixed_commit_version": "5.12",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net/mlx5e: Don't store mlx5e_priv in mlx5e_dev devlink priv",
                    "commit": "123eda2e5b1638e298e3a66bb1e64a8da92de5e1",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.19",
                    "version": "6.19",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "ee75f1fc44dd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.3",
                            "fixed_commit_version": "6.3",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "c4d7eb57687f",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.12",
                            "fixed_commit_version": "5.12",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}