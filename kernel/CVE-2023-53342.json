{
    "CVE-ID": "CVE-2023-53342",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: marvell: prestera: fix handling IPv4 routes with nhid\n\nFix handling IPv4 routes referencing a nexthop via its id by replacing\ncalls to fib_info_nh() with fib_info_nhc().\n\nTrying to add an IPv4 route referencing a nextop via nhid:\n\n    $ ip link set up swp5\n    $ ip a a 10.0.0.1/24 dev swp5\n    $ ip nexthop add dev swp5 id 20 via 10.0.0.2\n    $ ip route add 10.0.1.0/24 nhid 20\n\ntriggers warnings when trying to handle the route:\n\n[  528.805763] ------------[ cut here ]------------\n[  528.810437] WARNING: CPU: 3 PID: 53 at include/net/nexthop.h:468 __prestera_fi_is_direct+0x2c/0x68 [prestera]\n[  528.820434] Modules linked in: prestera_pci act_gact act_police sch_ingress cls_u32 cls_flower prestera arm64_delta_tn48m_dn_led(O) arm64_delta_tn48m_dn_cpld(O) [last unloaded: prestera_pci]\n[  528.837485] CPU: 3 PID: 53 Comm: kworker/u8:3 Tainted: G           O       6.4.5 #1\n[  528.845178] Hardware name: delta,tn48m-dn (DT)\n[  528.849641] Workqueue: prestera_ordered __prestera_router_fib_event_work [prestera]\n[  528.857352] pstate: 60000005 (nZCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)\n[  528.864347] pc : __prestera_fi_is_direct+0x2c/0x68 [prestera]\n[  528.870135] lr : prestera_k_arb_fib_evt+0xb20/0xd50 [prestera]\n[  528.876007] sp : ffff80000b20bc90\n[  528.879336] x29: ffff80000b20bc90 x28: 0000000000000000 x27: ffff0001374d3a48\n[  528.886510] x26: ffff000105604000 x25: ffff000134af8a28 x24: ffff0001374d3800\n[  528.893683] x23: ffff000101c89148 x22: ffff000101c89000 x21: ffff000101c89200\n[  528.900855] x20: ffff00013641fda0 x19: ffff800009d01088 x18: 0000000000000059\n[  528.908027] x17: 0000000000000277 x16: 0000000000000000 x15: 0000000000000000\n[  528.915198] x14: 0000000000000003 x13: 00000000000fe400 x12: 0000000000000000\n[  528.922371] x11: 0000000000000002 x10: 0000000000000aa0 x9 : ffff8000013d2020\n[  528.929543] x8 : 0000000000000018 x7 : 000000007b1703f8 x6 : 000000001ca72f86\n[  528.936715] x5 : 0000000033399ea7 x4 : 0000000000000000 x3 : ffff0001374d3acc\n[  528.943886] x2 : 0000000000000000 x1 : ffff00010200de00 x0 : ffff000134ae3f80\n[  528.951058] Call trace:\n[  528.953516]  __prestera_fi_is_direct+0x2c/0x68 [prestera]\n[  528.958952]  __prestera_router_fib_event_work+0x100/0x158 [prestera]\n[  528.965348]  process_one_work+0x208/0x488\n[  528.969387]  worker_thread+0x4c/0x430\n[  528.973068]  kthread+0x120/0x138\n[  528.976313]  ret_from_fork+0x10/0x20\n[  528.979909] ---[ end trace 0000000000000000 ]---\n[  528.984998] ------------[ cut here ]------------\n[  528.989645] WARNING: CPU: 3 PID: 53 at include/net/nexthop.h:468 __prestera_fi_is_direct+0x2c/0x68 [prestera]\n[  528.999628] Modules linked in: prestera_pci act_gact act_police sch_ingress cls_u32 cls_flower prestera arm64_delta_tn48m_dn_led(O) arm64_delta_tn48m_dn_cpld(O) [last unloaded: prestera_pci]\n[  529.016676] CPU: 3 PID: 53 Comm: kworker/u8:3 Tainted: G        W  O       6.4.5 #1\n[  529.024368] Hardware name: delta,tn48m-dn (DT)\n[  529.028830] Workqueue: prestera_ordered __prestera_router_fib_event_work [prestera]\n[  529.036539] pstate: 60000005 (nZCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)\n[  529.043533] pc : __prestera_fi_is_direct+0x2c/0x68 [prestera]\n[  529.049318] lr : __prestera_k_arb_fc_apply+0x280/0x2f8 [prestera]\n[  529.055452] sp : ffff80000b20bc60\n[  529.058781] x29: ffff80000b20bc60 x28: 0000000000000000 x27: ffff0001374d3a48\n[  529.065953] x26: ffff000105604000 x25: ffff000134af8a28 x24: ffff0001374d3800\n[  529.073126] x23: ffff000101c89148 x22: ffff000101c89148 x21: ffff00013641fda0\n[  529.080299] x20: ffff000101c89000 x19: ffff000101c89020 x18: 0000000000000059\n[  529.087471] x17: 0000000000000277 x16: 0000000000000000 x15: 0000000000000000\n[  529.094642] x14: 0000000000000003 x13: 00000000000fe400 x12: 0000000000000000\n[  529.101814] x11: 0000000000000002 x10: 0000000000000aa0 x9 : ffff8000013cee80\n[  529.108985] x8 : 0000000000000018 x7 : 000000007b1703f8 x6 \n---truncated---",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.5:rc5",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.5:rc5:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.5:rc4",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.5:rc4:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.5:rc3",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.5:rc3:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.5:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.5:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.5:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.5:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.1",
                "VersionEndExcluding": "6.1.46",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.4.11",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "6.1.46": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.46"
            ]
        },
        "6.4.11": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.4.11"
            ]
        },
        "6.5": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.5"
            ]
        },
        "commit": {
            "net: marvell: prestera: fix handling IPv4 routes with nhid": [
                {
                    "description": "net: marvell: prestera: fix handling IPv4 routes with nhid",
                    "commit": "a3e5f3b7f25d7b90f3b76d98a946fec6e5f79216",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.46",
                    "version": "6.1.46",
                    "upstream_commit": "2aa71b4b294ee2c3041d085404cea914be9b3225",
                    "fixed": [
                        {
                            "fixed_commit": "396b80cb5cc8",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1",
                            "fixed_commit_version": "6.1",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: marvell: prestera: fix handling IPv4 routes with nhid",
                    "commit": "8373dca3c1f8a203cecebe3421dbe890c4f08e16",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.4.11",
                    "version": "6.4.11",
                    "upstream_commit": "2aa71b4b294ee2c3041d085404cea914be9b3225",
                    "fixed": [
                        {
                            "fixed_commit": "396b80cb5cc8",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1",
                            "fixed_commit_version": "6.1",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: marvell: prestera: fix handling IPv4 routes with nhid",
                    "commit": "2aa71b4b294ee2c3041d085404cea914be9b3225",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.5",
                    "version": "6.5",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "396b80cb5cc8",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1",
                            "fixed_commit_version": "6.1",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}