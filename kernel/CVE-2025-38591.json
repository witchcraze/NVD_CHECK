{
    "CVE-ID": "CVE-2025-38591",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Reject narrower access to pointer ctx fields\n\nThe following BPF program, simplified from a syzkaller repro, causes a\nkernel warning:\n\n    r0 = *(u8 *)(r1 + 169);\n    exit;\n\nWith pointer field sk being at offset 168 in __sk_buff. This access is\ndetected as a narrower read in bpf_skb_is_valid_access because it\ndoesn't match offsetof(struct __sk_buff, sk). It is therefore allowed\nand later proceeds to bpf_convert_ctx_access. Note that for the\n\"is_narrower_load\" case in the convert_ctx_accesses(), the insn->off\nis aligned, so the cnt may not be 0 because it matches the\noffsetof(struct __sk_buff, sk) in the bpf_convert_ctx_access. However,\nthe target_size stays 0 and the verifier errors with a kernel warning:\n\n    verifier bug: error during ctx access conversion(1)\n\nThis patch fixes that to return a proper \"invalid bpf_context access\noff=X size=Y\" error on the load instruction.\n\nThe same issue affects multiple other fields in context structures that\nallow narrow access. Some other non-affected fields (for sk_msg,\nsk_lookup, and sockopt) were also changed to use bpf_ctx_range_ptr for\nconsistency.\n\nNote this syzkaller crash was reported in the \"Closes\" link below, which\nused to be about a different bug, fixed in\ncommit fce7bd8e385a (\"bpf/verifier: Handle BPF_LOAD_ACQ instructions\nin insn_def_regno()\"). Because syzbot somehow confused the two bugs,\nthe new crash and repro didn't get reported to the mailing list.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.13",
                "VersionEndExcluding": "6.16.1",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "6.12.67": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.67"
            ]
        },
        "6.16.1": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.16.1"
            ]
        },
        "6.17": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.17"
            ]
        },
        "commit": {
            "bpf: Reject narrower access to pointer ctx fields": [
                {
                    "description": "bpf: Reject narrower access to pointer ctx fields",
                    "commit": "058a0da4f6d916a79b693384111bb80a90d73763",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.67",
                    "version": "6.12.67",
                    "upstream_commit": "e09299225d5ba3916c91ef70565f7d2187e4cca0",
                    "fixed": [
                        {
                            "fixed_commit": "f96da09473b5",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/f96da09473b5",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "0df1a55afa83",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.17",
                            "fixed_commit_version": "6.17",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "bpf: Reject narrower access to pointer ctx fields",
                    "commit": "202900ceeef67458c964c2af6e1427c8e533ea7c",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.16.1",
                    "version": "6.16.1",
                    "upstream_commit": "e09299225d5ba3916c91ef70565f7d2187e4cca0",
                    "fixed": [
                        {
                            "fixed_commit": "f96da09473b5",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/f96da09473b5",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "0df1a55afa83",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.17",
                            "fixed_commit_version": "6.17",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "bpf: Reject narrower access to pointer ctx fields",
                    "commit": "e09299225d5ba3916c91ef70565f7d2187e4cca0",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.17",
                    "version": "6.17",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "f96da09473b5",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/f96da09473b5",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "0df1a55afa83",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.17",
                            "fixed_commit_version": "6.17",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}