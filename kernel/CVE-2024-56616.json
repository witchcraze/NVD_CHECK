{
    "CVE-ID": "CVE-2024-56616",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/dp_mst: Fix MST sideband message body length check\n\nFix the MST sideband message body length check, which must be at least 1\nbyte accounting for the message body CRC (aka message data CRC) at the\nend of the message.\n\nThis fixes a case where an MST branch device returns a header with a\ncorrect header CRC (indicating a correctly received body length), with\nthe body length being incorrectly set to 0. This will later lead to a\nmemory corruption in drm_dp_sideband_append_payload() and the following\nerrors in dmesg:\n\n   UBSAN: array-index-out-of-bounds in drivers/gpu/drm/display/drm_dp_mst_topology.c:786:25\n   index -1 is out of range for type 'u8 [48]'\n   Call Trace:\n    drm_dp_sideband_append_payload+0x33d/0x350 [drm_display_helper]\n    drm_dp_get_one_sb_msg+0x3ce/0x5f0 [drm_display_helper]\n    drm_dp_mst_hpd_irq_handle_event+0xc8/0x1580 [drm_display_helper]\n\n   memcpy: detected field-spanning write (size 18446744073709551615) of single field \"&msg->msg[msg->curlen]\" at drivers/gpu/drm/display/drm_dp_mst_topology.c:791 (size 256)\n   Call Trace:\n    drm_dp_sideband_append_payload+0x324/0x350 [drm_display_helper]\n    drm_dp_get_one_sb_msg+0x3ce/0x5f0 [drm_display_helper]\n    drm_dp_mst_hpd_irq_handle_event+0xc8/0x1580 [drm_display_helper]",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 7.8,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.13:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "5.10.233",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.176",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.1.120",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.6.66",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.7",
                "VersionEndExcluding": "6.12.5",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.10.233": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.233"
            ]
        },
        "5.15.176": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.176"
            ]
        },
        "6.1.120": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.120"
            ]
        },
        "6.12.5": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.5"
            ]
        },
        "6.13": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.13"
            ]
        },
        "6.6.66": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.66"
            ]
        },
        "commit": {
            "drm/dp_mst: Fix MST sideband message body length check": [
                {
                    "description": "drm/dp_mst: Fix MST sideband message body length check",
                    "commit": "109f91d8b9335b0f3714ef9920eae5a8b21d56af",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.233",
                    "version": "5.10.233",
                    "upstream_commit": "bd2fccac61b40eaf08d9546acc9fef958bfe4763",
                    "fixed": []
                },
                {
                    "description": "drm/dp_mst: Fix MST sideband message body length check",
                    "commit": "70e7166612f4e6da8d7d0305c47c465d88d037e5",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.176",
                    "version": "5.15.176",
                    "upstream_commit": "bd2fccac61b40eaf08d9546acc9fef958bfe4763",
                    "fixed": []
                },
                {
                    "description": "drm/dp_mst: Fix MST sideband message body length check",
                    "commit": "780fa184d4dc38ad6c4fded345ab8f9be7a63e96",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.120",
                    "version": "6.1.120",
                    "upstream_commit": "bd2fccac61b40eaf08d9546acc9fef958bfe4763",
                    "fixed": []
                },
                {
                    "description": "drm/dp_mst: Fix MST sideband message body length check",
                    "commit": "1fc1f32c4a3421b9d803f18ec3ef49db2fb5d5ef",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.5",
                    "version": "6.12.5",
                    "upstream_commit": "bd2fccac61b40eaf08d9546acc9fef958bfe4763",
                    "fixed": []
                },
                {
                    "description": "drm/dp_mst: Fix MST sideband message body length check",
                    "commit": "bd2fccac61b40eaf08d9546acc9fef958bfe4763",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.13",
                    "version": "6.13",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "1da177e4c3f4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v2.6/ChangeLog-2.6.12",
                            "fixed_commit_version": "2.6.12",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "drm/dp_mst: Fix MST sideband message body length check",
                    "commit": "c58947a8d4a500902597ee1dbadf0518d7ff8801",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.66",
                    "version": "6.6.66",
                    "upstream_commit": "bd2fccac61b40eaf08d9546acc9fef958bfe4763",
                    "fixed": []
                }
            ]
        }
    }
}