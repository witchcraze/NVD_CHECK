{
    "CVE-ID": "CVE-2023-53333",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: conntrack: dccp: copy entire header to stack buffer, not just basic one\n\nEric Dumazet says:\n  nf_conntrack_dccp_packet() has an unique:\n\n  dh = skb_header_pointer(skb, dataoff, sizeof(_dh), &_dh);\n\n  And nothing more is 'pulled' from the packet, depending on the content.\n  dh->dccph_doff, and/or dh->dccph_x ...)\n  So dccp_ack_seq() is happily reading stuff past the _dh buffer.\n\nBUG: KASAN: stack-out-of-bounds in nf_conntrack_dccp_packet+0x1134/0x11c0\nRead of size 4 at addr ffff000128f66e0c by task syz-executor.2/29371\n[..]\n\nFix this by increasing the stack buffer to also include room for\nthe extra sequence numbers and all the known dccp packet type headers,\nthen pull again after the initial validation of the basic header.\n\nWhile at it, mark packets invalid that lack 48bit sequence bit but\nwhere RFC says the type MUST use them.\n\nCompile tested only.\n\nv2: first skb_header_pointer() now needs to adjust the size to\n    only pull the generic header. (Eric)\n\nHeads-up: I intend to remove dccp conntrack support later this year.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 7.1,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "2.6.26",
                "VersionEndExcluding": "5.4.251",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.121",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.1.39",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.5",
                "VersionEndExcluding": "5.10.188",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.3.13",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.4",
                "VersionEndExcluding": "6.4.4",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.10.188": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.188"
            ]
        },
        "5.15.121": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.121"
            ]
        },
        "5.4.251": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.251"
            ]
        },
        "6.1.39": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.39"
            ]
        },
        "6.3.13": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.3.13"
            ]
        },
        "6.4.4": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.4.4"
            ]
        },
        "6.5": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.5"
            ]
        },
        "commit": {
            "netfilter: conntrack: dccp: copy entire header to stack buffer, not just basic one": [
                {
                    "description": "netfilter: conntrack: dccp: copy entire header to stack buffer, not just basic one",
                    "commit": "9bdcda7abaf22f6453e5b5efb7eb4e524095d5d8",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.188",
                    "version": "5.10.188",
                    "upstream_commit": "ff0a3a7d52ff7282dbd183e7fc29a1fe386b0c30",
                    "fixed": [
                        {
                            "fixed_commit": "2bc780499aa3",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/2bc780499aa3",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "netfilter: conntrack: dccp: copy entire header to stack buffer, not just basic one",
                    "commit": "c052797ac36813419ad3bfa54cb8615db4b41f15",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.121",
                    "version": "5.15.121",
                    "upstream_commit": "ff0a3a7d52ff7282dbd183e7fc29a1fe386b0c30",
                    "fixed": [
                        {
                            "fixed_commit": "2bc780499aa3",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/2bc780499aa3",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "netfilter: conntrack: dccp: copy entire header to stack buffer, not just basic one",
                    "commit": "337fdce450637ea663bc816edc2ba81e5cdad02e",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.251",
                    "version": "5.4.251",
                    "upstream_commit": "ff0a3a7d52ff7282dbd183e7fc29a1fe386b0c30",
                    "fixed": [
                        {
                            "fixed_commit": "2bc780499aa3",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/2bc780499aa3",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "netfilter: conntrack: dccp: copy entire header to stack buffer, not just basic one",
                    "commit": "5c618daa5038712c4a4ef8923905a2ea1b8836a1",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.39",
                    "version": "6.1.39",
                    "upstream_commit": "ff0a3a7d52ff7282dbd183e7fc29a1fe386b0c30",
                    "fixed": [
                        {
                            "fixed_commit": "2bc780499aa3",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/2bc780499aa3",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "netfilter: conntrack: dccp: copy entire header to stack buffer, not just basic one",
                    "commit": "26bd1f210d3783a691052c51d76bb8a8bbd24c67",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.3.13",
                    "version": "6.3.13",
                    "upstream_commit": "ff0a3a7d52ff7282dbd183e7fc29a1fe386b0c30",
                    "fixed": [
                        {
                            "fixed_commit": "2bc780499aa3",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/2bc780499aa3",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "netfilter: conntrack: dccp: copy entire header to stack buffer, not just basic one",
                    "commit": "8c0980493beed3a80d6329c44ab293dc8c032927",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.4.4",
                    "version": "6.4.4",
                    "upstream_commit": "ff0a3a7d52ff7282dbd183e7fc29a1fe386b0c30",
                    "fixed": [
                        {
                            "fixed_commit": "2bc780499aa3",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/2bc780499aa3",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "netfilter: conntrack: dccp: copy entire header to stack buffer, not just basic one",
                    "commit": "ff0a3a7d52ff7282dbd183e7fc29a1fe386b0c30",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.5",
                    "version": "6.5",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "2bc780499aa3",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/2bc780499aa3",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}