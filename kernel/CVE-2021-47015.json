{
    "CVE-ID": "CVE-2021-47015",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nbnxt_en: Fix RX consumer index logic in the error path.\n\nIn bnxt_rx_pkt(), the RX buffers are expected to complete in order.\nIf the RX consumer index indicates an out of order buffer completion,\nit means we are hitting a hardware bug and the driver will abort all\nremaining RX packets and reset the RX ring.  The RX consumer index\nthat we pass to bnxt_discard_rx() is not correct.  We should be\npassing the current index (tmp_raw_cons) instead of the old index\n(raw_cons).  This bug can cause us to be at the wrong index when\ntrying to abort the next RX packet.  It can crash like this:\n\n #0 [ffff9bbcdf5c39a8] machine_kexec at ffffffff9b05e007\n #1 [ffff9bbcdf5c3a00] __crash_kexec at ffffffff9b111232\n #2 [ffff9bbcdf5c3ad0] panic at ffffffff9b07d61e\n #3 [ffff9bbcdf5c3b50] oops_end at ffffffff9b030978\n #4 [ffff9bbcdf5c3b78] no_context at ffffffff9b06aaf0\n #5 [ffff9bbcdf5c3bd8] __bad_area_nosemaphore at ffffffff9b06ae2e\n #6 [ffff9bbcdf5c3c28] bad_area_nosemaphore at ffffffff9b06af24\n #7 [ffff9bbcdf5c3c38] __do_page_fault at ffffffff9b06b67e\n #8 [ffff9bbcdf5c3cb0] do_page_fault at ffffffff9b06bb12\n #9 [ffff9bbcdf5c3ce0] page_fault at ffffffff9bc015c5\n    [exception RIP: bnxt_rx_pkt+237]\n    RIP: ffffffffc0259cdd  RSP: ffff9bbcdf5c3d98  RFLAGS: 00010213\n    RAX: 000000005dd8097f  RBX: ffff9ba4cb11b7e0  RCX: ffffa923cf6e9000\n    RDX: 0000000000000fff  RSI: 0000000000000627  RDI: 0000000000001000\n    RBP: ffff9bbcdf5c3e60   R8: 0000000000420003   R9: 000000000000020d\n    R10: ffffa923cf6ec138  R11: ffff9bbcdf5c3e83  R12: ffff9ba4d6f928c0\n    R13: ffff9ba4cac28080  R14: ffff9ba4cb11b7f0  R15: ffff9ba4d5a30000\n    ORIG_RAX: ffffffffffffffff  CS: 0010  SS: 0018",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.1",
                "VersionEndExcluding": "5.4.119",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.11.21",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.12",
                "VersionEndExcluding": "5.12.4",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.5",
                "VersionEndExcluding": "5.10.37",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.10.37": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.37"
            ]
        },
        "5.11.21": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11.21"
            ]
        },
        "5.12.4": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.12.4"
            ]
        },
        "5.13": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.13"
            ]
        },
        "5.4.119": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.119"
            ]
        },
        "commit": {
            "bnxt_en: Fix RX consumer index logic in the error path.": [
                {
                    "description": "bnxt_en: Fix RX consumer index logic in the error path.",
                    "commit": "4fcaad2b7dac3f16704f8118c7e481024ddbd3ed",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.37",
                    "version": "5.10.37",
                    "upstream_commit": "bbd6f0a948139970f4a615dff189d9a503681a39",
                    "fixed": [
                        {
                            "fixed_commit": "a1b0e4e684e9",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1",
                            "fixed_commit_version": "5.1",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "46281ee85b65",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.14.112",
                            "fixed_commit_version": "4.14.112",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        },
                        {
                            "fixed_commit": "d2d055a55403",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.35",
                            "fixed_commit_version": "4.19.35",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        },
                        {
                            "fixed_commit": "8e302e8e10b0",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.9.169",
                            "fixed_commit_version": "4.9.169",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        },
                        {
                            "fixed_commit": "aecbbae850ed",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.0.8",
                            "fixed_commit_version": "5.0.8",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        }
                    ]
                },
                {
                    "description": "bnxt_en: Fix RX consumer index logic in the error path.",
                    "commit": "e187ef83c04a5d23e68d39cfdff1a1931e29890c",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11.21",
                    "version": "5.11.21",
                    "upstream_commit": "bbd6f0a948139970f4a615dff189d9a503681a39",
                    "fixed": [
                        {
                            "fixed_commit": "a1b0e4e684e9",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1",
                            "fixed_commit_version": "5.1",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "46281ee85b65",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.14.112",
                            "fixed_commit_version": "4.14.112",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        },
                        {
                            "fixed_commit": "d2d055a55403",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.35",
                            "fixed_commit_version": "4.19.35",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        },
                        {
                            "fixed_commit": "8e302e8e10b0",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.9.169",
                            "fixed_commit_version": "4.9.169",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        },
                        {
                            "fixed_commit": "aecbbae850ed",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.0.8",
                            "fixed_commit_version": "5.0.8",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        }
                    ]
                },
                {
                    "description": "bnxt_en: Fix RX consumer index logic in the error path.",
                    "commit": "3fbc5bc651d688fbea2a59cdc91520a2f5334d0a",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.12.4",
                    "version": "5.12.4",
                    "upstream_commit": "bbd6f0a948139970f4a615dff189d9a503681a39",
                    "fixed": [
                        {
                            "fixed_commit": "a1b0e4e684e9",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1",
                            "fixed_commit_version": "5.1",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "46281ee85b65",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.14.112",
                            "fixed_commit_version": "4.14.112",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        },
                        {
                            "fixed_commit": "d2d055a55403",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.35",
                            "fixed_commit_version": "4.19.35",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        },
                        {
                            "fixed_commit": "8e302e8e10b0",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.9.169",
                            "fixed_commit_version": "4.9.169",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        },
                        {
                            "fixed_commit": "aecbbae850ed",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.0.8",
                            "fixed_commit_version": "5.0.8",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        }
                    ]
                },
                {
                    "description": "bnxt_en: Fix RX consumer index logic in the error path.",
                    "commit": "bbd6f0a948139970f4a615dff189d9a503681a39",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.13",
                    "version": "5.13",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "a1b0e4e684e9",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1",
                            "fixed_commit_version": "5.1",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "46281ee85b65",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.14.112",
                            "fixed_commit_version": "4.14.112",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        },
                        {
                            "fixed_commit": "d2d055a55403",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.35",
                            "fixed_commit_version": "4.19.35",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        },
                        {
                            "fixed_commit": "8e302e8e10b0",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.9.169",
                            "fixed_commit_version": "4.9.169",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        },
                        {
                            "fixed_commit": "aecbbae850ed",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.0.8",
                            "fixed_commit_version": "5.0.8",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        }
                    ]
                },
                {
                    "description": "bnxt_en: Fix RX consumer index logic in the error path.",
                    "commit": "b1523e4ba293b2a32d9fabaf70c1dcaa6e3e2847",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.119",
                    "version": "5.4.119",
                    "upstream_commit": "bbd6f0a948139970f4a615dff189d9a503681a39",
                    "fixed": [
                        {
                            "fixed_commit": "a1b0e4e684e9",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1",
                            "fixed_commit_version": "5.1",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "46281ee85b65",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.14.112",
                            "fixed_commit_version": "4.14.112",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        },
                        {
                            "fixed_commit": "d2d055a55403",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.35",
                            "fixed_commit_version": "4.19.35",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        },
                        {
                            "fixed_commit": "8e302e8e10b0",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.9.169",
                            "fixed_commit_version": "4.9.169",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        },
                        {
                            "fixed_commit": "aecbbae850ed",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.0.8",
                            "fixed_commit_version": "5.0.8",
                            "fixed_commit_upstream_commit": "a1b0e4e684e9c300b9e759b46cb7a0147e61ddff"
                        }
                    ]
                }
            ]
        }
    }
}