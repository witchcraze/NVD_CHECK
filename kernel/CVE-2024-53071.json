{
    "CVE-ID": "CVE-2024-53071",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/panthor: Be stricter about IO mapping flags\n\nThe current panthor_device_mmap_io() implementation has two issues:\n\n1. For mapping DRM_PANTHOR_USER_FLUSH_ID_MMIO_OFFSET,\n   panthor_device_mmap_io() bails if VM_WRITE is set, but does not clear\n   VM_MAYWRITE. That means userspace can use mprotect() to make the mapping\n   writable later on. This is a classic Linux driver gotcha.\n   I don't think this actually has any impact in practice:\n   When the GPU is powered, writes to the FLUSH_ID seem to be ignored; and\n   when the GPU is not powered, the dummy_latest_flush page provided by the\n   driver is deliberately designed to not do any flushes, so the only thing\n   writing to the dummy_latest_flush could achieve would be to make *more*\n   flushes happen.\n\n2. panthor_device_mmap_io() does not block MAP_PRIVATE mappings (which are\n   mappings without the VM_SHARED flag).\n   MAP_PRIVATE in combination with VM_MAYWRITE indicates that the VMA has\n   copy-on-write semantics, which for VM_PFNMAP are semi-supported but\n   fairly cursed.\n   In particular, in such a mapping, the driver can only install PTEs\n   during mmap() by calling remap_pfn_range() (because remap_pfn_range()\n   wants to **store the physical address of the mapped physical memory into\n   the vm_pgoff of the VMA**); installing PTEs later on with a fault\n   handler (as panthor does) is not supported in private mappings, and so\n   if you try to fault in such a mapping, vmf_insert_pfn_prot() splats when\n   it hits a BUG() check.\n\nFix it by clearing the VM_MAYWRITE flag (userspace writing to the FLUSH_ID\ndoesn't make sense) and requiring VM_SHARED (copy-on-write semantics for\nthe FLUSH_ID don't make sense).\n\nReproducers for both scenarios are in the notes of my patch on the mailing\nlist; I tested that these bugs exist on a Rock 5B machine.\n\nNote that I only compile-tested the patch, I haven't tested it; I don't\nhave a working kernel build setup for the test machine yet. Please test it\nbefore applying it.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc6",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc6:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc5",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc5:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc4",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc3",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.10",
                "VersionEndExcluding": "6.11.8",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "6.11.8": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.11.8"
            ]
        },
        "6.12": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12"
            ]
        },
        "commit": {
            "drm/panthor: Be stricter about IO mapping flags": [
                {
                    "description": "drm/panthor: Be stricter about IO mapping flags",
                    "commit": "2604afd65043e8f9d4be036cb1242adf6b5723cf",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.11.8",
                    "version": "6.11.8",
                    "upstream_commit": "f432a1621f049bb207e78363d9d0e3c6fa2da5db",
                    "fixed": [
                        {
                            "fixed_commit": "5fe909cae118",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.10",
                            "fixed_commit_version": "6.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "drm/panthor: Be stricter about IO mapping flags",
                    "commit": "f432a1621f049bb207e78363d9d0e3c6fa2da5db",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12",
                    "version": "6.12",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "5fe909cae118",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.10",
                            "fixed_commit_version": "6.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}