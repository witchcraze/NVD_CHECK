{
    "CVE-ID": "CVE-2022-49558",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nf_tables: double hook unregistration in netns path\n\n__nft_release_hooks() is called from pre_netns exit path which\nunregisters the hooks, then the NETDEV_UNREGISTER event is triggered\nwhich unregisters the hooks again.\n\n[  565.221461] WARNING: CPU: 18 PID: 193 at net/netfilter/core.c:495 __nf_unregister_net_hook+0x247/0x270\n[...]\n[  565.246890] CPU: 18 PID: 193 Comm: kworker/u64:1 Tainted: G            E     5.18.0-rc7+ #27\n[  565.253682] Workqueue: netns cleanup_net\n[  565.257059] RIP: 0010:__nf_unregister_net_hook+0x247/0x270\n[...]\n[  565.297120] Call Trace:\n[  565.300900]  <TASK>\n[  565.304683]  nf_tables_flowtable_event+0x16a/0x220 [nf_tables]\n[  565.308518]  raw_notifier_call_chain+0x63/0x80\n[  565.312386]  unregister_netdevice_many+0x54f/0xb50\n\nUnregister and destroy netdev hook from netns pre_exit via kfree_rcu\nso the NETDEV_UNREGISTER path see unregistered hooks.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:5.11:-",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.11:-:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.10.17",
                "VersionEndExcluding": "5.10.198",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11.1",
                "VersionEndExcluding": "5.15.45",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "5.17.13",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.18",
                "VersionEndExcluding": "5.18.2",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.4.99",
                "VersionEndExcluding": "5.4.262",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "4.19.316": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.316"
            ]
        },
        "5.10.198": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.198"
            ]
        },
        "5.15.45": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.45"
            ]
        },
        "5.17.13": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17.13"
            ]
        },
        "5.18.2": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.18.2"
            ]
        },
        "5.19": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19"
            ]
        },
        "5.4.262": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.262"
            ]
        },
        "commit": {
            "netfilter: nf_tables: double hook unregistration in netns path": [
                {
                    "description": "netfilter: nf_tables: double hook unregistration in netns path",
                    "commit": "c73955a09408e7374d9abfd0e78ce3de9cda0635",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.316",
                    "version": "4.19.316",
                    "upstream_commit": "f9a43007d3f7ba76d5e7f9421094f00f2ef202f8",
                    "fixed": [
                        {
                            "fixed_commit": "767d1216bff8",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "0a0e5d47670b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.17",
                            "fixed_commit_version": "5.10.17",
                            "fixed_commit_upstream_commit": "767d1216bff82507c945e92fe719dff2083bb2f4"
                        },
                        {
                            "fixed_commit": "b110391d1e80",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.99",
                            "fixed_commit_version": "5.4.99",
                            "fixed_commit_upstream_commit": "767d1216bff82507c945e92fe719dff2083bb2f4"
                        }
                    ]
                },
                {
                    "description": "netfilter: nf_tables: double hook unregistration in netns path",
                    "commit": "3fac8ce48fa9fd61ee9056d3ed48b2edefca8b82",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.198",
                    "version": "5.10.198",
                    "upstream_commit": "f9a43007d3f7ba76d5e7f9421094f00f2ef202f8",
                    "fixed": [
                        {
                            "fixed_commit": "767d1216bff8",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "0a0e5d47670b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.17",
                            "fixed_commit_version": "5.10.17",
                            "fixed_commit_upstream_commit": "767d1216bff82507c945e92fe719dff2083bb2f4"
                        },
                        {
                            "fixed_commit": "b110391d1e80",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.99",
                            "fixed_commit_version": "5.4.99",
                            "fixed_commit_upstream_commit": "767d1216bff82507c945e92fe719dff2083bb2f4"
                        }
                    ]
                },
                {
                    "description": "netfilter: nf_tables: double hook unregistration in netns path",
                    "commit": "9c413a8c8bb49cc16796371805ecb260e885bb2b",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.45",
                    "version": "5.15.45",
                    "upstream_commit": "f9a43007d3f7ba76d5e7f9421094f00f2ef202f8",
                    "fixed": [
                        {
                            "fixed_commit": "767d1216bff8",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "0a0e5d47670b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.17",
                            "fixed_commit_version": "5.10.17",
                            "fixed_commit_upstream_commit": "767d1216bff82507c945e92fe719dff2083bb2f4"
                        },
                        {
                            "fixed_commit": "b110391d1e80",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.99",
                            "fixed_commit_version": "5.4.99",
                            "fixed_commit_upstream_commit": "767d1216bff82507c945e92fe719dff2083bb2f4"
                        }
                    ]
                },
                {
                    "description": "netfilter: nf_tables: double hook unregistration in netns path",
                    "commit": "a3940dcf552f2393d1e8f263b386593f98abe829",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17.13",
                    "version": "5.17.13",
                    "upstream_commit": "f9a43007d3f7ba76d5e7f9421094f00f2ef202f8",
                    "fixed": [
                        {
                            "fixed_commit": "767d1216bff8",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "0a0e5d47670b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.17",
                            "fixed_commit_version": "5.10.17",
                            "fixed_commit_upstream_commit": "767d1216bff82507c945e92fe719dff2083bb2f4"
                        },
                        {
                            "fixed_commit": "b110391d1e80",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.99",
                            "fixed_commit_version": "5.4.99",
                            "fixed_commit_upstream_commit": "767d1216bff82507c945e92fe719dff2083bb2f4"
                        }
                    ]
                },
                {
                    "description": "netfilter: nf_tables: double hook unregistration in netns path",
                    "commit": "86c0154f4c3a56c5db8b9dd09e3ce885382c2c19",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.18.2",
                    "version": "5.18.2",
                    "upstream_commit": "f9a43007d3f7ba76d5e7f9421094f00f2ef202f8",
                    "fixed": [
                        {
                            "fixed_commit": "767d1216bff8",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "0a0e5d47670b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.17",
                            "fixed_commit_version": "5.10.17",
                            "fixed_commit_upstream_commit": "767d1216bff82507c945e92fe719dff2083bb2f4"
                        },
                        {
                            "fixed_commit": "b110391d1e80",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.99",
                            "fixed_commit_version": "5.4.99",
                            "fixed_commit_upstream_commit": "767d1216bff82507c945e92fe719dff2083bb2f4"
                        }
                    ]
                },
                {
                    "description": "netfilter: nf_tables: double hook unregistration in netns path",
                    "commit": "f9a43007d3f7ba76d5e7f9421094f00f2ef202f8",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19",
                    "version": "5.19",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "767d1216bff8",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "0a0e5d47670b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.17",
                            "fixed_commit_version": "5.10.17",
                            "fixed_commit_upstream_commit": "767d1216bff82507c945e92fe719dff2083bb2f4"
                        },
                        {
                            "fixed_commit": "b110391d1e80",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.99",
                            "fixed_commit_version": "5.4.99",
                            "fixed_commit_upstream_commit": "767d1216bff82507c945e92fe719dff2083bb2f4"
                        }
                    ]
                },
                {
                    "description": "netfilter: nf_tables: double hook unregistration in netns path",
                    "commit": "b09e6ccf0d12f9356e8e3508d3e3dce126298538",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.262",
                    "version": "5.4.262",
                    "upstream_commit": "f9a43007d3f7ba76d5e7f9421094f00f2ef202f8",
                    "fixed": [
                        {
                            "fixed_commit": "767d1216bff8",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "0a0e5d47670b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.17",
                            "fixed_commit_version": "5.10.17",
                            "fixed_commit_upstream_commit": "767d1216bff82507c945e92fe719dff2083bb2f4"
                        },
                        {
                            "fixed_commit": "b110391d1e80",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.99",
                            "fixed_commit_version": "5.4.99",
                            "fixed_commit_upstream_commit": "767d1216bff82507c945e92fe719dff2083bb2f4"
                        }
                    ]
                }
            ]
        }
    }
}