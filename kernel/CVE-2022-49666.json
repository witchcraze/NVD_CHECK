{
    "CVE-ID": "CVE-2022-49666",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\npowerpc/memhotplug: Add add_pages override for PPC\n\nWith commit ffa0b64e3be5 (\"powerpc: Fix virt_addr_valid() for 64-bit Book3E & 32-bit\")\nthe kernel now validate the addr against high_memory value. This results\nin the below BUG_ON with dax pfns.\n\n[  635.798741][T26531] kernel BUG at mm/page_alloc.c:5521!\n1:mon> e\ncpu 0x1: Vector: 700 (Program Check) at [c000000007287630]\n    pc: c00000000055ed48: free_pages.part.0+0x48/0x110\n    lr: c00000000053ca70: tlb_finish_mmu+0x80/0xd0\n    sp: c0000000072878d0\n   msr: 800000000282b033\n  current = 0xc00000000afabe00\n  paca    = 0xc00000037ffff300   irqmask: 0x03   irq_happened: 0x05\n    pid   = 26531, comm = 50-landscape-sy\nkernel BUG at :5521!\nLinux version 5.19.0-rc3-14659-g4ec05be7c2e1 (kvaneesh@ltc-boston8) (gcc (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0, GNU ld (GNU Binutils for Ubuntu) 2.34) #625 SMP Thu Jun 23 00:35:43 CDT 2022\n1:mon> t\n[link register   ] c00000000053ca70 tlb_finish_mmu+0x80/0xd0\n[c0000000072878d0] c00000000053ca54 tlb_finish_mmu+0x64/0xd0 (unreliable)\n[c000000007287900] c000000000539424 exit_mmap+0xe4/0x2a0\n[c0000000072879e0] c00000000019fc1c mmput+0xcc/0x210\n[c000000007287a20] c000000000629230 begin_new_exec+0x5e0/0xf40\n[c000000007287ae0] c00000000070b3cc load_elf_binary+0x3ac/0x1e00\n[c000000007287c10] c000000000627af0 bprm_execve+0x3b0/0xaf0\n[c000000007287cd0] c000000000628414 do_execveat_common.isra.0+0x1e4/0x310\n[c000000007287d80] c00000000062858c sys_execve+0x4c/0x60\n[c000000007287db0] c00000000002c1b0 system_call_exception+0x160/0x2c0\n[c000000007287e10] c00000000000c53c system_call_common+0xec/0x250\n\nThe fix is to make sure we update high_memory on memory hotplug.\nThis is similar to what x86 does in commit 3072e413e305 (\"mm/memory_hotplug: introduce add_pages\")",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:5.19:rc4",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.19:rc4:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:5.19:rc3",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.19:rc3:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:5.19:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.19:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:5.19:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.19:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:5.18:rc7",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.18:rc7:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:5.18:rc6",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.18:rc6:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:5.18:rc5",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.18:rc5:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:5.18:rc4",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.18:rc4:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:5.18:rc3",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.18:rc3:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:5.18:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.18:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:5.18:-",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.18:-:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.10.111",
                "VersionEndExcluding": "5.11",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.15.34",
                "VersionEndExcluding": "5.15.53",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16.20",
                "VersionEndExcluding": "5.17",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.17.3",
                "VersionEndExcluding": "5.18",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.18.1",
                "VersionEndExcluding": "5.18.10",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.4.190",
                "VersionEndExcluding": "5.5",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.15.53": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.53"
            ]
        },
        "5.18.10": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.18.10"
            ]
        },
        "5.19": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19"
            ]
        },
        "commit": {
            "powerpc/memhotplug: Add add_pages override for PPC": [
                {
                    "description": "powerpc/memhotplug: Add add_pages override for PPC",
                    "commit": "89296ac435e2cf8a5101f7fab8f0c7b754b92052",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.53",
                    "version": "5.15.53",
                    "upstream_commit": "ac790d09885d36143076e7e02825c541e8eee899",
                    "fixed": [
                        {
                            "fixed_commit": "ffa0b64e3be5",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.18",
                            "fixed_commit_version": "5.18",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "d36febbcd537",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.111",
                            "fixed_commit_version": "5.10.111",
                            "fixed_commit_upstream_commit": "ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
                        },
                        {
                            "fixed_commit": "fddb88bd266f",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.34",
                            "fixed_commit_version": "5.15.34",
                            "fixed_commit_upstream_commit": "ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
                        },
                        {
                            "fixed_commit": "a3727c25eacd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16.20",
                            "fixed_commit_version": "5.16.20",
                            "fixed_commit_upstream_commit": "ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
                        },
                        {
                            "fixed_commit": "cbc065efcba0",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17.3",
                            "fixed_commit_version": "5.17.3",
                            "fixed_commit_upstream_commit": "ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
                        },
                        {
                            "fixed_commit": "deab81144d5a",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.190",
                            "fixed_commit_version": "5.4.190",
                            "fixed_commit_upstream_commit": "ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
                        }
                    ]
                },
                {
                    "description": "powerpc/memhotplug: Add add_pages override for PPC",
                    "commit": "84d146fd35a01b08e9515041de60f0f915a417d5",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.18.10",
                    "version": "5.18.10",
                    "upstream_commit": "ac790d09885d36143076e7e02825c541e8eee899",
                    "fixed": [
                        {
                            "fixed_commit": "ffa0b64e3be5",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.18",
                            "fixed_commit_version": "5.18",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "d36febbcd537",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.111",
                            "fixed_commit_version": "5.10.111",
                            "fixed_commit_upstream_commit": "ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
                        },
                        {
                            "fixed_commit": "fddb88bd266f",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.34",
                            "fixed_commit_version": "5.15.34",
                            "fixed_commit_upstream_commit": "ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
                        },
                        {
                            "fixed_commit": "a3727c25eacd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16.20",
                            "fixed_commit_version": "5.16.20",
                            "fixed_commit_upstream_commit": "ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
                        },
                        {
                            "fixed_commit": "cbc065efcba0",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17.3",
                            "fixed_commit_version": "5.17.3",
                            "fixed_commit_upstream_commit": "ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
                        },
                        {
                            "fixed_commit": "deab81144d5a",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.190",
                            "fixed_commit_version": "5.4.190",
                            "fixed_commit_upstream_commit": "ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
                        }
                    ]
                },
                {
                    "description": "powerpc/memhotplug: Add add_pages override for PPC",
                    "commit": "ac790d09885d36143076e7e02825c541e8eee899",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19",
                    "version": "5.19",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "ffa0b64e3be5",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.18",
                            "fixed_commit_version": "5.18",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "d36febbcd537",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.111",
                            "fixed_commit_version": "5.10.111",
                            "fixed_commit_upstream_commit": "ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
                        },
                        {
                            "fixed_commit": "fddb88bd266f",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.34",
                            "fixed_commit_version": "5.15.34",
                            "fixed_commit_upstream_commit": "ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
                        },
                        {
                            "fixed_commit": "a3727c25eacd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16.20",
                            "fixed_commit_version": "5.16.20",
                            "fixed_commit_upstream_commit": "ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
                        },
                        {
                            "fixed_commit": "cbc065efcba0",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17.3",
                            "fixed_commit_version": "5.17.3",
                            "fixed_commit_upstream_commit": "ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
                        },
                        {
                            "fixed_commit": "deab81144d5a",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.190",
                            "fixed_commit_version": "5.4.190",
                            "fixed_commit_upstream_commit": "ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
                        }
                    ]
                }
            ]
        }
    }
}