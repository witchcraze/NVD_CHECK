{
    "CVE-ID": "CVE-2024-50036",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: do not delay dst_entries_add() in dst_release()\n\ndst_entries_add() uses per-cpu data that might be freed at netns\ndismantle from ip6_route_net_exit() calling dst_entries_destroy()\n\nBefore ip6_route_net_exit() can be called, we release all\nthe dsts associated with this netns, via calls to dst_release(),\nwhich waits an rcu grace period before calling dst_destroy()\n\ndst_entries_add() use in dst_destroy() is racy, because\ndst_entries_destroy() could have been called already.\n\nDecrementing the number of dsts must happen sooner.\n\nNotes:\n\n1) in CONFIG_XFRM case, dst_destroy() can call\n   dst_release_immediate(child), this might also cause UAF\n   if the child does not have DST_NOCOUNT set.\n   IPSEC maintainers might take a look and see how to address this.\n\n2) There is also discussion about removing this count of dst,\n   which might happen in future kernels.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 7,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "3.10.50",
                "VersionEndExcluding": "3.11",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "3.12.26",
                "VersionEndExcluding": "3.13",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "3.14.14",
                "VersionEndExcluding": "3.15",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "3.15.7",
                "VersionEndExcluding": "3.16",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "3.16",
                "VersionEndExcluding": "6.6.57",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.7",
                "VersionEndExcluding": "6.11.4",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.10.230": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.230"
            ]
        },
        "5.15.172": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.172"
            ]
        },
        "6.1.117": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.117"
            ]
        },
        "6.11.4": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.11.4"
            ]
        },
        "6.12": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12"
            ]
        },
        "6.6.57": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.57"
            ]
        },
        "commit": {
            "net: do not delay dst_entries_add() in dst_release()": [
                {
                    "description": "net: do not delay dst_entries_add() in dst_release()",
                    "commit": "547087307bc19417b4f2bc85ba9664a3e8db5a6a",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.230",
                    "version": "5.10.230",
                    "upstream_commit": "ac888d58869bb99753e7652be19a151df9ecb35d",
                    "fixed": [
                        {
                            "fixed_commit": "f88649721268",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/f88649721268",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "86e48c03d774",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.10.50",
                            "fixed_commit_version": "3.10.50",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "591b1e1bb401",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.12.26",
                            "fixed_commit_version": "3.12.26",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "df90819dafcd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.14.14",
                            "fixed_commit_version": "3.14.14",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "9a4fe697023d",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.15.7",
                            "fixed_commit_version": "3.15.7",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        }
                    ]
                },
                {
                    "description": "net: do not delay dst_entries_add() in dst_release()",
                    "commit": "e3915f028b1f1c37e87542e5aadd33728c259d96",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.172",
                    "version": "5.15.172",
                    "upstream_commit": "ac888d58869bb99753e7652be19a151df9ecb35d",
                    "fixed": [
                        {
                            "fixed_commit": "f88649721268",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/f88649721268",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "86e48c03d774",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.10.50",
                            "fixed_commit_version": "3.10.50",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "591b1e1bb401",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.12.26",
                            "fixed_commit_version": "3.12.26",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "df90819dafcd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.14.14",
                            "fixed_commit_version": "3.14.14",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "9a4fe697023d",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.15.7",
                            "fixed_commit_version": "3.15.7",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        }
                    ]
                },
                {
                    "description": "net: do not delay dst_entries_add() in dst_release()",
                    "commit": "a60db84f772fc3a906c6c4072f9207579c41166f",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.117",
                    "version": "6.1.117",
                    "upstream_commit": "ac888d58869bb99753e7652be19a151df9ecb35d",
                    "fixed": [
                        {
                            "fixed_commit": "f88649721268",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/f88649721268",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "86e48c03d774",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.10.50",
                            "fixed_commit_version": "3.10.50",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "591b1e1bb401",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.12.26",
                            "fixed_commit_version": "3.12.26",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "df90819dafcd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.14.14",
                            "fixed_commit_version": "3.14.14",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "9a4fe697023d",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.15.7",
                            "fixed_commit_version": "3.15.7",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        }
                    ]
                },
                {
                    "description": "net: do not delay dst_entries_add() in dst_release()",
                    "commit": "3c7c918ec0aa3555372c5a57f18780b7a96c5cfc",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.11.4",
                    "version": "6.11.4",
                    "upstream_commit": "ac888d58869bb99753e7652be19a151df9ecb35d",
                    "fixed": [
                        {
                            "fixed_commit": "f88649721268",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/f88649721268",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "86e48c03d774",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.10.50",
                            "fixed_commit_version": "3.10.50",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "591b1e1bb401",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.12.26",
                            "fixed_commit_version": "3.12.26",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "df90819dafcd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.14.14",
                            "fixed_commit_version": "3.14.14",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "9a4fe697023d",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.15.7",
                            "fixed_commit_version": "3.15.7",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        }
                    ]
                },
                {
                    "description": "net: do not delay dst_entries_add() in dst_release()",
                    "commit": "ac888d58869bb99753e7652be19a151df9ecb35d",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12",
                    "version": "6.12",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "f88649721268",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/f88649721268",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "86e48c03d774",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.10.50",
                            "fixed_commit_version": "3.10.50",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "591b1e1bb401",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.12.26",
                            "fixed_commit_version": "3.12.26",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "df90819dafcd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.14.14",
                            "fixed_commit_version": "3.14.14",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "9a4fe697023d",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.15.7",
                            "fixed_commit_version": "3.15.7",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        }
                    ]
                },
                {
                    "description": "net: do not delay dst_entries_add() in dst_release()",
                    "commit": "eae7435b48ffc8e9be0ff9cfeae40af479a609dd",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.57",
                    "version": "6.6.57",
                    "upstream_commit": "ac888d58869bb99753e7652be19a151df9ecb35d",
                    "fixed": [
                        {
                            "fixed_commit": "f88649721268",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/f88649721268",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "86e48c03d774",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.10.50",
                            "fixed_commit_version": "3.10.50",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "591b1e1bb401",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.12.26",
                            "fixed_commit_version": "3.12.26",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "df90819dafcd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.14.14",
                            "fixed_commit_version": "3.14.14",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        },
                        {
                            "fixed_commit": "9a4fe697023d",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.15.7",
                            "fixed_commit_version": "3.15.7",
                            "fixed_commit_upstream_commit": "f88649721268999bdff09777847080a52004f691"
                        }
                    ]
                }
            ]
        }
    }
}