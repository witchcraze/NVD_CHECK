{
    "CVE-ID": "CVE-2025-38285",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Fix WARN() in get_bpf_raw_tp_regs\n\nsyzkaller reported an issue:\n\nWARNING: CPU: 3 PID: 5971 at kernel/trace/bpf_trace.c:1861 get_bpf_raw_tp_regs+0xa4/0x100 kernel/trace/bpf_trace.c:1861\nModules linked in:\nCPU: 3 UID: 0 PID: 5971 Comm: syz-executor205 Not tainted 6.15.0-rc5-syzkaller-00038-g707df3375124 #0 PREEMPT(full)\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-debian-1.16.3-2~bpo12+1 04/01/2014\nRIP: 0010:get_bpf_raw_tp_regs+0xa4/0x100 kernel/trace/bpf_trace.c:1861\nRSP: 0018:ffffc90003636fa8 EFLAGS: 00010293\nRAX: 0000000000000000 RBX: 0000000000000003 RCX: ffffffff81c6bc4c\nRDX: ffff888032efc880 RSI: ffffffff81c6bc83 RDI: 0000000000000005\nRBP: ffff88806a730860 R08: 0000000000000005 R09: 0000000000000003\nR10: 0000000000000004 R11: 0000000000000000 R12: 0000000000000004\nR13: 0000000000000001 R14: ffffc90003637008 R15: 0000000000000900\nFS:  0000000000000000(0000) GS:ffff8880d6cdf000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007f7baee09130 CR3: 0000000029f5a000 CR4: 0000000000352ef0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n <TASK>\n ____bpf_get_stack_raw_tp kernel/trace/bpf_trace.c:1934 [inline]\n bpf_get_stack_raw_tp+0x24/0x160 kernel/trace/bpf_trace.c:1931\n bpf_prog_ec3b2eefa702d8d3+0x43/0x47\n bpf_dispatcher_nop_func include/linux/bpf.h:1316 [inline]\n __bpf_prog_run include/linux/filter.h:718 [inline]\n bpf_prog_run include/linux/filter.h:725 [inline]\n __bpf_trace_run kernel/trace/bpf_trace.c:2363 [inline]\n bpf_trace_run3+0x23f/0x5a0 kernel/trace/bpf_trace.c:2405\n __bpf_trace_mmap_lock_acquire_returned+0xfc/0x140 include/trace/events/mmap_lock.h:47\n __traceiter_mmap_lock_acquire_returned+0x79/0xc0 include/trace/events/mmap_lock.h:47\n __do_trace_mmap_lock_acquire_returned include/trace/events/mmap_lock.h:47 [inline]\n trace_mmap_lock_acquire_returned include/trace/events/mmap_lock.h:47 [inline]\n __mmap_lock_do_trace_acquire_returned+0x138/0x1f0 mm/mmap_lock.c:35\n __mmap_lock_trace_acquire_returned include/linux/mmap_lock.h:36 [inline]\n mmap_read_trylock include/linux/mmap_lock.h:204 [inline]\n stack_map_get_build_id_offset+0x535/0x6f0 kernel/bpf/stackmap.c:157\n __bpf_get_stack+0x307/0xa10 kernel/bpf/stackmap.c:483\n ____bpf_get_stack kernel/bpf/stackmap.c:499 [inline]\n bpf_get_stack+0x32/0x40 kernel/bpf/stackmap.c:496\n ____bpf_get_stack_raw_tp kernel/trace/bpf_trace.c:1941 [inline]\n bpf_get_stack_raw_tp+0x124/0x160 kernel/trace/bpf_trace.c:1931\n bpf_prog_ec3b2eefa702d8d3+0x43/0x47\n\nTracepoint like trace_mmap_lock_acquire_returned may cause nested call\nas the corner case show above, which will be resolved with more general\nmethod in the future. As a result, WARN_ON_ONCE will be triggered. As\nAlexei suggested, remove the WARN_ON_ONCE first.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:5.2:rc7",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.2:rc7:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:5.2:rc6",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.2:rc6:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:5.2:-",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.2:-:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.19.57",
                "VersionEndExcluding": "4.20",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.1.16",
                "VersionEndExcluding": "5.2",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.186",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.1.142",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.2.1",
                "VersionEndExcluding": "5.4.295",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.5",
                "VersionEndExcluding": "5.10.239",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.13",
                "VersionEndExcluding": "6.15.3",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.6.94",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.7",
                "VersionEndExcluding": "6.12.34",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:debian:debian_linux:11.0",
                "FormattedString": "cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.10.239": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.239"
            ]
        },
        "5.15.186": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.186"
            ]
        },
        "5.4.295": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.295"
            ]
        },
        "6.1.142": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.142"
            ]
        },
        "6.12.34": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.34"
            ]
        },
        "6.15.3": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.15.3"
            ]
        },
        "6.16": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.16"
            ]
        },
        "6.6.94": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.94"
            ]
        },
        "commit": {
            "bpf: Fix WARN() in get_bpf_raw_tp_regs": [
                {
                    "description": "bpf: Fix WARN() in get_bpf_raw_tp_regs",
                    "commit": "147ea936fc6fa8fe0c93f0df918803a5375ca535",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.239",
                    "version": "5.10.239",
                    "upstream_commit": "3880cdbed1c4607e378f58fa924c5d6df900d1d3",
                    "fixed": [
                        {
                            "fixed_commit": "9594dc3c7e71",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.2",
                            "fixed_commit_version": "5.2",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "a7177b94aff4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.57",
                            "fixed_commit_version": "4.19.57",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        },
                        {
                            "fixed_commit": "2a9fedc1ef4b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1.16",
                            "fixed_commit_version": "5.1.16",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        }
                    ]
                },
                {
                    "description": "bpf: Fix WARN() in get_bpf_raw_tp_regs",
                    "commit": "ee90be48edb3dac612e0b7f5332482a9e8be2696",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.186",
                    "version": "5.15.186",
                    "upstream_commit": "3880cdbed1c4607e378f58fa924c5d6df900d1d3",
                    "fixed": [
                        {
                            "fixed_commit": "9594dc3c7e71",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.2",
                            "fixed_commit_version": "5.2",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "a7177b94aff4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.57",
                            "fixed_commit_version": "4.19.57",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        },
                        {
                            "fixed_commit": "2a9fedc1ef4b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1.16",
                            "fixed_commit_version": "5.1.16",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        }
                    ]
                },
                {
                    "description": "bpf: Fix WARN() in get_bpf_raw_tp_regs",
                    "commit": "44ebe361abb322d2afd77930fa767a99f271c4d1",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.295",
                    "version": "5.4.295",
                    "upstream_commit": "3880cdbed1c4607e378f58fa924c5d6df900d1d3",
                    "fixed": [
                        {
                            "fixed_commit": "9594dc3c7e71",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.2",
                            "fixed_commit_version": "5.2",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "a7177b94aff4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.57",
                            "fixed_commit_version": "4.19.57",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        },
                        {
                            "fixed_commit": "2a9fedc1ef4b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1.16",
                            "fixed_commit_version": "5.1.16",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        }
                    ]
                },
                {
                    "description": "bpf: Fix WARN() in get_bpf_raw_tp_regs",
                    "commit": "e167414beabb1e941fe563a96becc98627d5bdf6",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.142",
                    "version": "6.1.142",
                    "upstream_commit": "3880cdbed1c4607e378f58fa924c5d6df900d1d3",
                    "fixed": [
                        {
                            "fixed_commit": "9594dc3c7e71",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.2",
                            "fixed_commit_version": "5.2",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "a7177b94aff4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.57",
                            "fixed_commit_version": "4.19.57",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        },
                        {
                            "fixed_commit": "2a9fedc1ef4b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1.16",
                            "fixed_commit_version": "5.1.16",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        }
                    ]
                },
                {
                    "description": "bpf: Fix WARN() in get_bpf_raw_tp_regs",
                    "commit": "c98cdf6795a36bca163ebb40411fef1687b9eb13",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.34",
                    "version": "6.12.34",
                    "upstream_commit": "3880cdbed1c4607e378f58fa924c5d6df900d1d3",
                    "fixed": [
                        {
                            "fixed_commit": "9594dc3c7e71",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.2",
                            "fixed_commit_version": "5.2",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "a7177b94aff4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.57",
                            "fixed_commit_version": "4.19.57",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        },
                        {
                            "fixed_commit": "2a9fedc1ef4b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1.16",
                            "fixed_commit_version": "5.1.16",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        }
                    ]
                },
                {
                    "description": "bpf: Fix WARN() in get_bpf_raw_tp_regs",
                    "commit": "18e8cbbae79cb35bdce8a01c889827b9799c762e",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.15.3",
                    "version": "6.15.3",
                    "upstream_commit": "3880cdbed1c4607e378f58fa924c5d6df900d1d3",
                    "fixed": [
                        {
                            "fixed_commit": "9594dc3c7e71",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.2",
                            "fixed_commit_version": "5.2",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "a7177b94aff4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.57",
                            "fixed_commit_version": "4.19.57",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        },
                        {
                            "fixed_commit": "2a9fedc1ef4b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1.16",
                            "fixed_commit_version": "5.1.16",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        }
                    ]
                },
                {
                    "description": "bpf: Fix WARN() in get_bpf_raw_tp_regs",
                    "commit": "3880cdbed1c4607e378f58fa924c5d6df900d1d3",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.16",
                    "version": "6.16",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "9594dc3c7e71",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.2",
                            "fixed_commit_version": "5.2",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "a7177b94aff4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.57",
                            "fixed_commit_version": "4.19.57",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        },
                        {
                            "fixed_commit": "2a9fedc1ef4b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1.16",
                            "fixed_commit_version": "5.1.16",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        }
                    ]
                },
                {
                    "description": "bpf: Fix WARN() in get_bpf_raw_tp_regs",
                    "commit": "6d8f39875a10a194051c3eaefebc7ac06a34aaf3",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.94",
                    "version": "6.6.94",
                    "upstream_commit": "3880cdbed1c4607e378f58fa924c5d6df900d1d3",
                    "fixed": [
                        {
                            "fixed_commit": "9594dc3c7e71",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.2",
                            "fixed_commit_version": "5.2",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "a7177b94aff4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.57",
                            "fixed_commit_version": "4.19.57",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        },
                        {
                            "fixed_commit": "2a9fedc1ef4b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1.16",
                            "fixed_commit_version": "5.1.16",
                            "fixed_commit_upstream_commit": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99"
                        }
                    ]
                }
            ]
        }
    }
}