{
    "CVE-ID": "CVE-2024-38558",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: openvswitch: fix overwriting ct original tuple for ICMPv6\n\nOVS_PACKET_CMD_EXECUTE has 3 main attributes:\n - OVS_PACKET_ATTR_KEY - Packet metadata in a netlink format.\n - OVS_PACKET_ATTR_PACKET - Binary packet content.\n - OVS_PACKET_ATTR_ACTIONS - Actions to execute on the packet.\n\nOVS_PACKET_ATTR_KEY is parsed first to populate sw_flow_key structure\nwith the metadata like conntrack state, input port, recirculation id,\netc.  Then the packet itself gets parsed to populate the rest of the\nkeys from the packet headers.\n\nWhenever the packet parsing code starts parsing the ICMPv6 header, it\nfirst zeroes out fields in the key corresponding to Neighbor Discovery\ninformation even if it is not an ND packet.\n\nIt is an 'ipv6.nd' field.  However, the 'ipv6' is a union that shares\nthe space between 'nd' and 'ct_orig' that holds the original tuple\nconntrack metadata parsed from the OVS_PACKET_ATTR_KEY.\n\nND packets should not normally have conntrack state, so it's fine to\nshare the space, but normal ICMPv6 Echo packets or maybe other types of\nICMPv6 can have the state attached and it should not be overwritten.\n\nThe issue results in all but the last 4 bytes of the destination\naddress being wiped from the original conntrack tuple leading to\nincorrect packet matching and potentially executing wrong actions\nin case this packet recirculates within the datapath or goes back\nto userspace.\n\nND fields should not be accessed in non-ND packets, so not clearing\nthem should be fine.  Executing memset() only for actual ND packets to\navoid the issue.\n\nInitializing the whole thing before parsing is needed because ND packet\nmay not contain all the options.\n\nThe issue only affects the OVS_PACKET_CMD_EXECUTE path and doesn't\naffect packets entering OVS datapath from network interfaces, because\nin this case CT metadata is populated from skb after the packet is\nalready parsed.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.11",
                "VersionEndExcluding": "4.19.316",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.20",
                "VersionEndExcluding": "5.4.278",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.161",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.1.93",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.5",
                "VersionEndExcluding": "5.10.219",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.6.33",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.7",
                "VersionEndExcluding": "6.8.12",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.9",
                "VersionEndExcluding": "6.9.3",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "4.19.316": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.316"
            ]
        },
        "5.10.219": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.219"
            ]
        },
        "5.15.161": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.161"
            ]
        },
        "5.4.278": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.278"
            ]
        },
        "6.1.93": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.93"
            ]
        },
        "6.10": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.10"
            ]
        },
        "6.6.33": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.33"
            ]
        },
        "6.8.12": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.8.12"
            ]
        },
        "6.9.3": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.9.3"
            ]
        },
        "commit": {
            "net: openvswitch: fix overwriting ct original tuple for ICMPv6": [
                {
                    "description": "net: openvswitch: fix overwriting ct original tuple for ICMPv6",
                    "commit": "6a51ac92bf35d34b4996d6eb67e2fe469f573b11",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.316",
                    "version": "4.19.316",
                    "upstream_commit": "7c988176b6c16c516474f6fceebe0f055af5eb56",
                    "fixed": [
                        {
                            "fixed_commit": "9dd7f8907c37",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/9dd7f8907c37",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: openvswitch: fix overwriting ct original tuple for ICMPv6",
                    "commit": "5ab6aecbede080b44b8e34720ab72050bf1e6982",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.219",
                    "version": "5.10.219",
                    "upstream_commit": "7c988176b6c16c516474f6fceebe0f055af5eb56",
                    "fixed": [
                        {
                            "fixed_commit": "9dd7f8907c37",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/9dd7f8907c37",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: openvswitch: fix overwriting ct original tuple for ICMPv6",
                    "commit": "483eb70f441e2df66ade78aa7217e6e4caadfef3",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.161",
                    "version": "5.15.161",
                    "upstream_commit": "7c988176b6c16c516474f6fceebe0f055af5eb56",
                    "fixed": [
                        {
                            "fixed_commit": "9dd7f8907c37",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/9dd7f8907c37",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: openvswitch: fix overwriting ct original tuple for ICMPv6",
                    "commit": "0b532f59437f688563e9c58bdc1436fefa46e3b5",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.278",
                    "version": "5.4.278",
                    "upstream_commit": "7c988176b6c16c516474f6fceebe0f055af5eb56",
                    "fixed": [
                        {
                            "fixed_commit": "9dd7f8907c37",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/9dd7f8907c37",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: openvswitch: fix overwriting ct original tuple for ICMPv6",
                    "commit": "9ec8b0ccadb908d92f7ee211a4eff05fd932f3f6",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.93",
                    "version": "6.1.93",
                    "upstream_commit": "7c988176b6c16c516474f6fceebe0f055af5eb56",
                    "fixed": [
                        {
                            "fixed_commit": "9dd7f8907c37",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/9dd7f8907c37",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: openvswitch: fix overwriting ct original tuple for ICMPv6",
                    "commit": "7c988176b6c16c516474f6fceebe0f055af5eb56",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.10",
                    "version": "6.10",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "9dd7f8907c37",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/9dd7f8907c37",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: openvswitch: fix overwriting ct original tuple for ICMPv6",
                    "commit": "78741b4caae1e880368cb2f5110635f3ce45ecfd",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.33",
                    "version": "6.6.33",
                    "upstream_commit": "7c988176b6c16c516474f6fceebe0f055af5eb56",
                    "fixed": [
                        {
                            "fixed_commit": "9dd7f8907c37",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/9dd7f8907c37",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: openvswitch: fix overwriting ct original tuple for ICMPv6",
                    "commit": "431e9215576d7b728f3f53a704d237a520092120",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.8.12",
                    "version": "6.8.12",
                    "upstream_commit": "7c988176b6c16c516474f6fceebe0f055af5eb56",
                    "fixed": [
                        {
                            "fixed_commit": "9dd7f8907c37",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/9dd7f8907c37",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: openvswitch: fix overwriting ct original tuple for ICMPv6",
                    "commit": "d73fb8bddf89503c9fae7c42e50d44c89909aad6",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.9.3",
                    "version": "6.9.3",
                    "upstream_commit": "7c988176b6c16c516474f6fceebe0f055af5eb56",
                    "fixed": [
                        {
                            "fixed_commit": "9dd7f8907c37",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/9dd7f8907c37",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}