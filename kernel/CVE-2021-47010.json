{
    "CVE-ID": "CVE-2021-47010",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: Only allow init netns to set default tcp cong to a restricted algo\n\ntcp_set_default_congestion_control() is netns-safe in that it writes\nto &net->ipv4.tcp_congestion_control, but it also sets\nca->flags |= TCP_CONG_NON_RESTRICTED which is not namespaced.\nThis has the unintended side-effect of changing the global\nnet.ipv4.tcp_allowed_congestion_control sysctl, despite the fact that it\nis read-only: 97684f0970f6 (\"net: Make tcp_allowed_congestion_control\nreadonly in non-init netns\")\n\nResolve this netns \"leak\" by only allowing the init netns to set the\ndefault algorithm to one that is restricted. This restriction could be\nremoved if tcp_allowed_congestion_control were namespace-ified in the\nfuture.\n\nThis bug was uncovered with\nhttps://github.com/JonathonReinhart/linux-netns-sysctl-verify",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 7.8,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.15",
                "VersionEndExcluding": "4.19.191",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.20",
                "VersionEndExcluding": "5.4.119",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.11.21",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.12",
                "VersionEndExcluding": "5.12.4",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.5",
                "VersionEndExcluding": "5.10.37",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "4.19.191": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.191"
            ]
        },
        "5.10.37": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.37"
            ]
        },
        "5.11.21": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11.21"
            ]
        },
        "5.12.4": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.12.4"
            ]
        },
        "5.13": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.13"
            ]
        },
        "5.4.119": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.119"
            ]
        },
        "commit": {
            "net: Only allow init netns to set default tcp cong to a restricted algo": [
                {
                    "description": "net: Only allow init netns to set default tcp cong to a restricted algo",
                    "commit": "992de06308d9a9584d59b96d294ac676f924e437",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.191",
                    "version": "4.19.191",
                    "upstream_commit": "8d432592f30fcc34ef5a10aac4887b4897884493",
                    "fixed": [
                        {
                            "fixed_commit": "6670e1524477",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/6670e1524477",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: Only allow init netns to set default tcp cong to a restricted algo",
                    "commit": "6c1ea8bee75df8fe2184a50fcd0f70bf82986f42",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.37",
                    "version": "5.10.37",
                    "upstream_commit": "8d432592f30fcc34ef5a10aac4887b4897884493",
                    "fixed": [
                        {
                            "fixed_commit": "6670e1524477",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/6670e1524477",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: Only allow init netns to set default tcp cong to a restricted algo",
                    "commit": "efe1532a6e1a8e3c343d04fff510f0ed80328f9c",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11.21",
                    "version": "5.11.21",
                    "upstream_commit": "8d432592f30fcc34ef5a10aac4887b4897884493",
                    "fixed": [
                        {
                            "fixed_commit": "6670e1524477",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/6670e1524477",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: Only allow init netns to set default tcp cong to a restricted algo",
                    "commit": "e7d7bedd507bb732e600403b7a96f9fe48d0ca31",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.12.4",
                    "version": "5.12.4",
                    "upstream_commit": "8d432592f30fcc34ef5a10aac4887b4897884493",
                    "fixed": [
                        {
                            "fixed_commit": "6670e1524477",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/6670e1524477",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: Only allow init netns to set default tcp cong to a restricted algo",
                    "commit": "8d432592f30fcc34ef5a10aac4887b4897884493",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.13",
                    "version": "5.13",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "6670e1524477",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/6670e1524477",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: Only allow init netns to set default tcp cong to a restricted algo",
                    "commit": "9884f745108f7d25b189bbcd6754e284fb29ab68",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.119",
                    "version": "5.4.119",
                    "upstream_commit": "8d432592f30fcc34ef5a10aac4887b4897884493",
                    "fixed": [
                        {
                            "fixed_commit": "6670e1524477",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/6670e1524477",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}