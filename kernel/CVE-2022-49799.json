{
    "CVE-ID": "CVE-2022-49799",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\ntracing: Fix wild-memory-access in register_synth_event()\n\nIn register_synth_event(), if set_synth_event_print_fmt() failed, then\nboth trace_remove_event_call() and unregister_trace_event() will be\ncalled, which means the trace_event_call will call\n__unregister_trace_event() twice. As the result, the second unregister\nwill causes the wild-memory-access.\n\nregister_synth_event\n    set_synth_event_print_fmt failed\n    trace_remove_event_call\n        event_remove\n            if call->event.funcs then\n            __unregister_trace_event (first call)\n    unregister_trace_event\n        __unregister_trace_event (second call)\n\nFix the bug by avoiding to call the second __unregister_trace_event() by\nchecking if the first one is called.\n\ngeneral protection fault, probably for non-canonical address\n\t0xfbd59c0000000024: 0000 [#1] SMP KASAN PTI\nKASAN: maybe wild-memory-access in range\n[0xdead000000000120-0xdead000000000127]\nCPU: 0 PID: 3807 Comm: modprobe Not tainted\n6.1.0-rc1-00186-g76f33a7eedb4 #299\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS\nrel-1.15.0-0-g2dd4b9b3f840-prebuilt.qemu.org 04/01/2014\nRIP: 0010:unregister_trace_event+0x6e/0x280\nCode: 00 fc ff df 4c 89 ea 48 c1 ea 03 80 3c 02 00 0f 85 0e 02 00 00 48\nb8 00 00 00 00 00 fc ff df 4c 8b 63 08 4c 89 e2 48 c1 ea 03 <80> 3c 02\n00 0f 85 e2 01 00 00 49 89 2c 24 48 85 ed 74 28 e8 7a 9b\nRSP: 0018:ffff88810413f370 EFLAGS: 00010a06\nRAX: dffffc0000000000 RBX: ffff888105d050b0 RCX: 0000000000000000\nRDX: 1bd5a00000000024 RSI: ffff888119e276e0 RDI: ffffffff835a8b20\nRBP: dead000000000100 R08: 0000000000000000 R09: fffffbfff0913481\nR10: ffffffff8489a407 R11: fffffbfff0913480 R12: dead000000000122\nR13: ffff888105d050b8 R14: 0000000000000000 R15: ffff888105d05028\nFS:  00007f7823e8d540(0000) GS:ffff888119e00000(0000)\nknlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007f7823e7ebec CR3: 000000010a058002 CR4: 0000000000330ef0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n <TASK>\n __create_synth_event+0x1e37/0x1eb0\n create_or_delete_synth_event+0x110/0x250\n synth_event_run_command+0x2f/0x110\n test_gen_synth_cmd+0x170/0x2eb [synth_event_gen_test]\n synth_event_gen_test_init+0x76/0x9bc [synth_event_gen_test]\n do_one_initcall+0xdb/0x480\n do_init_module+0x1cf/0x680\n load_module+0x6a50/0x70a0\n __do_sys_finit_module+0x12f/0x1c0\n do_syscall_64+0x3f/0x90\n entry_SYSCALL_64_after_hwframe+0x63/0xcd",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 7.1,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.1:rc5",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.1:rc5:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.1:rc4",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.1:rc4:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.1:rc3",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.1:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.1:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.17",
                "VersionEndExcluding": "5.10.156",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.80",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.0.10",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.10.156": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.156"
            ]
        },
        "5.15.80": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.80"
            ]
        },
        "6.0.10": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0.10"
            ]
        },
        "6.1": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1"
            ]
        },
        "commit": {
            "tracing: Fix wild-memory-access in register_synth_event()": [
                {
                    "description": "tracing: Fix wild-memory-access in register_synth_event()",
                    "commit": "315b149f08229a233d47532eb5da1707b28f764c",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.156",
                    "version": "5.10.156",
                    "upstream_commit": "1b5f1c34d3f5a664a57a5a7557a50e4e3cc2505c",
                    "fixed": [
                        {
                            "fixed_commit": "4b147936fa50",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/4b147936fa50",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "tracing: Fix wild-memory-access in register_synth_event()",
                    "commit": "6517b97134f724d12f673f9fb4f456d75c7a905f",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.80",
                    "version": "5.15.80",
                    "upstream_commit": "1b5f1c34d3f5a664a57a5a7557a50e4e3cc2505c",
                    "fixed": [
                        {
                            "fixed_commit": "4b147936fa50",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/4b147936fa50",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "tracing: Fix wild-memory-access in register_synth_event()",
                    "commit": "a5bfa53e5036b3e7a80be902dd3719a930accabd",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0.10",
                    "version": "6.0.10",
                    "upstream_commit": "1b5f1c34d3f5a664a57a5a7557a50e4e3cc2505c",
                    "fixed": [
                        {
                            "fixed_commit": "4b147936fa50",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/4b147936fa50",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "tracing: Fix wild-memory-access in register_synth_event()",
                    "commit": "1b5f1c34d3f5a664a57a5a7557a50e4e3cc2505c",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1",
                    "version": "6.1",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "4b147936fa50",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/4b147936fa50",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}