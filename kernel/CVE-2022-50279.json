{
    "CVE-ID": "CVE-2022-50279",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nwifi: rtlwifi: Fix global-out-of-bounds bug in _rtl8812ae_phy_set_txpower_limit()\n\nThere is a global-out-of-bounds reported by KASAN:\n\n  BUG: KASAN: global-out-of-bounds in\n  _rtl8812ae_eq_n_byte.part.0+0x3d/0x84 [rtl8821ae]\n  Read of size 1 at addr ffffffffa0773c43 by task NetworkManager/411\n\n  CPU: 6 PID: 411 Comm: NetworkManager Tainted: G      D\n  6.1.0-rc8+ #144 e15588508517267d37\n  Hardware name: QEMU Standard PC (Q35 + ICH9, 2009),\n  Call Trace:\n   <TASK>\n   ...\n   kasan_report+0xbb/0x1c0\n   _rtl8812ae_eq_n_byte.part.0+0x3d/0x84 [rtl8821ae]\n   rtl8821ae_phy_bb_config.cold+0x346/0x641 [rtl8821ae]\n   rtl8821ae_hw_init+0x1f5e/0x79b0 [rtl8821ae]\n   ...\n   </TASK>\n\nThe root cause of the problem is that the comparison order of\n\"prate_section\" in _rtl8812ae_phy_set_txpower_limit() is wrong. The\n_rtl8812ae_eq_n_byte() is used to compare the first n bytes of the two\nstrings from tail to head, which causes the problem. In the\n_rtl8812ae_phy_set_txpower_limit(), it was originally intended to meet\nthis requirement by carefully designing the comparison order.\nFor example, \"pregulation\" and \"pbandwidth\" are compared in order of\nlength from small to large, first is 3 and last is 4. However, the\ncomparison order of \"prate_section\" dose not obey such order requirement,\ntherefore when \"prate_section\" is \"HT\", when comparing from tail to head,\nit will lead to access out of bounds in _rtl8812ae_eq_n_byte(). As\nmentioned above, the _rtl8812ae_eq_n_byte() has the same function as\nstrcmp(), so just strcmp() is enough.\n\nFix it by removing _rtl8812ae_eq_n_byte() and use strcmp() barely.\nAlthough it can be fixed by adjusting the comparison order of\n\"prate_section\", this may cause the value of \"rate_section\" to not be\nfrom 0 to 5. In addition, commit \"21e4b0726dc6\" not only moved driver\nfrom staging to regular tree, but also added setting txpower limit\nfunction during the driver config phase, so the problem was introduced\nby this commit.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 7.1,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "3.18",
                "VersionEndExcluding": "4.19.276",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.20",
                "VersionEndExcluding": "5.4.235",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.99",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.1.16",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.5",
                "VersionEndExcluding": "5.10.173",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.2.3",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "4.19.276": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.276"
            ]
        },
        "5.10.173": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.173"
            ]
        },
        "5.15.99": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.99"
            ]
        },
        "5.4.235": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.235"
            ]
        },
        "6.1.16": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.16"
            ]
        },
        "6.2.3": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.2.3"
            ]
        },
        "6.3": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.3"
            ]
        },
        "commit": {
            "wifi: rtlwifi: Fix global-out-of-bounds bug in _rtl8812ae_phy_set_txpower_limit()": [
                {
                    "description": "wifi: rtlwifi: Fix global-out-of-bounds bug in _rtl8812ae_phy_set_txpower_limit()",
                    "commit": "fc3442247716fc426bbcf62ed65e086e48a6d44f",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.276",
                    "version": "4.19.276",
                    "upstream_commit": "117dbeda22ec5ea0918254d03b540ef8b8a64d53",
                    "fixed": [
                        {
                            "fixed_commit": "21e4b0726dc6",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/21e4b0726dc6",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "wifi: rtlwifi: Fix global-out-of-bounds bug in _rtl8812ae_phy_set_txpower_limit()",
                    "commit": "1e950b9a841bc96e98ee25680d5c7aa305120be1",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.173",
                    "version": "5.10.173",
                    "upstream_commit": "117dbeda22ec5ea0918254d03b540ef8b8a64d53",
                    "fixed": [
                        {
                            "fixed_commit": "21e4b0726dc6",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/21e4b0726dc6",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "wifi: rtlwifi: Fix global-out-of-bounds bug in _rtl8812ae_phy_set_txpower_limit()",
                    "commit": "0c962dcd6bf64b78eaffc09e497a2beb4e48bc32",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.99",
                    "version": "5.15.99",
                    "upstream_commit": "117dbeda22ec5ea0918254d03b540ef8b8a64d53",
                    "fixed": [
                        {
                            "fixed_commit": "21e4b0726dc6",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/21e4b0726dc6",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "wifi: rtlwifi: Fix global-out-of-bounds bug in _rtl8812ae_phy_set_txpower_limit()",
                    "commit": "28ea268d95e57cdf6394a058f0d854206d478772",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.235",
                    "version": "5.4.235",
                    "upstream_commit": "117dbeda22ec5ea0918254d03b540ef8b8a64d53",
                    "fixed": [
                        {
                            "fixed_commit": "21e4b0726dc6",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/21e4b0726dc6",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "wifi: rtlwifi: Fix global-out-of-bounds bug in _rtl8812ae_phy_set_txpower_limit()",
                    "commit": "f1fe40120de6ad4ffa8299fde035a5feba10d4fb",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.16",
                    "version": "6.1.16",
                    "upstream_commit": "117dbeda22ec5ea0918254d03b540ef8b8a64d53",
                    "fixed": [
                        {
                            "fixed_commit": "21e4b0726dc6",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/21e4b0726dc6",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "wifi: rtlwifi: Fix global-out-of-bounds bug in _rtl8812ae_phy_set_txpower_limit()",
                    "commit": "057b52461dc005ecd85a3e4998913b1492ec0f72",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.2.3",
                    "version": "6.2.3",
                    "upstream_commit": "117dbeda22ec5ea0918254d03b540ef8b8a64d53",
                    "fixed": [
                        {
                            "fixed_commit": "21e4b0726dc6",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/21e4b0726dc6",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "wifi: rtlwifi: Fix global-out-of-bounds bug in _rtl8812ae_phy_set_txpower_limit()",
                    "commit": "117dbeda22ec5ea0918254d03b540ef8b8a64d53",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.3",
                    "version": "6.3",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "21e4b0726dc6",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/21e4b0726dc6",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}