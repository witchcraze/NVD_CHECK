{
    "CVE-ID": "CVE-2023-53315",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nwifi: ath11k: Fix SKB corruption in REO destination ring\n\nWhile running traffics for a long time, randomly an RX descriptor\nfilled with value \"0\" from REO destination ring is received.\nThis descriptor which is invalid causes the wrong SKB (SKB stored in\nthe IDR lookup with buffer id \"0\") to be fetched which in turn\ncauses SKB memory corruption issue and the same leads to crash\nafter some time.\n\nChanged the start id for idr allocation to \"1\" and the buffer id \"0\"\nis reserved for error validation. Introduced Sanity check to validate\nthe descriptor, before processing the SKB.\n\nCrash Signature :\n\nUnable to handle kernel paging request at virtual address 3f004900\nPC points to \"b15_dma_inv_range+0x30/0x50\"\nLR points to \"dma_cache_maint_page+0x8c/0x128\".\nThe Backtrace obtained is as follows:\n[<8031716c>] (b15_dma_inv_range) from [<80313a4c>] (dma_cache_maint_page+0x8c/0x128)\n[<80313a4c>] (dma_cache_maint_page) from [<80313b90>] (__dma_page_dev_to_cpu+0x28/0xcc)\n[<80313b90>] (__dma_page_dev_to_cpu) from [<7fb5dd68>] (ath11k_dp_process_rx+0x1e8/0x4a4 [ath11k])\n[<7fb5dd68>] (ath11k_dp_process_rx [ath11k]) from [<7fb53c20>] (ath11k_dp_service_srng+0xb0/0x2ac [ath11k])\n[<7fb53c20>] (ath11k_dp_service_srng [ath11k]) from [<7f67bba4>] (ath11k_pci_ext_grp_napi_poll+0x1c/0x78 [ath11k_pci])\n[<7f67bba4>] (ath11k_pci_ext_grp_napi_poll [ath11k_pci]) from [<807d5cf4>] (__napi_poll+0x28/0xb8)\n[<807d5cf4>] (__napi_poll) from [<807d5f28>] (net_rx_action+0xf0/0x280)\n[<807d5f28>] (net_rx_action) from [<80302148>] (__do_softirq+0xd0/0x280)\n[<80302148>] (__do_softirq) from [<80320408>] (irq_exit+0x74/0xd4)\n[<80320408>] (irq_exit) from [<803638a4>] (__handle_domain_irq+0x90/0xb4)\n[<803638a4>] (__handle_domain_irq) from [<805bedec>] (gic_handle_irq+0x58/0x90)\n[<805bedec>] (gic_handle_irq) from [<80301a78>] (__irq_svc+0x58/0x8c)\n\nTested-on: IPQ8074 hw2.0 AHB WLAN.HK.2.7.0.1-01744-QCAHKSWPL_SILICONZ-1",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.113",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.1.30",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.6",
                "VersionEndExcluding": "5.10.181",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.3.4",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.10.181": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.181"
            ]
        },
        "5.15.113": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.113"
            ]
        },
        "6.1.30": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.30"
            ]
        },
        "6.3.4": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.3.4"
            ]
        },
        "6.4": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.4"
            ]
        },
        "commit": {
            "wifi: ath11k: Fix SKB corruption in REO destination ring": [
                {
                    "description": "wifi: ath11k: Fix SKB corruption in REO destination ring",
                    "commit": "866921dc06b94df91acfcf9359b57da943ed99b3",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.181",
                    "version": "5.10.181",
                    "upstream_commit": "f9fff67d2d7ca6fa8066132003a3deef654c55b1",
                    "fixed": []
                },
                {
                    "description": "wifi: ath11k: Fix SKB corruption in REO destination ring",
                    "commit": "3d3f8fe01a01d94a17fe1ae0d2e894049a972717",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.113",
                    "version": "5.15.113",
                    "upstream_commit": "f9fff67d2d7ca6fa8066132003a3deef654c55b1",
                    "fixed": []
                },
                {
                    "description": "wifi: ath11k: Fix SKB corruption in REO destination ring",
                    "commit": "068fd06148fbf0af95bb08dc77cff34ee679fdbc",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.30",
                    "version": "6.1.30",
                    "upstream_commit": "f9fff67d2d7ca6fa8066132003a3deef654c55b1",
                    "fixed": []
                },
                {
                    "description": "wifi: ath11k: Fix SKB corruption in REO destination ring",
                    "commit": "67459491f78146bcf7d93596e5b709d063dff5d8",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.3.4",
                    "version": "6.3.4",
                    "upstream_commit": "f9fff67d2d7ca6fa8066132003a3deef654c55b1",
                    "fixed": []
                },
                {
                    "description": "wifi: ath11k: Fix SKB corruption in REO destination ring",
                    "commit": "f9fff67d2d7ca6fa8066132003a3deef654c55b1",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.4",
                    "version": "6.4",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "1da177e4c3f4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v2.6/ChangeLog-2.6.12",
                            "fixed_commit_version": "2.6.12",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}