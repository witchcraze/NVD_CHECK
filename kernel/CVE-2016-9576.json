{
    "CVE-ID": "CVE-2016-9576",
    "NVD": {
        "Descriptions": "The blk_rq_map_user_iov function in block/blk-map.c in the Linux kernel before 4.8.14 does not properly restrict the type of iterator, which allows local users to read or write to arbitrary kernel memory locations or cause a denial of service (use-after-free) by leveraging access to a /dev/sg device.",
        "Cvss2_BaseScore": 7.2,
        "Cvss3_BaseScore": 7.8,
        "Cvss2_VectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.0",
                "VersionEndExcluding": "4.4.38",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.5",
                "VersionEndExcluding": "4.8.14",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "-": {
            "source": [
                "https://github.com/torvalds/linux/commit/128394eff343fc6d2f32172f03e24829539c5835",
                "https://github.com/torvalds/linux/commit/a0ac402cfcdc904f9772e1762b3fda112dcc56a0"
            ]
        },
        "3.10.107": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.10.107"
            ]
        },
        "3.12.70": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.12.70"
            ]
        },
        "3.16.40": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.16.40"
            ]
        },
        "3.18.47": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.18.47"
            ]
        },
        "3.2.85": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.2.85"
            ]
        },
        "4.1.38": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.1.38"
            ]
        },
        "4.4.38": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.4.38"
            ]
        },
        "4.4.41": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.4.41"
            ]
        },
        "4.8.14": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.8.14"
            ]
        },
        "4.8.17": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.8.17"
            ]
        },
        "4.9.2": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.9.2"
            ]
        },
        "commit": {
            "sg_write()/bsg_write() is not fit to be called under KERNEL_DS": [
                {
                    "description": "sg_write()/bsg_write() is not fit to be called under KERNEL_DS",
                    "commit": "128394eff343fc6d2f32172f03e24829539c5835",
                    "source": "https://github.com/torvalds/linux/commit/128394eff343fc6d2f32172f03e24829539c5835",
                    "version": "-",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "1da177e4c3f4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v2.6/ChangeLog-2.6.12",
                            "fixed_commit_version": "2.6.12",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "sg_write()/bsg_write() is not fit to be called under KERNEL_DS",
                    "commit": "823a2a0330f25ccea8ef64ee4a378e37ca51361c",
                    "source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.10.107",
                    "version": "3.10.107",
                    "upstream_commit": "128394eff343fc6d2f32172f03e24829539c5835",
                    "fixed": []
                },
                {
                    "description": "sg_write()/bsg_write() is not fit to be called under KERNEL_DS",
                    "commit": "7eb9e6472cbdd8e2df774ae91531c8959e21dbbc",
                    "source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.12.70",
                    "version": "3.12.70",
                    "upstream_commit": "128394eff343fc6d2f32172f03e24829539c5835",
                    "fixed": []
                },
                {
                    "description": "sg_write()/bsg_write() is not fit to be called under KERNEL_DS",
                    "commit": "249741c2c0d7a905da66efc6d1292d3915aef1fc",
                    "source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.16.40",
                    "version": "3.16.40",
                    "upstream_commit": "128394eff343fc6d2f32172f03e24829539c5835",
                    "fixed": []
                },
                {
                    "description": "sg_write()/bsg_write() is not fit to be called under KERNEL_DS",
                    "commit": "a861b9212ab44dc9483259b1f9376e74bae2ad37",
                    "source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.18.47",
                    "version": "3.18.47",
                    "upstream_commit": "128394eff343fc6d2f32172f03e24829539c5835",
                    "fixed": []
                },
                {
                    "description": "sg_write()/bsg_write() is not fit to be called under KERNEL_DS",
                    "commit": "3e3267311e3b6557206f293eeb9205b41e090625",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.1.38",
                    "version": "4.1.38",
                    "upstream_commit": "128394eff343fc6d2f32172f03e24829539c5835",
                    "fixed": []
                },
                {
                    "description": "sg_write()/bsg_write() is not fit to be called under KERNEL_DS",
                    "commit": "d85727365859108cbcf832c2b3c38358ddc7638b",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.4.41",
                    "version": "4.4.41",
                    "upstream_commit": "128394eff343fc6d2f32172f03e24829539c5835",
                    "fixed": []
                },
                {
                    "description": "sg_write()/bsg_write() is not fit to be called under KERNEL_DS",
                    "commit": "48f26edb689c83af15b6afe657e96424ca9d13d9",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.8.17",
                    "version": "4.8.17",
                    "upstream_commit": "128394eff343fc6d2f32172f03e24829539c5835",
                    "fixed": []
                },
                {
                    "description": "sg_write()/bsg_write() is not fit to be called under KERNEL_DS",
                    "commit": "3f3a6bbe6f9f5e895d8945494173594ee51632da",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.9.2",
                    "version": "4.9.2",
                    "upstream_commit": "128394eff343fc6d2f32172f03e24829539c5835",
                    "fixed": []
                }
            ],
            "Don't feed anything but regular iovec's to blk_rq_map_user_iov": [
                {
                    "description": "Don't feed anything but regular iovec's to blk_rq_map_user_iov",
                    "commit": "a0ac402cfcdc904f9772e1762b3fda112dcc56a0",
                    "source": "https://github.com/torvalds/linux/commit/a0ac402cfcdc904f9772e1762b3fda112dcc56a0",
                    "version": "-",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "26e49cfc7e98",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/26e49cfc7e98",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "sg_write()/bsg_write() is not fit to be called under KERNEL_DS",
                    "commit": "e30250c95b840896da4cb71e84bead5803ee1ff6",
                    "source": "https://www.kernel.org/pub//linux/kernel/v3.x/ChangeLog-3.2.85",
                    "version": "3.2.85",
                    "upstream_commit": "a0ac402cfcdc904f9772e1762b3fda112dcc56a0",
                    "fixed": []
                },
                {
                    "description": "Don't feed anything but regular iovec's to blk_rq_map_user_iov",
                    "commit": "d41fb2fbb28d3a1085960edada6c046becd1fafd",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.4.38",
                    "version": "4.4.38",
                    "upstream_commit": "a0ac402cfcdc904f9772e1762b3fda112dcc56a0",
                    "fixed": []
                },
                {
                    "description": "Don't feed anything but regular iovec's to blk_rq_map_user_iov",
                    "commit": "22d94c3266601ac14ff70c76e14ea05d2263b914",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.8.14",
                    "version": "4.8.14",
                    "upstream_commit": "a0ac402cfcdc904f9772e1762b3fda112dcc56a0",
                    "fixed": []
                }
            ]
        }
    }
}