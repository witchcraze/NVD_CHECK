{
    "CVE-ID": "CVE-2024-49935",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nACPI: PAD: fix crash in exit_round_robin()\n\nThe kernel occasionally crashes in cpumask_clear_cpu(), which is called\nwithin exit_round_robin(), because when executing clear_bit(nr, addr) with\nnr set to 0xffffffff, the address calculation may cause misalignment within\nthe memory, leading to access to an invalid memory address.\n\n----------\nBUG: unable to handle kernel paging request at ffffffffe0740618\n        ...\nCPU: 3 PID: 2919323 Comm: acpi_pad/14 Kdump: loaded Tainted: G           OE  X --------- -  - 4.18.0-425.19.2.el8_7.x86_64 #1\n        ...\nRIP: 0010:power_saving_thread+0x313/0x411 [acpi_pad]\nCode: 89 cd 48 89 d3 eb d1 48 c7 c7 55 70 72 c0 e8 64 86 b0 e4 c6 05 0d a1 02 00 01 e9 bc fd ff ff 45 89 e4 42 8b 04 a5 20 82 72 c0 <f0> 48 0f b3 05 f4 9c 01 00 42 c7 04 a5 20 82 72 c0 ff ff ff ff 31\nRSP: 0018:ff72a5d51fa77ec8 EFLAGS: 00010202\nRAX: 00000000ffffffff RBX: ff462981e5d8cb80 RCX: 0000000000000000\nRDX: 0000000000000000 RSI: 0000000000000246 RDI: 0000000000000246\nRBP: ff46297556959d80 R08: 0000000000000382 R09: ff46297c8d0f38d8\nR10: 0000000000000000 R11: 0000000000000001 R12: 000000000000000e\nR13: 0000000000000000 R14: ffffffffffffffff R15: 000000000000000e\nFS:  0000000000000000(0000) GS:ff46297a800c0000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: ffffffffe0740618 CR3: 0000007e20410004 CR4: 0000000000771ee0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nPKRU: 55555554\nCall Trace:\n ? acpi_pad_add+0x120/0x120 [acpi_pad]\n kthread+0x10b/0x130\n ? set_kthread_struct+0x50/0x50\n ret_from_fork+0x1f/0x40\n        ...\nCR2: ffffffffe0740618\n\ncrash> dis -lr ffffffffc0726923\n        ...\n/usr/src/debug/kernel-4.18.0-425.19.2.el8_7/linux-4.18.0-425.19.2.el8_7.x86_64/./include/linux/cpumask.h: 114\n0xffffffffc0726918 <power_saving_thread+776>:\tmov    %r12d,%r12d\n/usr/src/debug/kernel-4.18.0-425.19.2.el8_7/linux-4.18.0-425.19.2.el8_7.x86_64/./include/linux/cpumask.h: 325\n0xffffffffc072691b <power_saving_thread+779>:\tmov    -0x3f8d7de0(,%r12,4),%eax\n/usr/src/debug/kernel-4.18.0-425.19.2.el8_7/linux-4.18.0-425.19.2.el8_7.x86_64/./arch/x86/include/asm/bitops.h: 80\n0xffffffffc0726923 <power_saving_thread+787>:\tlock btr %rax,0x19cf4(%rip)        # 0xffffffffc0740620 <pad_busy_cpus_bits>\n\ncrash> px tsk_in_cpu[14]\n$66 = 0xffffffff\n\ncrash> px 0xffffffffc072692c+0x19cf4\n$99 = 0xffffffffc0740620\n\ncrash> sym 0xffffffffc0740620\nffffffffc0740620 (b) pad_busy_cpus_bits [acpi_pad]\n\ncrash> px pad_busy_cpus_bits[0]\n$42 = 0xfffc0\n----------\n\nTo fix this, ensure that tsk_in_cpu[tsk_index] != -1 before calling\ncpumask_clear_cpu() in exit_round_robin(), just as it is done in\nround_robin_cpu().\n\n[ rjw: Subject edit, avoid updates to the same value ]",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "5.15.168",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.1.113",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.11",
                "VersionEndExcluding": "6.11.3",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.6.55",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.7",
                "VersionEndExcluding": "6.10.14",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.10.240": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.240"
            ]
        },
        "5.15.168": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.168"
            ]
        },
        "5.4.296": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.296"
            ]
        },
        "6.1.113": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.113"
            ]
        },
        "6.10.14": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.10.14"
            ]
        },
        "6.11.3": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.11.3"
            ]
        },
        "6.12": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12"
            ]
        },
        "6.6.55": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.55"
            ]
        },
        "commit": {
            "ACPI: PAD: fix crash in exit_round_robin()": [
                {
                    "description": "ACPI: PAD: fix crash in exit_round_robin()",
                    "commit": "d214ffa6eb39c08d18a460124dd7ba318dc56f33",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.240",
                    "version": "5.10.240",
                    "upstream_commit": "0a2ed70a549e61c5181bad5db418d223b68ae932",
                    "fixed": []
                },
                {
                    "description": "ACPI: PAD: fix crash in exit_round_robin()",
                    "commit": "92e5661b7d0727ab912b76625a88b33fdb9b609a",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.168",
                    "version": "5.15.168",
                    "upstream_commit": "0a2ed70a549e61c5181bad5db418d223b68ae932",
                    "fixed": []
                },
                {
                    "description": "ACPI: PAD: fix crash in exit_round_robin()",
                    "commit": "82191a21a0dedc8c64e14f07f5d568d09bc4b331",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.296",
                    "version": "5.4.296",
                    "upstream_commit": "0a2ed70a549e61c5181bad5db418d223b68ae932",
                    "fixed": []
                },
                {
                    "description": "ACPI: PAD: fix crash in exit_round_robin()",
                    "commit": "68a599da16ebad442ce295d8d2d5c488e3992822",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.113",
                    "version": "6.1.113",
                    "upstream_commit": "0a2ed70a549e61c5181bad5db418d223b68ae932",
                    "fixed": []
                },
                {
                    "description": "ACPI: PAD: fix crash in exit_round_robin()",
                    "commit": "03593dbb0b272ef7b0358b099841e65735422aca",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.10.14",
                    "version": "6.10.14",
                    "upstream_commit": "0a2ed70a549e61c5181bad5db418d223b68ae932",
                    "fixed": []
                },
                {
                    "description": "ACPI: PAD: fix crash in exit_round_robin()",
                    "commit": "27c045f868f0e5052c6b532868a65e0cd250c8fc",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.11.3",
                    "version": "6.11.3",
                    "upstream_commit": "0a2ed70a549e61c5181bad5db418d223b68ae932",
                    "fixed": []
                },
                {
                    "description": "ACPI: PAD: fix crash in exit_round_robin()",
                    "commit": "0a2ed70a549e61c5181bad5db418d223b68ae932",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12",
                    "version": "6.12",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "8e0af5141ab9",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/8e0af5141ab9",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "ACPI: PAD: fix crash in exit_round_robin()",
                    "commit": "68a8e45743d6a120f863fb14b72dc59616597019",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.55",
                    "version": "6.6.55",
                    "upstream_commit": "0a2ed70a549e61c5181bad5db418d223b68ae932",
                    "fixed": []
                }
            ]
        }
    }
}