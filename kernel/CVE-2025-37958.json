{
    "CVE-ID": "CVE-2025-37958",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm/huge_memory: fix dereferencing invalid pmd migration entry\n\nWhen migrating a THP, concurrent access to the PMD migration entry during\na deferred split scan can lead to an invalid address access, as\nillustrated below.  To prevent this invalid access, it is necessary to\ncheck the PMD migration entry and return early.  In this context, there is\nno need to use pmd_to_swp_entry and pfn_swap_entry_to_page to verify the\nequality of the target folio.  Since the PMD migration entry is locked, it\ncannot be served as the target.\n\nMailing list discussion and explanation from Hugh Dickins: \"An anon_vma\nlookup points to a location which may contain the folio of interest, but\nmight instead contain another folio: and weeding out those other folios is\nprecisely what the \"folio != pmd_folio((*pmd)\" check (and the \"risk of\nreplacing the wrong folio\" comment a few lines above it) is for.\"\n\nBUG: unable to handle page fault for address: ffffea60001db008\nCPU: 0 UID: 0 PID: 2199114 Comm: tee Not tainted 6.14.0+ #4 NONE\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-debian-1.16.3-2 04/01/2014\nRIP: 0010:split_huge_pmd_locked+0x3b5/0x2b60\nCall Trace:\n<TASK>\ntry_to_migrate_one+0x28c/0x3730\nrmap_walk_anon+0x4f6/0x770\nunmap_folio+0x196/0x1f0\nsplit_huge_page_to_list_to_order+0x9f6/0x1560\ndeferred_split_scan+0xac5/0x12a0\nshrinker_debugfs_scan_write+0x376/0x470\nfull_proxy_write+0x15c/0x220\nvfs_write+0x2fc/0xcb0\nksys_write+0x146/0x250\ndo_syscall_64+0x6a/0x120\nentry_SYSCALL_64_after_hwframe+0x76/0x7e\n\nThe bug is found by syzkaller on an internal kernel, then confirmed on\nupstream.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.15:rc5",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.15:rc5:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.15:rc4",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.15:rc4:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.15:rc3",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.15:rc3:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.15:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.15:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.15:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.15:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.14",
                "VersionEndExcluding": "5.4.295",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.186",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.1.142",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.5",
                "VersionEndExcluding": "5.10.239",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.13",
                "VersionEndExcluding": "6.14.7",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.6.95",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.7",
                "VersionEndExcluding": "6.12.29",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:debian:debian_linux:11.0",
                "FormattedString": "cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.10.239": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.239"
            ]
        },
        "5.15.186": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.186"
            ]
        },
        "5.4.295": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.295"
            ]
        },
        "6.1.142": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.142"
            ]
        },
        "6.12.29": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.29"
            ]
        },
        "6.14.7": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.14.7"
            ]
        },
        "6.15": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.15"
            ]
        },
        "6.6.95": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.95"
            ]
        },
        "commit": {
            "mm/huge_memory: fix dereferencing invalid pmd migration entry": [
                {
                    "description": "mm/huge_memory: fix dereferencing invalid pmd migration entry",
                    "commit": "9468afbda3fbfcec21ac8132364dff3dab945faf",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.239",
                    "version": "5.10.239",
                    "upstream_commit": "be6e843fc51a584672dfd9c4a6a24c8cb81d5fb7",
                    "fixed": [
                        {
                            "fixed_commit": "84c3fc4e9c56",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/84c3fc4e9c56",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "mm/huge_memory: fix dereferencing invalid pmd migration entry",
                    "commit": "ef5706bed97e240b4abf4233ceb03da7336bc775",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.186",
                    "version": "5.15.186",
                    "upstream_commit": "be6e843fc51a584672dfd9c4a6a24c8cb81d5fb7",
                    "fixed": [
                        {
                            "fixed_commit": "84c3fc4e9c56",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/84c3fc4e9c56",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "mm/huge_memory: fix dereferencing invalid pmd migration entry",
                    "commit": "753f142f7ff7d2223a47105b61e1efd91587d711",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.295",
                    "version": "5.4.295",
                    "upstream_commit": "be6e843fc51a584672dfd9c4a6a24c8cb81d5fb7",
                    "fixed": [
                        {
                            "fixed_commit": "84c3fc4e9c56",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/84c3fc4e9c56",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "mm/huge_memory: fix dereferencing invalid pmd migration entry",
                    "commit": "22f6368768340260e862f35151d2e1c55cb1dc75",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.142",
                    "version": "6.1.142",
                    "upstream_commit": "be6e843fc51a584672dfd9c4a6a24c8cb81d5fb7",
                    "fixed": [
                        {
                            "fixed_commit": "84c3fc4e9c56",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/84c3fc4e9c56",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "mm/huge_memory: fix dereferencing invalid pmd migration entry",
                    "commit": "6166c3cf405441f7147b322980144feb3cefc617",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.29",
                    "version": "6.12.29",
                    "upstream_commit": "be6e843fc51a584672dfd9c4a6a24c8cb81d5fb7",
                    "fixed": [
                        {
                            "fixed_commit": "84c3fc4e9c56",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/84c3fc4e9c56",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "mm/huge_memory: fix dereferencing invalid pmd migration entry",
                    "commit": "fbab262b0c8226c697af1851a424896ed47dedcc",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.14.7",
                    "version": "6.14.7",
                    "upstream_commit": "be6e843fc51a584672dfd9c4a6a24c8cb81d5fb7",
                    "fixed": [
                        {
                            "fixed_commit": "84c3fc4e9c56",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/84c3fc4e9c56",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "mm/huge_memory: fix dereferencing invalid pmd migration entry",
                    "commit": "be6e843fc51a584672dfd9c4a6a24c8cb81d5fb7",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.15",
                    "version": "6.15",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "84c3fc4e9c56",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/84c3fc4e9c56",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "mm/huge_memory: fix dereferencing invalid pmd migration entry",
                    "commit": "3977946f61cdba87b6b5aaf7d7094e96089583a5",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.95",
                    "version": "6.6.95",
                    "upstream_commit": "be6e843fc51a584672dfd9c4a6a24c8cb81d5fb7",
                    "fixed": [
                        {
                            "fixed_commit": "84c3fc4e9c56",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/84c3fc4e9c56",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}