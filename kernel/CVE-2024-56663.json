{
    "CVE-ID": "CVE-2024-56663",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nwifi: nl80211: fix NL80211_ATTR_MLO_LINK_ID off-by-one\n\nSince the netlink attribute range validation provides inclusive\nchecking, the *max* of attribute NL80211_ATTR_MLO_LINK_ID should be\nIEEE80211_MLD_MAX_NUM_LINKS - 1 otherwise causing an off-by-one.\n\nOne crash stack for demonstration:\n==================================================================\nBUG: KASAN: wild-memory-access in ieee80211_tx_control_port+0x3b6/0xca0 net/mac80211/tx.c:5939\nRead of size 6 at addr 001102080000000c by task fuzzer.386/9508\n\nCPU: 1 PID: 9508 Comm: syz.1.386 Not tainted 6.1.70 #2\nCall Trace:\n <TASK>\n __dump_stack lib/dump_stack.c:88 [inline]\n dump_stack_lvl+0x177/0x231 lib/dump_stack.c:106\n print_report+0xe0/0x750 mm/kasan/report.c:398\n kasan_report+0x139/0x170 mm/kasan/report.c:495\n kasan_check_range+0x287/0x290 mm/kasan/generic.c:189\n memcpy+0x25/0x60 mm/kasan/shadow.c:65\n ieee80211_tx_control_port+0x3b6/0xca0 net/mac80211/tx.c:5939\n rdev_tx_control_port net/wireless/rdev-ops.h:761 [inline]\n nl80211_tx_control_port+0x7b3/0xc40 net/wireless/nl80211.c:15453\n genl_family_rcv_msg_doit+0x22e/0x320 net/netlink/genetlink.c:756\n genl_family_rcv_msg net/netlink/genetlink.c:833 [inline]\n genl_rcv_msg+0x539/0x740 net/netlink/genetlink.c:850\n netlink_rcv_skb+0x1de/0x420 net/netlink/af_netlink.c:2508\n genl_rcv+0x24/0x40 net/netlink/genetlink.c:861\n netlink_unicast_kernel net/netlink/af_netlink.c:1326 [inline]\n netlink_unicast+0x74b/0x8c0 net/netlink/af_netlink.c:1352\n netlink_sendmsg+0x882/0xb90 net/netlink/af_netlink.c:1874\n sock_sendmsg_nosec net/socket.c:716 [inline]\n __sock_sendmsg net/socket.c:728 [inline]\n ____sys_sendmsg+0x5cc/0x8f0 net/socket.c:2499\n ___sys_sendmsg+0x21c/0x290 net/socket.c:2553\n __sys_sendmsg net/socket.c:2582 [inline]\n __do_sys_sendmsg net/socket.c:2591 [inline]\n __se_sys_sendmsg+0x19e/0x270 net/socket.c:2589\n do_syscall_x64 arch/x86/entry/common.c:51 [inline]\n do_syscall_64+0x45/0x90 arch/x86/entry/common.c:81\n entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\nUpdate the policy to ensure correct validation.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 7.1,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.13:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.13:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.13:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.13:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.19.2",
                "VersionEndExcluding": "5.20",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.0",
                "VersionEndExcluding": "6.1.121",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.6.67",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.7",
                "VersionEndExcluding": "6.12.6",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "6.1.121": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.121"
            ]
        },
        "6.12.6": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.6"
            ]
        },
        "6.13": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.13"
            ]
        },
        "6.6.67": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.67"
            ]
        },
        "commit": {
            "wifi: nl80211: fix NL80211_ATTR_MLO_LINK_ID off-by-one": [
                {
                    "description": "wifi: nl80211: fix NL80211_ATTR_MLO_LINK_ID off-by-one",
                    "commit": "29e640ae641b9f5ffc666049426d2b16c98d9963",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.121",
                    "version": "6.1.121",
                    "upstream_commit": "2e3dbf938656986cce73ac4083500d0bcfbffe24",
                    "fixed": [
                        {
                            "fixed_commit": "7b0a0e3c3a88",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0",
                            "fixed_commit_version": "6.0",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "7a53ad13c091",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19.2",
                            "fixed_commit_version": "5.19.2",
                            "fixed_commit_upstream_commit": "7b0a0e3c3a88260b6fcb017e49f198463aa62ed1"
                        }
                    ]
                },
                {
                    "description": "wifi: nl80211: fix NL80211_ATTR_MLO_LINK_ID off-by-one",
                    "commit": "f850d1d9f1106f528dfc5807565f2d1fa9a397d3",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.6",
                    "version": "6.12.6",
                    "upstream_commit": "2e3dbf938656986cce73ac4083500d0bcfbffe24",
                    "fixed": [
                        {
                            "fixed_commit": "7b0a0e3c3a88",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0",
                            "fixed_commit_version": "6.0",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "7a53ad13c091",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19.2",
                            "fixed_commit_version": "5.19.2",
                            "fixed_commit_upstream_commit": "7b0a0e3c3a88260b6fcb017e49f198463aa62ed1"
                        }
                    ]
                },
                {
                    "description": "wifi: nl80211: fix NL80211_ATTR_MLO_LINK_ID off-by-one",
                    "commit": "2e3dbf938656986cce73ac4083500d0bcfbffe24",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.13",
                    "version": "6.13",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "7b0a0e3c3a88",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0",
                            "fixed_commit_version": "6.0",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "7a53ad13c091",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19.2",
                            "fixed_commit_version": "5.19.2",
                            "fixed_commit_upstream_commit": "7b0a0e3c3a88260b6fcb017e49f198463aa62ed1"
                        }
                    ]
                },
                {
                    "description": "wifi: nl80211: fix NL80211_ATTR_MLO_LINK_ID off-by-one",
                    "commit": "f3412522f78826fef1dfae40ef378a863df2591c",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.67",
                    "version": "6.6.67",
                    "upstream_commit": "2e3dbf938656986cce73ac4083500d0bcfbffe24",
                    "fixed": [
                        {
                            "fixed_commit": "7b0a0e3c3a88",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0",
                            "fixed_commit_version": "6.0",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "7a53ad13c091",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19.2",
                            "fixed_commit_version": "5.19.2",
                            "fixed_commit_upstream_commit": "7b0a0e3c3a88260b6fcb017e49f198463aa62ed1"
                        }
                    ]
                }
            ]
        }
    }
}