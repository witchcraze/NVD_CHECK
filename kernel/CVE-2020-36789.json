{
    "CVE-ID": "CVE-2020-36789",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\ncan: dev: can_get_echo_skb(): prevent call to kfree_skb() in hard IRQ context\n\nIf a driver calls can_get_echo_skb() during a hardware IRQ (which is often, but\nnot always, the case), the 'WARN_ON(in_irq)' in\nnet/core/skbuff.c#skb_release_head_state() might be triggered, under network\ncongestion circumstances, together with the potential risk of a NULL pointer\ndereference.\n\nThe root cause of this issue is the call to kfree_skb() instead of\ndev_kfree_skb_irq() in net/core/dev.c#enqueue_to_backlog().\n\nThis patch prevents the skb to be freed within the call to netif_rx() by\nincrementing its reference count with skb_get(). The skb is finally freed by\none of the in-irq-context safe functions: dev_consume_skb_any() or\ndev_kfree_skb_any(). The \"any\" version is used because some drivers might call\ncan_get_echo_skb() in a normal context.\n\nThe reason for this issue to occur is that initially, in the core network\nstack, loopback skb were not supposed to be received in hardware IRQ context.\nThe CAN stack is an exeption.\n\nThis bug was previously reported back in 2017 in [1] but the proposed patch\nnever got accepted.\n\nWhile [1] directly modifies net/core/dev.c, we try to propose here a\nsmoother modification local to CAN network stack (the assumption\nbehind is that only CAN devices are affected by this issue).\n\n[1] http://lore.kernel.org/r/57a3ffb6-3309-3ad5-5a34-e93c3fe3614d@cetitec.com",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:5.10:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.10:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:5.10:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.10:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "2.6.31",
                "VersionEndExcluding": "4.4.244",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.10",
                "VersionEndExcluding": "4.14.207",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.15",
                "VersionEndExcluding": "4.19.158",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.20",
                "VersionEndExcluding": "5.4.78",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.5",
                "VersionEndExcluding": "4.9.244",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.5",
                "VersionEndExcluding": "5.9.9",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "4.14.207": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.14.207"
            ]
        },
        "4.19.158": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.158"
            ]
        },
        "4.4.244": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.4.244"
            ]
        },
        "4.9.244": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.9.244"
            ]
        },
        "5.10": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10"
            ]
        },
        "5.4.78": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.78"
            ]
        },
        "5.9.9": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.9.9"
            ]
        },
        "commit": {
            "can: dev: can_get_echo_skb(): prevent call to kfree_skb() in hard IRQ context": [
                {
                    "description": "can: dev: can_get_echo_skb(): prevent call to kfree_skb() in hard IRQ context",
                    "commit": "3a922a85701939624484e7f2fd07d32beed00d25",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.14.207",
                    "version": "4.14.207",
                    "upstream_commit": "2283f79b22684d2812e5c76fc2280aae00390365",
                    "fixed": [
                        {
                            "fixed_commit": "39549eef3587",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/39549eef3587",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "can: dev: can_get_echo_skb(): prevent call to kfree_skb() in hard IRQ context",
                    "commit": "7e4cf2ec0ca236c3e5f904239cec6efe1f3baf22",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.158",
                    "version": "4.19.158",
                    "upstream_commit": "2283f79b22684d2812e5c76fc2280aae00390365",
                    "fixed": [
                        {
                            "fixed_commit": "39549eef3587",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/39549eef3587",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "can: dev: can_get_echo_skb(): prevent call to kfree_skb() in hard IRQ context",
                    "commit": "248b71ce92d4f3a574b2537f9838f48e892618f4",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.4.244",
                    "version": "4.4.244",
                    "upstream_commit": "2283f79b22684d2812e5c76fc2280aae00390365",
                    "fixed": [
                        {
                            "fixed_commit": "39549eef3587",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/39549eef3587",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "can: dev: can_get_echo_skb(): prevent call to kfree_skb() in hard IRQ context",
                    "commit": "451187b20431924d13fcfecc500d7cd2d9951bac",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.9.244",
                    "version": "4.9.244",
                    "upstream_commit": "2283f79b22684d2812e5c76fc2280aae00390365",
                    "fixed": [
                        {
                            "fixed_commit": "39549eef3587",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/39549eef3587",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "can: dev: can_get_echo_skb(): prevent call to kfree_skb() in hard IRQ context",
                    "commit": "2283f79b22684d2812e5c76fc2280aae00390365",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                    "version": "5.10",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "39549eef3587",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/39549eef3587",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "can: dev: can_get_echo_skb(): prevent call to kfree_skb() in hard IRQ context",
                    "commit": "ab46748bf98864f9c3f5559060bf8caf9df2b41e",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.78",
                    "version": "5.4.78",
                    "upstream_commit": "2283f79b22684d2812e5c76fc2280aae00390365",
                    "fixed": [
                        {
                            "fixed_commit": "39549eef3587",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/39549eef3587",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "can: dev: can_get_echo_skb(): prevent call to kfree_skb() in hard IRQ context",
                    "commit": "87530b557affe01c764de32dbeb58cdf47234574",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.9.9",
                    "version": "5.9.9",
                    "upstream_commit": "2283f79b22684d2812e5c76fc2280aae00390365",
                    "fixed": [
                        {
                            "fixed_commit": "39549eef3587",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/39549eef3587",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}