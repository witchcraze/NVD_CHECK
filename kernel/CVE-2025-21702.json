{
    "CVE-ID": "CVE-2025-21702",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\npfifo_tail_enqueue: Drop new packet when sch->limit == 0\n\nExpected behaviour:\nIn case we reach scheduler's limit, pfifo_tail_enqueue() will drop a\npacket in scheduler's queue and decrease scheduler's qlen by one.\nThen, pfifo_tail_enqueue() enqueue new packet and increase\nscheduler's qlen by one. Finally, pfifo_tail_enqueue() return\n`NET_XMIT_CN` status code.\n\nWeird behaviour:\nIn case we set `sch->limit == 0` and trigger pfifo_tail_enqueue() on a\nscheduler that has no packet, the 'drop a packet' step will do nothing.\nThis means the scheduler's qlen still has value equal 0.\nThen, we continue to enqueue new packet and increase scheduler's qlen by\none. In summary, we can leverage pfifo_tail_enqueue() to increase qlen by\none and return `NET_XMIT_CN` status code.\n\nThe problem is:\nLet's say we have two qdiscs: Qdisc_A and Qdisc_B.\n - Qdisc_A's type must have '->graft()' function to create parent/child relationship.\n   Let's say Qdisc_A's type is `hfsc`. Enqueue packet to this qdisc will trigger `hfsc_enqueue`.\n - Qdisc_B's type is pfifo_head_drop. Enqueue packet to this qdisc will trigger `pfifo_tail_enqueue`.\n - Qdisc_B is configured to have `sch->limit == 0`.\n - Qdisc_A is configured to route the enqueued's packet to Qdisc_B.\n\nEnqueue packet through Qdisc_A will lead to:\n - hfsc_enqueue(Qdisc_A) -> pfifo_tail_enqueue(Qdisc_B)\n - Qdisc_B->q.qlen += 1\n - pfifo_tail_enqueue() return `NET_XMIT_CN`\n - hfsc_enqueue() check for `NET_XMIT_SUCCESS` and see `NET_XMIT_CN` => hfsc_enqueue() don't increase qlen of Qdisc_A.\n\nThe whole process lead to a situation where Qdisc_A->q.qlen == 0 and Qdisc_B->q.qlen == 1.\nReplace 'hfsc' with other type (for example: 'drr') still lead to the same problem.\nThis violate the design where parent's qlen should equal to the sum of its childrens'qlen.\n\nBug impact: This issue can be used for user->kernel privilege escalation when it is reachable.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 7,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.14:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.14:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "2.6.34",
                "VersionEndExcluding": "5.4.291",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.179",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.1.130",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.5",
                "VersionEndExcluding": "5.10.235",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.13",
                "VersionEndExcluding": "6.13.3",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.6.83",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.7",
                "VersionEndExcluding": "6.12.14",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.10.235": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.235"
            ]
        },
        "5.15.179": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.179"
            ]
        },
        "5.4.291": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.291"
            ]
        },
        "6.1.130": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.130"
            ]
        },
        "6.12.14": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.14"
            ]
        },
        "6.13.3": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.13.3"
            ]
        },
        "6.14": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.14"
            ]
        },
        "6.6.83": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.83"
            ]
        },
        "commit": {
            "pfifo_tail_enqueue: Drop new packet when sch->limit == 0": [
                {
                    "description": "pfifo_tail_enqueue: Drop new packet when sch->limit == 0",
                    "commit": "7a9723ec27aff5674f1fd4934608937f1d650980",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.235",
                    "version": "5.10.235",
                    "upstream_commit": "647cef20e649c576dff271e018d5d15d998b629d",
                    "fixed": [
                        {
                            "fixed_commit": "57dbb2d83d10",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/57dbb2d83d10",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "pfifo_tail_enqueue: Drop new packet when sch->limit == 0",
                    "commit": "a56a6e8589a9b98d8171611fbcc1e45a15fd2455",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.179",
                    "version": "5.15.179",
                    "upstream_commit": "647cef20e649c576dff271e018d5d15d998b629d",
                    "fixed": [
                        {
                            "fixed_commit": "57dbb2d83d10",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/57dbb2d83d10",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "pfifo_tail_enqueue: Drop new packet when sch->limit == 0",
                    "commit": "78285b53266d6d51fa4ff504a23df03852eba84e",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.291",
                    "version": "5.4.291",
                    "upstream_commit": "647cef20e649c576dff271e018d5d15d998b629d",
                    "fixed": [
                        {
                            "fixed_commit": "57dbb2d83d10",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/57dbb2d83d10",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "pfifo_tail_enqueue: Drop new packet when sch->limit == 0",
                    "commit": "020ecb76812a0526f4130ab5aeb6dc7c773e7ab9",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.130",
                    "version": "6.1.130",
                    "upstream_commit": "647cef20e649c576dff271e018d5d15d998b629d",
                    "fixed": [
                        {
                            "fixed_commit": "57dbb2d83d10",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/57dbb2d83d10",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "pfifo_tail_enqueue: Drop new packet when sch->limit == 0",
                    "commit": "e40cb34b7f247fe2e366fd192700d1b4f38196ca",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.14",
                    "version": "6.12.14",
                    "upstream_commit": "647cef20e649c576dff271e018d5d15d998b629d",
                    "fixed": [
                        {
                            "fixed_commit": "57dbb2d83d10",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/57dbb2d83d10",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "pfifo_tail_enqueue: Drop new packet when sch->limit == 0",
                    "commit": "b6a079c3b6f95378f26e2aeda520cb3176f7067b",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.13.3",
                    "version": "6.13.3",
                    "upstream_commit": "647cef20e649c576dff271e018d5d15d998b629d",
                    "fixed": [
                        {
                            "fixed_commit": "57dbb2d83d10",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/57dbb2d83d10",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "pfifo_tail_enqueue: Drop new packet when sch->limit == 0",
                    "commit": "647cef20e649c576dff271e018d5d15d998b629d",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.14",
                    "version": "6.14",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "57dbb2d83d10",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/57dbb2d83d10",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "pfifo_tail_enqueue: Drop new packet when sch->limit == 0",
                    "commit": "79a955ea4a2e5ddf4a36328959de0de496419888",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.83",
                    "version": "6.6.83",
                    "upstream_commit": "647cef20e649c576dff271e018d5d15d998b629d",
                    "fixed": [
                        {
                            "fixed_commit": "57dbb2d83d10",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/57dbb2d83d10",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}