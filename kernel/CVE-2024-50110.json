{
    "CVE-ID": "CVE-2024-50110",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nxfrm: fix one more kernel-infoleak in algo dumping\n\nDuring fuzz testing, the following issue was discovered:\n\nBUG: KMSAN: kernel-infoleak in _copy_to_iter+0x598/0x2a30\n _copy_to_iter+0x598/0x2a30\n __skb_datagram_iter+0x168/0x1060\n skb_copy_datagram_iter+0x5b/0x220\n netlink_recvmsg+0x362/0x1700\n sock_recvmsg+0x2dc/0x390\n __sys_recvfrom+0x381/0x6d0\n __x64_sys_recvfrom+0x130/0x200\n x64_sys_call+0x32c8/0x3cc0\n do_syscall_64+0xd8/0x1c0\n entry_SYSCALL_64_after_hwframe+0x79/0x81\n\nUninit was stored to memory at:\n copy_to_user_state_extra+0xcc1/0x1e00\n dump_one_state+0x28c/0x5f0\n xfrm_state_walk+0x548/0x11e0\n xfrm_dump_sa+0x1e0/0x840\n netlink_dump+0x943/0x1c40\n __netlink_dump_start+0x746/0xdb0\n xfrm_user_rcv_msg+0x429/0xc00\n netlink_rcv_skb+0x613/0x780\n xfrm_netlink_rcv+0x77/0xc0\n netlink_unicast+0xe90/0x1280\n netlink_sendmsg+0x126d/0x1490\n __sock_sendmsg+0x332/0x3d0\n ____sys_sendmsg+0x863/0xc30\n ___sys_sendmsg+0x285/0x3e0\n __x64_sys_sendmsg+0x2d6/0x560\n x64_sys_call+0x1316/0x3cc0\n do_syscall_64+0xd8/0x1c0\n entry_SYSCALL_64_after_hwframe+0x79/0x81\n\nUninit was created at:\n __kmalloc+0x571/0xd30\n attach_auth+0x106/0x3e0\n xfrm_add_sa+0x2aa0/0x4230\n xfrm_user_rcv_msg+0x832/0xc00\n netlink_rcv_skb+0x613/0x780\n xfrm_netlink_rcv+0x77/0xc0\n netlink_unicast+0xe90/0x1280\n netlink_sendmsg+0x126d/0x1490\n __sock_sendmsg+0x332/0x3d0\n ____sys_sendmsg+0x863/0xc30\n ___sys_sendmsg+0x285/0x3e0\n __x64_sys_sendmsg+0x2d6/0x560\n x64_sys_call+0x1316/0x3cc0\n do_syscall_64+0xd8/0x1c0\n entry_SYSCALL_64_after_hwframe+0x79/0x81\n\nBytes 328-379 of 732 are uninitialized\nMemory access of size 732 starts at ffff88800e18e000\nData copied to user address 00007ff30f48aff0\n\nCPU: 2 PID: 18167 Comm: syz-executor.0 Not tainted 6.8.11 #1\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014\n\nFixes copying of xfrm algorithms where some random\ndata of the structure fields can end up in userspace.\nPadding in structures may be filled with random (possibly sensitve)\ndata and should never be given directly to user-space.\n\nA similar issue was resolved in the commit\n8222d5910dae (\"xfrm: Zero padding when dumping algos and encap\")\n\nFound by Linux Verification Center (linuxtesting.org) with Syzkaller.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc4",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc3",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.170",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.1.115",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.6.59",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.7",
                "VersionEndExcluding": "6.11.6",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.15.170": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.170"
            ]
        },
        "6.1.115": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.115"
            ]
        },
        "6.11.6": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.11.6"
            ]
        },
        "6.12": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12"
            ]
        },
        "6.6.59": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.59"
            ]
        },
        "commit": {
            "xfrm: fix one more kernel-infoleak in algo dumping": [
                {
                    "description": "xfrm: fix one more kernel-infoleak in algo dumping",
                    "commit": "610d4cea9b442b22b4820695fc3335e64849725e",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.170",
                    "version": "5.15.170",
                    "upstream_commit": "6889cd2a93e1e3606b3f6e958aa0924e836de4d2",
                    "fixed": [
                        {
                            "fixed_commit": "c7a5899eb26e",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "xfrm: fix one more kernel-infoleak in algo dumping",
                    "commit": "dc2ad8e8818e4bf1a93db78d81745b4877b32972",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.115",
                    "version": "6.1.115",
                    "upstream_commit": "6889cd2a93e1e3606b3f6e958aa0924e836de4d2",
                    "fixed": [
                        {
                            "fixed_commit": "c7a5899eb26e",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "xfrm: fix one more kernel-infoleak in algo dumping",
                    "commit": "1e8fbd2441cb2ea28d6825f2985bf7d84af060bb",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.11.6",
                    "version": "6.11.6",
                    "upstream_commit": "6889cd2a93e1e3606b3f6e958aa0924e836de4d2",
                    "fixed": [
                        {
                            "fixed_commit": "c7a5899eb26e",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "xfrm: fix one more kernel-infoleak in algo dumping",
                    "commit": "6889cd2a93e1e3606b3f6e958aa0924e836de4d2",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12",
                    "version": "6.12",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "c7a5899eb26e",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "xfrm: fix one more kernel-infoleak in algo dumping",
                    "commit": "c73bca72b84b453c8d26a5e7673b20adb294bf54",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.59",
                    "version": "6.6.59",
                    "upstream_commit": "6889cd2a93e1e3606b3f6e958aa0924e836de4d2",
                    "fixed": [
                        {
                            "fixed_commit": "c7a5899eb26e",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}