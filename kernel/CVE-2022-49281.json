{
    "CVE-ID": "CVE-2022-49281",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\ncifs: fix handlecache and multiuser\n\nIn multiuser each individual user has their own tcon structure for the\nshare and thus their own handle for a cached directory.\nWhen we umount such a share we much make sure to release the pinned down dentry\nfor each such tcon and not just the master tcon.\n\nOtherwise we will get nasty warnings on umount that dentries are still in use:\n[ 3459.590047] BUG: Dentry 00000000115c6f41{i=12000000019d95,n=/}  still in use\\\n (2) [unmount of cifs cifs]\n...\n[ 3459.590492] Call Trace:\n[ 3459.590500]  d_walk+0x61/0x2a0\n[ 3459.590518]  ? shrink_lock_dentry.part.0+0xe0/0xe0\n[ 3459.590526]  shrink_dcache_for_umount+0x49/0x110\n[ 3459.590535]  generic_shutdown_super+0x1a/0x110\n[ 3459.590542]  kill_anon_super+0x14/0x30\n[ 3459.590549]  cifs_kill_sb+0xf5/0x104 [cifs]\n[ 3459.590773]  deactivate_locked_super+0x36/0xa0\n[ 3459.590782]  cleanup_mnt+0x131/0x190\n[ 3459.590789]  task_work_run+0x5c/0x90\n[ 3459.590798]  exit_to_user_mode_loop+0x151/0x160\n[ 3459.590809]  exit_to_user_mode_prepare+0x83/0xd0\n[ 3459.590818]  syscall_exit_to_user_mode+0x12/0x30\n[ 3459.590828]  do_syscall_64+0x48/0x90\n[ 3459.590833]  entry_SYSCALL_64_after_hwframe+0x44/0xae",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "5.15.33",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "5.16.19",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.17",
                "VersionEndExcluding": "5.17.2",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.15.33": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.33"
            ]
        },
        "5.16.19": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16.19"
            ]
        },
        "5.17.2": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17.2"
            ]
        },
        "5.18": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.18"
            ]
        },
        "commit": {
            "cifs: fix handlecache and multiuser": [
                {
                    "description": "cifs: fix handlecache and multiuser",
                    "commit": "2fafbc198613823943c106d1ec9b516da692059f",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.33",
                    "version": "5.15.33",
                    "upstream_commit": "47178c7722ac528ea08aa82c3ef9ffa178962d7a",
                    "fixed": []
                },
                {
                    "description": "cifs: fix handlecache and multiuser",
                    "commit": "ffa631c4bff59dde59b598011f570e27dfba3515",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16.19",
                    "version": "5.16.19",
                    "upstream_commit": "47178c7722ac528ea08aa82c3ef9ffa178962d7a",
                    "fixed": []
                },
                {
                    "description": "cifs: fix handlecache and multiuser",
                    "commit": "e71f6a3a1d5c826a30384fec587ca7503ef6bde5",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17.2",
                    "version": "5.17.2",
                    "upstream_commit": "47178c7722ac528ea08aa82c3ef9ffa178962d7a",
                    "fixed": []
                },
                {
                    "description": "cifs: fix handlecache and multiuser",
                    "commit": "47178c7722ac528ea08aa82c3ef9ffa178962d7a",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.18",
                    "version": "5.18",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "1da177e4c3f4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v2.6/ChangeLog-2.6.12",
                            "fixed_commit_version": "2.6.12",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}