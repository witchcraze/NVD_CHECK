{
    "CVE-ID": "CVE-2022-50211",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nmd-raid10: fix KASAN warning\n\nThere's a KASAN warning in raid10_remove_disk when running the lvm\ntest lvconvert-raid-reshape.sh. We fix this warning by verifying that the\nvalue \"number\" is valid.\n\nBUG: KASAN: slab-out-of-bounds in raid10_remove_disk+0x61/0x2a0 [raid10]\nRead of size 8 at addr ffff889108f3d300 by task mdX_raid10/124682\n\nCPU: 3 PID: 124682 Comm: mdX_raid10 Not tainted 5.19.0-rc6 #1\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.14.0-2 04/01/2014\nCall Trace:\n <TASK>\n dump_stack_lvl+0x34/0x44\n print_report.cold+0x45/0x57a\n ? __lock_text_start+0x18/0x18\n ? raid10_remove_disk+0x61/0x2a0 [raid10]\n kasan_report+0xa8/0xe0\n ? raid10_remove_disk+0x61/0x2a0 [raid10]\n raid10_remove_disk+0x61/0x2a0 [raid10]\nBuffer I/O error on dev dm-76, logical block 15344, async page read\n ? __mutex_unlock_slowpath.constprop.0+0x1e0/0x1e0\n remove_and_add_spares+0x367/0x8a0 [md_mod]\n ? super_written+0x1c0/0x1c0 [md_mod]\n ? mutex_trylock+0xac/0x120\n ? _raw_spin_lock+0x72/0xc0\n ? _raw_spin_lock_bh+0xc0/0xc0\n md_check_recovery+0x848/0x960 [md_mod]\n raid10d+0xcf/0x3360 [raid10]\n ? sched_clock_cpu+0x185/0x1a0\n ? rb_erase+0x4d4/0x620\n ? var_wake_function+0xe0/0xe0\n ? psi_group_change+0x411/0x500\n ? preempt_count_sub+0xf/0xc0\n ? _raw_spin_lock_irqsave+0x78/0xc0\n ? __lock_text_start+0x18/0x18\n ? raid10_sync_request+0x36c0/0x36c0 [raid10]\n ? preempt_count_sub+0xf/0xc0\n ? _raw_spin_unlock_irqrestore+0x19/0x40\n ? del_timer_sync+0xa9/0x100\n ? try_to_del_timer_sync+0xc0/0xc0\n ? _raw_spin_lock_irqsave+0x78/0xc0\n ? __lock_text_start+0x18/0x18\n ? _raw_spin_unlock_irq+0x11/0x24\n ? __list_del_entry_valid+0x68/0xa0\n ? finish_wait+0xa3/0x100\n md_thread+0x161/0x260 [md_mod]\n ? unregister_md_personality+0xa0/0xa0 [md_mod]\n ? _raw_spin_lock_irqsave+0x78/0xc0\n ? prepare_to_wait_event+0x2c0/0x2c0\n ? unregister_md_personality+0xa0/0xa0 [md_mod]\n kthread+0x148/0x180\n ? kthread_complete_and_exit+0x20/0x20\n ret_from_fork+0x1f/0x30\n </TASK>\n\nAllocated by task 124495:\n kasan_save_stack+0x1e/0x40\n __kasan_kmalloc+0x80/0xa0\n setup_conf+0x140/0x5c0 [raid10]\n raid10_run+0x4cd/0x740 [raid10]\n md_run+0x6f9/0x1300 [md_mod]\n raid_ctr+0x2531/0x4ac0 [dm_raid]\n dm_table_add_target+0x2b0/0x620 [dm_mod]\n table_load+0x1c8/0x400 [dm_mod]\n ctl_ioctl+0x29e/0x560 [dm_mod]\n dm_compat_ctl_ioctl+0x7/0x20 [dm_mod]\n __do_compat_sys_ioctl+0xfa/0x160\n do_syscall_64+0x90/0xc0\n entry_SYSCALL_64_after_hwframe+0x46/0xb0\n\nLast potentially related work creation:\n kasan_save_stack+0x1e/0x40\n __kasan_record_aux_stack+0x9e/0xc0\n kvfree_call_rcu+0x84/0x480\n timerfd_release+0x82/0x140\nL __fput+0xfa/0x400\n task_work_run+0x80/0xc0\n exit_to_user_mode_prepare+0x155/0x160\n syscall_exit_to_user_mode+0x12/0x40\n do_syscall_64+0x42/0xc0\n entry_SYSCALL_64_after_hwframe+0x46/0xb0\n\nSecond to last potentially related work creation:\n kasan_save_stack+0x1e/0x40\n __kasan_record_aux_stack+0x9e/0xc0\n kvfree_call_rcu+0x84/0x480\n timerfd_release+0x82/0x140\n __fput+0xfa/0x400\n task_work_run+0x80/0xc0\n exit_to_user_mode_prepare+0x155/0x160\n syscall_exit_to_user_mode+0x12/0x40\n do_syscall_64+0x42/0xc0\n entry_SYSCALL_64_after_hwframe+0x46/0xb0\n\nThe buggy address belongs to the object at ffff889108f3d200\n which belongs to the cache kmalloc-256 of size 256\nThe buggy address is located 0 bytes to the right of\n 256-byte region [ffff889108f3d200, ffff889108f3d300)\n\nThe buggy address belongs to the physical page:\npage:000000007ef2a34c refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x1108f3c\nhead:000000007ef2a34c order:2 compound_mapcount:0 compound_pincount:0\nflags: 0x4000000000010200(slab|head|zone=2)\nraw: 4000000000010200 0000000000000000 dead000000000001 ffff889100042b40\nraw: 0000000000000000 0000000080200020 00000001ffffffff 0000000000000000\npage dumped because: kasan: bad access detected\n\nMemory state around the buggy address:\n ffff889108f3d200: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n ffff889108f3d280: 00 00\n---truncated---",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 7.1,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "4.9.326",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.10",
                "VersionEndExcluding": "4.14.291",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.15",
                "VersionEndExcluding": "4.19.256",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.20",
                "VersionEndExcluding": "5.4.211",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.61",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "5.18.18",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.19",
                "VersionEndExcluding": "5.19.2",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.5",
                "VersionEndExcluding": "5.10.137",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "4.14.291": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.14.291"
            ]
        },
        "4.19.256": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.256"
            ]
        },
        "4.9.326": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.9.326"
            ]
        },
        "5.10.137": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.137"
            ]
        },
        "5.15.61": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.61"
            ]
        },
        "5.18.18": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.18.18"
            ]
        },
        "5.19.2": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19.2"
            ]
        },
        "5.4.211": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.211"
            ]
        },
        "6.0": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0"
            ]
        },
        "commit": {
            "md-raid10: fix KASAN warning": [
                {
                    "description": "md-raid10: fix KASAN warning",
                    "commit": "bcbdc26a44aba488d2f7122f2d66801bccb74733",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.14.291",
                    "version": "4.14.291",
                    "upstream_commit": "d17f744e883b2f8d13cca252d71cfe8ace346f7d",
                    "fixed": []
                },
                {
                    "description": "md-raid10: fix KASAN warning",
                    "commit": "7a6ccc8fa192fd357c2d5d4c6ce67c834a179e23",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.256",
                    "version": "4.19.256",
                    "upstream_commit": "d17f744e883b2f8d13cca252d71cfe8ace346f7d",
                    "fixed": []
                },
                {
                    "description": "md-raid10: fix KASAN warning",
                    "commit": "75fbd370a2cec9e92f48285bd90735ed0c837f52",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.9.326",
                    "version": "4.9.326",
                    "upstream_commit": "d17f744e883b2f8d13cca252d71cfe8ace346f7d",
                    "fixed": []
                },
                {
                    "description": "md-raid10: fix KASAN warning",
                    "commit": "5fd4ffa2372a41361d2bdd27ea5730e4e673240c",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.137",
                    "version": "5.10.137",
                    "upstream_commit": "d17f744e883b2f8d13cca252d71cfe8ace346f7d",
                    "fixed": []
                },
                {
                    "description": "md-raid10: fix KASAN warning",
                    "commit": "0f4d18cbea4a6e37a05fd8ee2887439f85211110",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.61",
                    "version": "5.15.61",
                    "upstream_commit": "d17f744e883b2f8d13cca252d71cfe8ace346f7d",
                    "fixed": []
                },
                {
                    "description": "md-raid10: fix KASAN warning",
                    "commit": "bf30b9ba09b0ac2a10f04dce2b0835ec4d178aa6",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.18.18",
                    "version": "5.18.18",
                    "upstream_commit": "d17f744e883b2f8d13cca252d71cfe8ace346f7d",
                    "fixed": []
                },
                {
                    "description": "md-raid10: fix KASAN warning",
                    "commit": "5f57843565131bb782388f9d993f9ee8f453dee1",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19.2",
                    "version": "5.19.2",
                    "upstream_commit": "d17f744e883b2f8d13cca252d71cfe8ace346f7d",
                    "fixed": []
                },
                {
                    "description": "md-raid10: fix KASAN warning",
                    "commit": "ce839b9331c11780470f3d727b6fe3c2794a4620",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.211",
                    "version": "5.4.211",
                    "upstream_commit": "d17f744e883b2f8d13cca252d71cfe8ace346f7d",
                    "fixed": []
                },
                {
                    "description": "md-raid10: fix KASAN warning",
                    "commit": "d17f744e883b2f8d13cca252d71cfe8ace346f7d",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0",
                    "version": "6.0",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "1da177e4c3f4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v2.6/ChangeLog-2.6.12",
                            "fixed_commit_version": "2.6.12",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}