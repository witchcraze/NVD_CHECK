{
    "CVE-ID": "CVE-2022-43945",
    "NVD": {
        "Descriptions": "The Linux kernel NFSD implementation prior to versions 5.19.17 and 6.0.2 are vulnerable to buffer overflow. NFSD tracks the number of pages held by each NFSD thread by combining the receive and send buffers of a remote procedure call (RPC) into a single array of pages. A client can force the send buffer to shrink by sending an RPC message over TCP with garbage data added at the end of the message. The RPC message with garbage data is still correctly formed according to the specification and is passed forward to handlers. Vulnerable code in NFSD is not expecting the oversized request and writes beyond the allocated buffer space. CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 7.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "5.19.17",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.0",
                "VersionEndExcluding": "6.0.2",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.15.75": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.75"
            ]
        },
        "5.19.17": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19.17"
            ]
        },
        "6.0.3": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0.3"
            ]
        },
        "6.1": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1"
            ]
        },
        "commit": {
            "NFSD: Protect against send buffer overflow in NFSv2 READDIR": [
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv2 READDIR",
                    "commit": "dc7f225090c29a5f3b9419b1af32846a201555e7",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.75",
                    "version": "5.15.75",
                    "upstream_commit": "00b4492686e0497fdb924a9d4c8f6f99377e176c",
                    "fixed": [
                        {
                            "fixed_commit": "53b1119a6e50",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16",
                            "fixed_commit_version": "5.16",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "eabc0aab98e5",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.12",
                            "fixed_commit_version": "5.15.12",
                            "fixed_commit_upstream_commit": "53b1119a6e5028b125f431a0116ba73510d82a72"
                        }
                    ]
                },
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv2 READDIR",
                    "commit": "c2a878095b5c6f04f90553a3c45872f990dab14e",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19.17",
                    "version": "5.19.17",
                    "upstream_commit": "00b4492686e0497fdb924a9d4c8f6f99377e176c",
                    "fixed": [
                        {
                            "fixed_commit": "53b1119a6e50",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16",
                            "fixed_commit_version": "5.16",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "eabc0aab98e5",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.12",
                            "fixed_commit_version": "5.15.12",
                            "fixed_commit_upstream_commit": "53b1119a6e5028b125f431a0116ba73510d82a72"
                        }
                    ]
                },
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv2 READDIR",
                    "commit": "f59c74df82f6ac9d2ea4e01aa3ae7c6c4481652d",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0.3",
                    "version": "6.0.3",
                    "upstream_commit": "00b4492686e0497fdb924a9d4c8f6f99377e176c",
                    "fixed": [
                        {
                            "fixed_commit": "53b1119a6e50",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16",
                            "fixed_commit_version": "5.16",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "eabc0aab98e5",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.12",
                            "fixed_commit_version": "5.15.12",
                            "fixed_commit_upstream_commit": "53b1119a6e5028b125f431a0116ba73510d82a72"
                        }
                    ]
                },
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv2 READDIR",
                    "commit": "00b4492686e0497fdb924a9d4c8f6f99377e176c",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1",
                    "version": "6.1",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "53b1119a6e50",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16",
                            "fixed_commit_version": "5.16",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "eabc0aab98e5",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.12",
                            "fixed_commit_version": "5.15.12",
                            "fixed_commit_upstream_commit": "53b1119a6e5028b125f431a0116ba73510d82a72"
                        }
                    ]
                }
            ],
            "SUNRPC: Fix svcxdr_init_encode's buflen calculation": [
                {
                    "description": "SUNRPC: Fix svcxdr_init_encode's buflen calculation",
                    "commit": "cedaf73c8bdaa666cd125257861155f273464a6f",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.75",
                    "version": "5.15.75",
                    "upstream_commit": "1242a87da0d8cd2a428e96ca68e7ea899b0f4624",
                    "fixed": [
                        {
                            "fixed_commit": "bddfdbcddbe2",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.13",
                            "fixed_commit_version": "5.13",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "SUNRPC: Fix svcxdr_init_encode's buflen calculation",
                    "commit": "692b69ddb786a10dd4252d4eb121be8e1946b72a",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19.17",
                    "version": "5.19.17",
                    "upstream_commit": "1242a87da0d8cd2a428e96ca68e7ea899b0f4624",
                    "fixed": [
                        {
                            "fixed_commit": "bddfdbcddbe2",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.13",
                            "fixed_commit_version": "5.13",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "SUNRPC: Fix svcxdr_init_encode's buflen calculation",
                    "commit": "47e035f42ec6c1ec1f20705eed8b3d99092510aa",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0.3",
                    "version": "6.0.3",
                    "upstream_commit": "1242a87da0d8cd2a428e96ca68e7ea899b0f4624",
                    "fixed": [
                        {
                            "fixed_commit": "bddfdbcddbe2",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.13",
                            "fixed_commit_version": "5.13",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "SUNRPC: Fix svcxdr_init_encode's buflen calculation",
                    "commit": "1242a87da0d8cd2a428e96ca68e7ea899b0f4624",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1",
                    "version": "6.1",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "bddfdbcddbe2",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.13",
                            "fixed_commit_version": "5.13",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ],
            "SUNRPC: Fix svcxdr_init_decode's end-of-buffer calculation": [
                {
                    "description": "SUNRPC: Fix svcxdr_init_decode's end-of-buffer calculation",
                    "commit": "6b55707ff8b296243a9cf6636d6d8459b6a4a7f8",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.75",
                    "version": "5.15.75",
                    "upstream_commit": "90bfc37b5ab91c1a6165e3e5cfc49bf04571b762",
                    "fixed": [
                        {
                            "fixed_commit": "5191955d6fc6",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "SUNRPC: Fix svcxdr_init_decode's end-of-buffer calculation",
                    "commit": "2eea66b010f72da266496d0a209a80fb8048797d",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19.17",
                    "version": "5.19.17",
                    "upstream_commit": "90bfc37b5ab91c1a6165e3e5cfc49bf04571b762",
                    "fixed": [
                        {
                            "fixed_commit": "5191955d6fc6",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "SUNRPC: Fix svcxdr_init_decode's end-of-buffer calculation",
                    "commit": "352cc3597b1672ec5a1de6557c2f1055f46eb5b5",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0.3",
                    "version": "6.0.3",
                    "upstream_commit": "90bfc37b5ab91c1a6165e3e5cfc49bf04571b762",
                    "fixed": [
                        {
                            "fixed_commit": "5191955d6fc6",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "SUNRPC: Fix svcxdr_init_decode's end-of-buffer calculation",
                    "commit": "90bfc37b5ab91c1a6165e3e5cfc49bf04571b762",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1",
                    "version": "6.1",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "5191955d6fc6",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.11",
                            "fixed_commit_version": "5.11",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ],
            "NFSD: Protect against send buffer overflow in NFSv3 READ": [
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv3 READ",
                    "commit": "75d9de25a6f833dd0701ca546ac926cabff2b5af",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.75",
                    "version": "5.15.75",
                    "upstream_commit": "fa6be9cc6e80ec79892ddf08a8c10cabab9baf38",
                    "fixed": []
                },
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv3 READ",
                    "commit": "bc6c0ed253cd4763dba7541d558e4b704f33176f",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19.17",
                    "version": "5.19.17",
                    "upstream_commit": "fa6be9cc6e80ec79892ddf08a8c10cabab9baf38",
                    "fixed": []
                },
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv3 READ",
                    "commit": "309f29361b6bfae96936317376f1114568c5de19",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0.3",
                    "version": "6.0.3",
                    "upstream_commit": "fa6be9cc6e80ec79892ddf08a8c10cabab9baf38",
                    "fixed": []
                },
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv3 READ",
                    "commit": "fa6be9cc6e80ec79892ddf08a8c10cabab9baf38",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1",
                    "version": "6.1",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "5650682e16f4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.12",
                            "fixed_commit_version": "5.12",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ],
            "NFSD: Protect against send buffer overflow in NFSv2 READ": [
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv2 READ",
                    "commit": "2be9331ca6061bc6ea32247266f45b8b21030244",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.75",
                    "version": "5.15.75",
                    "upstream_commit": "401bc1f90874280a80b93f23be33a0e7e2d1f912",
                    "fixed": []
                },
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv2 READ",
                    "commit": "ea4c3eee0fd72fcedaa238556044825639cd3607",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19.17",
                    "version": "5.19.17",
                    "upstream_commit": "401bc1f90874280a80b93f23be33a0e7e2d1f912",
                    "fixed": []
                },
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv2 READ",
                    "commit": "1868332032eccbab8c1878a0d918193058c0a905",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0.3",
                    "version": "6.0.3",
                    "upstream_commit": "401bc1f90874280a80b93f23be33a0e7e2d1f912",
                    "fixed": []
                },
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv2 READ",
                    "commit": "401bc1f90874280a80b93f23be33a0e7e2d1f912",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1",
                    "version": "6.1",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "5650682e16f4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.12",
                            "fixed_commit_version": "5.12",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ],
            "NFSD: Protect against send buffer overflow in NFSv3 READDIR": [
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv3 READDIR",
                    "commit": "071a076fd1b763aa6fe478efa047e0a549ba9c22",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.75",
                    "version": "5.15.75",
                    "upstream_commit": "640f87c190e0d1b2a0fcb2ecf6d2cd53b1c41991",
                    "fixed": []
                },
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv3 READDIR",
                    "commit": "9c3224826ec17f14e8bdfc86cb7e82fe52d744a7",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19.17",
                    "version": "5.19.17",
                    "upstream_commit": "640f87c190e0d1b2a0fcb2ecf6d2cd53b1c41991",
                    "fixed": []
                },
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv3 READDIR",
                    "commit": "279274e31270c28b86feffe5e166d4088f22317b",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0.3",
                    "version": "6.0.3",
                    "upstream_commit": "640f87c190e0d1b2a0fcb2ecf6d2cd53b1c41991",
                    "fixed": []
                },
                {
                    "description": "NFSD: Protect against send buffer overflow in NFSv3 READDIR",
                    "commit": "640f87c190e0d1b2a0fcb2ecf6d2cd53b1c41991",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1",
                    "version": "6.1",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "5650682e16f4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.12",
                            "fixed_commit_version": "5.12",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ],
            "Merge tag 'nfsd-6.1' of git://git.kernel.org/pub/scm/linux/kernel/git/cel/linux": [
                {
                    "description": "Merge tag 'nfsd-6.1' of git://git.kernel.org/pub/scm/linux/kernel/git/cel/linux",
                    "commit": "f90497a16e434c2211c66e3de8e77b17868382b8",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1",
                    "version": "6.1",
                    "upstream_commit": "",
                    "fixed": []
                }
            ],
            "NFSD: Cap rsize_bop result based on send buffer size": [
                {
                    "description": "NFSD: Cap rsize_bop result based on send buffer size",
                    "commit": "76ce4dcec0dc08a032db916841ddc4e3998be317",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1",
                    "version": "6.1",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "1da177e4c3f4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v2.6/ChangeLog-2.6.12",
                            "fixed_commit_version": "2.6.12",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}