{
    "CVE-ID": "CVE-2025-39744",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nrcu: Fix rcu_read_unlock() deadloop due to IRQ work\n\nDuring rcu_read_unlock_special(), if this happens during irq_exit(), we\ncan lockup if an IPI is issued. This is because the IPI itself triggers\nthe irq_exit() path causing a recursive lock up.\n\nThis is precisely what Xiongfeng found when invoking a BPF program on\nthe trace_tick_stop() tracepoint As shown in the trace below. Fix by\nmanaging the irq_work state correctly.\n\nirq_exit()\n  __irq_exit_rcu()\n    /* in_hardirq() returns false after this */\n    preempt_count_sub(HARDIRQ_OFFSET)\n    tick_irq_exit()\n      tick_nohz_irq_exit()\n\t    tick_nohz_stop_sched_tick()\n\t      trace_tick_stop()  /* a bpf prog is hooked on this trace point */\n\t\t   __bpf_trace_tick_stop()\n\t\t      bpf_trace_run2()\n\t\t\t    rcu_read_unlock_special()\n                              /* will send a IPI to itself */\n\t\t\t      irq_work_queue_on(&rdp->defer_qs_iw, rdp->cpu);\n\nA simple reproducer can also be obtained by doing the following in\ntick_irq_exit(). It will hang on boot without the patch:\n\n  static inline void tick_irq_exit(void)\n  {\n +\trcu_read_lock();\n +\tWRITE_ONCE(current->rcu_read_unlock_special.b.need_qs, true);\n +\trcu_read_unlock();\n +\n\n[neeraj: Apply Frederic's suggested fix for PREEMPT_RT]",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 7.1,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "6.6.103",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.13",
                "VersionEndExcluding": "6.15.11",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.16",
                "VersionEndExcluding": "6.16.2",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.7",
                "VersionEndExcluding": "6.12.43",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "6.12.43": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.43"
            ]
        },
        "6.15.11": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.15.11"
            ]
        },
        "6.16.2": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.16.2"
            ]
        },
        "6.17": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.17"
            ]
        },
        "6.6.103": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.103"
            ]
        },
        "commit": {
            "rcu: Fix rcu_read_unlock() deadloop due to IRQ work": [
                {
                    "description": "rcu: Fix rcu_read_unlock() deadloop due to IRQ work",
                    "commit": "1cfa244f7198d325594e627574930b7b91df5bfe",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.43",
                    "version": "6.12.43",
                    "upstream_commit": "b41642c87716bbd09797b1e4ea7d904f06c39b7b",
                    "fixed": []
                },
                {
                    "description": "rcu: Fix rcu_read_unlock() deadloop due to IRQ work",
                    "commit": "ddebb2a7677673cf4438a04e1a48b8ed6b0c8e9a",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.15.11",
                    "version": "6.15.11",
                    "upstream_commit": "b41642c87716bbd09797b1e4ea7d904f06c39b7b",
                    "fixed": []
                },
                {
                    "description": "rcu: Fix rcu_read_unlock() deadloop due to IRQ work",
                    "commit": "56c5ef194f4509df63fc0f7a91ea5973ce479b1e",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.16.2",
                    "version": "6.16.2",
                    "upstream_commit": "b41642c87716bbd09797b1e4ea7d904f06c39b7b",
                    "fixed": []
                },
                {
                    "description": "rcu: Fix rcu_read_unlock() deadloop due to IRQ work",
                    "commit": "b41642c87716bbd09797b1e4ea7d904f06c39b7b",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.17",
                    "version": "6.17",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "1da177e4c3f4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v2.6/ChangeLog-2.6.12",
                            "fixed_commit_version": "2.6.12",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "rcu: Fix rcu_read_unlock() deadloop due to IRQ work",
                    "commit": "e7a375453cca2b8a0d2fa1b82b913f3fed7c0507",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.103",
                    "version": "6.6.103",
                    "upstream_commit": "b41642c87716bbd09797b1e4ea7d904f06c39b7b",
                    "fixed": []
                }
            ]
        }
    }
}