{
    "CVE-ID": "CVE-2022-49364",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: fix to clear dirty inode in f2fs_evict_inode()\n\nAs Yanming reported in bugzilla:\n\nhttps://bugzilla.kernel.org/show_bug.cgi?id=215904\n\nThe kernel message is shown below:\n\nkernel BUG at fs/f2fs/inode.c:825!\nCall Trace:\n evict+0x282/0x4e0\n __dentry_kill+0x2b2/0x4d0\n shrink_dentry_list+0x17c/0x4f0\n shrink_dcache_parent+0x143/0x1e0\n do_one_tree+0x9/0x30\n shrink_dcache_for_umount+0x51/0x120\n generic_shutdown_super+0x5c/0x3a0\n kill_block_super+0x90/0xd0\n kill_f2fs_super+0x225/0x310\n deactivate_locked_super+0x78/0xc0\n cleanup_mnt+0x2b7/0x480\n task_work_run+0xc8/0x150\n exit_to_user_mode_prepare+0x14a/0x150\n syscall_exit_to_user_mode+0x1d/0x40\n do_syscall_64+0x48/0x90\n\nThe root cause is: inode node and dnode node share the same nid,\nso during f2fs_evict_inode(), dnode node truncation will invalidate\nits NAT entry, so when truncating inode node, it fails due to\ninvalid NAT entry, result in inode is still marked as dirty, fix\nthis issue by clearing dirty for inode and setting SBI_NEED_FSCK\nflag in filesystem.\n\noutput from dump.f2fs:\n[print_node_info: 354] Node ID [0xf:15] is inode\ni_nid[0]                      \t\t[0x       f : 15]",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "3.8",
                "VersionEndExcluding": "5.4.198",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.46",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "5.17.14",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.18",
                "VersionEndExcluding": "5.18.3",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.5",
                "VersionEndExcluding": "5.10.121",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.10.121": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.121"
            ]
        },
        "5.15.46": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.46"
            ]
        },
        "5.17.14": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17.14"
            ]
        },
        "5.18.3": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.18.3"
            ]
        },
        "5.19": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19"
            ]
        },
        "5.4.198": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.198"
            ]
        },
        "commit": {
            "f2fs: fix to clear dirty inode in f2fs_evict_inode()": [
                {
                    "description": "f2fs: fix to clear dirty inode in f2fs_evict_inode()",
                    "commit": "ccd58045beb997544b94558a9156be4742628491",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.121",
                    "version": "5.10.121",
                    "upstream_commit": "f2db71053dc0409fae785096ad19cce4c8a95af7",
                    "fixed": []
                },
                {
                    "description": "f2fs: fix to clear dirty inode in f2fs_evict_inode()",
                    "commit": "c9196d21359be8c7ee231029d13682273925fd00",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.46",
                    "version": "5.15.46",
                    "upstream_commit": "f2db71053dc0409fae785096ad19cce4c8a95af7",
                    "fixed": []
                },
                {
                    "description": "f2fs: fix to clear dirty inode in f2fs_evict_inode()",
                    "commit": "03c9373b15fa1c245ec99b2b5e7ba209eae4ef42",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17.14",
                    "version": "5.17.14",
                    "upstream_commit": "f2db71053dc0409fae785096ad19cce4c8a95af7",
                    "fixed": []
                },
                {
                    "description": "f2fs: fix to clear dirty inode in f2fs_evict_inode()",
                    "commit": "c469953917b319d415fd621b9e5d0ea5203565cd",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.18.3",
                    "version": "5.18.3",
                    "upstream_commit": "f2db71053dc0409fae785096ad19cce4c8a95af7",
                    "fixed": []
                },
                {
                    "description": "f2fs: fix to clear dirty inode in f2fs_evict_inode()",
                    "commit": "f2db71053dc0409fae785096ad19cce4c8a95af7",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.19",
                    "version": "5.19",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "1da177e4c3f4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v2.6/ChangeLog-2.6.12",
                            "fixed_commit_version": "2.6.12",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "f2fs: fix to clear dirty inode in f2fs_evict_inode()",
                    "commit": "54c116615c99e22aa08aa950757ed726e2f60821",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.198",
                    "version": "5.4.198",
                    "upstream_commit": "f2db71053dc0409fae785096ad19cce4c8a95af7",
                    "fixed": []
                }
            ]
        }
    }
}