{
    "CVE-ID": "CVE-2023-46813",
    "NVD": {
        "Descriptions": "An issue was discovered in the Linux kernel before 6.5.9, exploitable by local users with userspace access to MMIO registers. Incorrect access checking in the #VC handler and instruction emulation of the SEV-ES emulation of MMIO accesses could lead to arbitrary write access to kernel memory (and thus privilege escalation). This depends on a race condition through which userspace can replace an instruction before the #VC handler reads it.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 7,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "6.5.9",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.10.199": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.199"
            ]
        },
        "5.15.137": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.137"
            ]
        },
        "6.1.60": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.60"
            ]
        },
        "6.5.9": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.5.9"
            ]
        },
        "6.6": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6"
            ]
        },
        "commit": {
            "x86/sev: Check for user-space IOIO pointing to kernel space": [
                {
                    "description": "x86/sev: Check for user-space IOIO pointing to kernel space",
                    "commit": "6550cbe25de182f6c0176909a90b324cb375133f",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.199",
                    "version": "5.10.199",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "597cfe48212a",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "x86/sev: Check for user-space IOIO pointing to kernel space",
                    "commit": "582f7993353c7b116651f88385b1785dffa14c5d",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.137",
                    "version": "5.15.137",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "597cfe48212a",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "x86/sev: Check for user-space IOIO pointing to kernel space",
                    "commit": "57d0639f60f1ff04cbe7fd52823b94b894d7f812",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.60",
                    "version": "6.1.60",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "597cfe48212a",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "x86/sev: Check for user-space IOIO pointing to kernel space",
                    "commit": "11b975cb82cc6d88e8b04f77a673077ac5c30c8b",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.5.9",
                    "version": "6.5.9",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "597cfe48212a",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "x86/sev: Check for user-space IOIO pointing to kernel space",
                    "commit": "63e44bc52047f182601e7817da969a105aa1f721",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6",
                    "version": "6.6",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "597cfe48212a",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ],
            "x86/sev: Check IOBM for IOIO exceptions from user-space": [
                {
                    "description": "x86/sev: Check IOBM for IOIO exceptions from user-space",
                    "commit": "5bb9ba7dafbe18e027e335f74372ca65f07f7edd",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.199",
                    "version": "5.10.199",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "25189d08e516",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "x86/sev: Check IOBM for IOIO exceptions from user-space",
                    "commit": "5c2c01be809db49ad744158e4c6284213da6513a",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.137",
                    "version": "5.15.137",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "25189d08e516",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "x86/sev: Check IOBM for IOIO exceptions from user-space",
                    "commit": "def94eb9a804acdcdba5b959ad72cf9119f03f3b",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.60",
                    "version": "6.1.60",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "25189d08e516",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "x86/sev: Check IOBM for IOIO exceptions from user-space",
                    "commit": "dcb55b683118e411da93dbaea86e73a06bb21870",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.5.9",
                    "version": "6.5.9",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "25189d08e516",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "x86/sev: Check IOBM for IOIO exceptions from user-space",
                    "commit": "b9cb9c45583b911e0db71d09caa6b56469eb2bdf",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6",
                    "version": "6.6",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "25189d08e516",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ],
            "x86/sev: Disable MMIO emulation from user mode": [
                {
                    "description": "x86/sev: Disable MMIO emulation from user mode",
                    "commit": "d78c5d8c23c3f0e24168ea98760016665bf92a79",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.199",
                    "version": "5.10.199",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "0118b604c2c9",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "x86/sev: Disable MMIO emulation from user mode",
                    "commit": "6797c6d09e50e7ddb1c0f8282ccfb3f1c4d63270",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.137",
                    "version": "5.15.137",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "0118b604c2c9",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "x86/sev: Disable MMIO emulation from user mode",
                    "commit": "95ff590b802757f8b6bd32e7e5b21ef9b91e2583",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.60",
                    "version": "6.1.60",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "0118b604c2c9",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "x86/sev: Disable MMIO emulation from user mode",
                    "commit": "f44a58134e6a532c73796cabedea68939cf7792f",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.5.9",
                    "version": "6.5.9",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "0118b604c2c9",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "x86/sev: Disable MMIO emulation from user mode",
                    "commit": "a37cd2a59d0cb270b1bba568fd3a3b8668b9d3ba",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6",
                    "version": "6.6",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "0118b604c2c9",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}