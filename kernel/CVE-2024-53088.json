{
    "CVE-ID": "CVE-2024-53088",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\ni40e: fix race condition by adding filter's intermediate sync state\n\nFix a race condition in the i40e driver that leads to MAC/VLAN filters\nbecoming corrupted and leaking. Address the issue that occurs under\nheavy load when multiple threads are concurrently modifying MAC/VLAN\nfilters by setting mac and port VLAN.\n\n1. Thread T0 allocates a filter in i40e_add_filter() within\n        i40e_ndo_set_vf_port_vlan().\n2. Thread T1 concurrently frees the filter in __i40e_del_filter() within\n        i40e_ndo_set_vf_mac().\n3. Subsequently, i40e_service_task() calls i40e_sync_vsi_filters(), which\n        refers to the already freed filter memory, causing corruption.\n\nReproduction steps:\n1. Spawn multiple VFs.\n2. Apply a concurrent heavy load by running parallel operations to change\n        MAC addresses on the VFs and change port VLANs on the host.\n3. Observe errors in dmesg:\n\"Error I40E_AQ_RC_ENOSPC adding RX filters on VF XX,\n\tplease set promiscuous on manually for VF XX\".\n\nExact code for stable reproduction Intel can't open-source now.\n\nThe fix involves implementing a new intermediate filter state,\nI40E_FILTER_NEW_SYNC, for the time when a filter is on a tmp_add_list.\nThese filters cannot be deleted from the hash list directly but\nmust be removed using the full process.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 4.7,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc6",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc6:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc5",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc5:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc4",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc4:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc3",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.10",
                "VersionEndExcluding": "5.15.172",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.1.117",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.6.61",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.7",
                "VersionEndExcluding": "6.11.8",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.15.172": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.172"
            ]
        },
        "6.1.117": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.117"
            ]
        },
        "6.11.8": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.11.8"
            ]
        },
        "6.12": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12"
            ]
        },
        "6.6.61": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.61"
            ]
        },
        "commit": {
            "i40e: fix race condition by adding filter's intermediate sync state": [
                {
                    "description": "i40e: fix race condition by adding filter's intermediate sync state",
                    "commit": "262dc6ea5f1eb18c4d08ad83d51222d0dd0dd42a",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.172",
                    "version": "5.15.172",
                    "upstream_commit": "f30490e9695ef7da3d0899c6a0293cc7cd373567",
                    "fixed": [
                        {
                            "fixed_commit": "278e7d0b9d68",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/278e7d0b9d68",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "i40e: fix race condition by adding filter's intermediate sync state",
                    "commit": "7ad3fb3bfd43feb4e15c81dffd23ac4e55742791",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.117",
                    "version": "6.1.117",
                    "upstream_commit": "f30490e9695ef7da3d0899c6a0293cc7cd373567",
                    "fixed": [
                        {
                            "fixed_commit": "278e7d0b9d68",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/278e7d0b9d68",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "i40e: fix race condition by adding filter's intermediate sync state",
                    "commit": "6e046f4937474bc1b9fa980c1ad8f3253fc638f6",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.11.8",
                    "version": "6.11.8",
                    "upstream_commit": "f30490e9695ef7da3d0899c6a0293cc7cd373567",
                    "fixed": [
                        {
                            "fixed_commit": "278e7d0b9d68",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/278e7d0b9d68",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "i40e: fix race condition by adding filter's intermediate sync state",
                    "commit": "f30490e9695ef7da3d0899c6a0293cc7cd373567",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12",
                    "version": "6.12",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "278e7d0b9d68",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/278e7d0b9d68",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "i40e: fix race condition by adding filter's intermediate sync state",
                    "commit": "bf5f837d9fd27d32fb76df0a108babcaf4446ff1",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.61",
                    "version": "6.6.61",
                    "upstream_commit": "f30490e9695ef7da3d0899c6a0293cc7cd373567",
                    "fixed": [
                        {
                            "fixed_commit": "278e7d0b9d68",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/278e7d0b9d68",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}