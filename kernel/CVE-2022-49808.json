{
    "CVE-ID": "CVE-2022-49808",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: dsa: don't leak tagger-owned storage on switch driver unbind\n\nIn the initial commit dc452a471dba (\"net: dsa: introduce tagger-owned\nstorage for private and shared data\"), we had a call to\ntag_ops->disconnect(dst) issued from dsa_tree_free(), which is called at\ntree teardown time.\n\nThere were problems with connecting to a switch tree as a whole, so this\ngot reworked to connecting to individual switches within the tree. In\nthis process, tag_ops->disconnect(ds) was made to be called only from\nswitch.c (cross-chip notifiers emitted as a result of dynamic tag proto\nchanges), but the normal driver teardown code path wasn't replaced with\nanything.\n\nSolve this problem by adding a function that does the opposite of\ndsa_switch_setup_tag_protocol(), which is called from the equivalent\nspot in dsa_switch_teardown(). The positioning here also ensures that we\nwon't have any use-after-free in tagging protocol (*rcv) ops, since the\nteardown sequence is as follows:\n\ndsa_tree_teardown\n-> dsa_tree_teardown_master\n   -> dsa_master_teardown\n      -> unsets master->dsa_ptr, making no further packets match the\n         ETH_P_XDSA packet type handler\n-> dsa_tree_teardown_ports\n   -> dsa_port_teardown\n      -> dsa_slave_destroy\n         -> unregisters DSA net devices, there is even a synchronize_net()\n            in unregister_netdevice_many()\n-> dsa_tree_teardown_switches\n   -> dsa_switch_teardown\n      -> dsa_switch_teardown_tag_protocol\n         -> finally frees the tagger-owned storage",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.1:rc5",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.1:rc5:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.1:rc4",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.1:rc4:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.1:rc3",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.1:rc3:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.1:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.1:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.1:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.1:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.17",
                "VersionEndExcluding": "6.0.10",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "6.0.10": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0.10"
            ]
        },
        "6.1": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1"
            ]
        },
        "commit": {
            "net: dsa: don't leak tagger-owned storage on switch driver unbind": [
                {
                    "description": "net: dsa: don't leak tagger-owned storage on switch driver unbind",
                    "commit": "5809fb03942dbac25144db5bebea84fa003ecaca",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.0.10",
                    "version": "6.0.10",
                    "upstream_commit": "4e0c19fcb8b5323716140fa82b79aa9f60e60407",
                    "fixed": [
                        {
                            "fixed_commit": "7f2973149c22",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17",
                            "fixed_commit_version": "5.17",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "net: dsa: don't leak tagger-owned storage on switch driver unbind",
                    "commit": "4e0c19fcb8b5323716140fa82b79aa9f60e60407",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1",
                    "version": "6.1",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "7f2973149c22",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17",
                            "fixed_commit_version": "5.17",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}