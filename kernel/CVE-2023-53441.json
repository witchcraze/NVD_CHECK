{
    "CVE-ID": "CVE-2023-53441",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: cpumap: Fix memory leak in cpu_map_update_elem\n\nSyzkaller reported a memory leak as follows:\n\nBUG: memory leak\nunreferenced object 0xff110001198ef748 (size 192):\n  comm \"syz-executor.3\", pid 17672, jiffies 4298118891 (age 9.906s)\n  hex dump (first 32 bytes):\n    00 00 00 00 4a 19 00 00 80 ad e3 e4 fe ff c0 00  ....J...........\n    00 b2 d3 0c 01 00 11 ff 28 f5 8e 19 01 00 11 ff  ........(.......\n  backtrace:\n    [<ffffffffadd28087>] __cpu_map_entry_alloc+0xf7/0xb00\n    [<ffffffffadd28d8e>] cpu_map_update_elem+0x2fe/0x3d0\n    [<ffffffffadc6d0fd>] bpf_map_update_value.isra.0+0x2bd/0x520\n    [<ffffffffadc7349b>] map_update_elem+0x4cb/0x720\n    [<ffffffffadc7d983>] __se_sys_bpf+0x8c3/0xb90\n    [<ffffffffb029cc80>] do_syscall_64+0x30/0x40\n    [<ffffffffb0400099>] entry_SYSCALL_64_after_hwframe+0x61/0xc6\n\nBUG: memory leak\nunreferenced object 0xff110001198ef528 (size 192):\n  comm \"syz-executor.3\", pid 17672, jiffies 4298118891 (age 9.906s)\n  hex dump (first 32 bytes):\n    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n  backtrace:\n    [<ffffffffadd281f0>] __cpu_map_entry_alloc+0x260/0xb00\n    [<ffffffffadd28d8e>] cpu_map_update_elem+0x2fe/0x3d0\n    [<ffffffffadc6d0fd>] bpf_map_update_value.isra.0+0x2bd/0x520\n    [<ffffffffadc7349b>] map_update_elem+0x4cb/0x720\n    [<ffffffffadc7d983>] __se_sys_bpf+0x8c3/0xb90\n    [<ffffffffb029cc80>] do_syscall_64+0x30/0x40\n    [<ffffffffb0400099>] entry_SYSCALL_64_after_hwframe+0x61/0xc6\n\nBUG: memory leak\nunreferenced object 0xff1100010fd93d68 (size 8):\n  comm \"syz-executor.3\", pid 17672, jiffies 4298118891 (age 9.906s)\n  hex dump (first 8 bytes):\n    00 00 00 00 00 00 00 00                          ........\n  backtrace:\n    [<ffffffffade5db3e>] kvmalloc_node+0x11e/0x170\n    [<ffffffffadd28280>] __cpu_map_entry_alloc+0x2f0/0xb00\n    [<ffffffffadd28d8e>] cpu_map_update_elem+0x2fe/0x3d0\n    [<ffffffffadc6d0fd>] bpf_map_update_value.isra.0+0x2bd/0x520\n    [<ffffffffadc7349b>] map_update_elem+0x4cb/0x720\n    [<ffffffffadc7d983>] __se_sys_bpf+0x8c3/0xb90\n    [<ffffffffb029cc80>] do_syscall_64+0x30/0x40\n    [<ffffffffb0400099>] entry_SYSCALL_64_after_hwframe+0x61/0xc6\n\nIn the cpu_map_update_elem flow, when kthread_stop is called before\ncalling the threadfn of rcpu->kthread, since the KTHREAD_SHOULD_STOP bit\nof kthread has been set by kthread_stop, the threadfn of rcpu->kthread\nwill never be executed, and rcpu->refcnt will never be 0, which will\nlead to the allocated rcpu, rcpu->queue and rcpu->queue->queue cannot be\nreleased.\n\nCalling kthread_stop before executing kthread's threadfn will return\n-EINTR. We can complete the release of memory resources in this state.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.5:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.5:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.15",
                "VersionEndExcluding": "5.15.121",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.1.40",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.4.5",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.15.121": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.121"
            ]
        },
        "6.1.40": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.40"
            ]
        },
        "6.4.5": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.4.5"
            ]
        },
        "6.5": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.5"
            ]
        },
        "commit": {
            "bpf: cpumap: Fix memory leak in cpu_map_update_elem": [
                {
                    "description": "bpf: cpumap: Fix memory leak in cpu_map_update_elem",
                    "commit": "d26299f50f5ea8f0aeb5d49e659c31f64233c816",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.121",
                    "version": "5.15.121",
                    "upstream_commit": "4369016497319a9635702da010d02af1ebb1849d",
                    "fixed": [
                        {
                            "fixed_commit": "6710e1126934",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/6710e1126934",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "bpf: cpumap: Fix memory leak in cpu_map_update_elem",
                    "commit": "b11a9b4f28cb6ff69ef7e69809e5f7fffeac9030",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.40",
                    "version": "6.1.40",
                    "upstream_commit": "4369016497319a9635702da010d02af1ebb1849d",
                    "fixed": [
                        {
                            "fixed_commit": "6710e1126934",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/6710e1126934",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "bpf: cpumap: Fix memory leak in cpu_map_update_elem",
                    "commit": "a957ac8e0b5ffb5797382a6adbafd005a5f72851",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.4.5",
                    "version": "6.4.5",
                    "upstream_commit": "4369016497319a9635702da010d02af1ebb1849d",
                    "fixed": [
                        {
                            "fixed_commit": "6710e1126934",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/6710e1126934",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "bpf: cpumap: Fix memory leak in cpu_map_update_elem",
                    "commit": "4369016497319a9635702da010d02af1ebb1849d",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.5",
                    "version": "6.5",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "6710e1126934",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/6710e1126934",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}