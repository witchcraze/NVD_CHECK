{
    "CVE-ID": "CVE-2022-0500",
    "NVD": {
        "Descriptions": "A flaw was found in unrestricted eBPF usage by the BPF_BTF_LOAD, leading to a possible out-of-bounds memory write in the Linux kernel\u2019s BPF subsystem due to the way a user loads BTF. This flaw allows a local user to crash or escalate their privileges on the system.",
        "Cvss2_BaseScore": 7.2,
        "Cvss3_BaseScore": 7.8,
        "Cvss2_VectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:netapp:h700s_firmware:-",
                "FormattedString": "cpe:2.3:o:netapp:h700s_firmware:-:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:netapp:h700e_firmware:-",
                "FormattedString": "cpe:2.3:o:netapp:h700e_firmware:-:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:netapp:h500s_firmware:-",
                "FormattedString": "cpe:2.3:o:netapp:h500s_firmware:-:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:netapp:h500e_firmware:-",
                "FormattedString": "cpe:2.3:o:netapp:h500e_firmware:-:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:netapp:h410s_firmware:-",
                "FormattedString": "cpe:2.3:o:netapp:h410s_firmware:-:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:netapp:h410c_firmware:-",
                "FormattedString": "cpe:2.3:o:netapp:h410c_firmware:-:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:netapp:h300s_firmware:-",
                "FormattedString": "cpe:2.3:o:netapp:h300s_firmware:-:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:netapp:h300e_firmware:-",
                "FormattedString": "cpe:2.3:o:netapp:h300e_firmware:-:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:5.17:-",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.17:-:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "5.17",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:fedoraproject:fedora:35",
                "FormattedString": "cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:fedoraproject:fedora:34",
                "FormattedString": "cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.15.37": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.37"
            ]
        },
        "5.16.11": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16.11"
            ]
        },
        "5.17": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17"
            ]
        },
        "commit": {
            "bpf: Add MEM_RDONLY for helper args that are pointers to rdonly mem.": [
                {
                    "description": "bpf: Add MEM_RDONLY for helper args that are pointers to rdonly mem.",
                    "commit": "2a77c58726aba893129a369ed3d2be004dda41cd",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.37",
                    "version": "5.15.37",
                    "upstream_commit": "216e3cd2f28dbbf1fe86848e0e29e6693b9f0a20",
                    "fixed": []
                },
                {
                    "description": "bpf: Add MEM_RDONLY for helper args that are pointers to rdonly mem.",
                    "commit": "4a6c35debbd46d796c81eb3ffcd6c747e76ec7a3",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16.11",
                    "version": "5.16.11",
                    "upstream_commit": "216e3cd2f28dbbf1fe86848e0e29e6693b9f0a20",
                    "fixed": []
                },
                {
                    "description": "bpf: Add MEM_RDONLY for helper args that are pointers to rdonly mem.",
                    "commit": "216e3cd2f28dbbf1fe86848e0e29e6693b9f0a20",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17",
                    "version": "5.17",
                    "upstream_commit": "",
                    "fixed": []
                }
            ],
            "bpf: Make per_cpu_ptr return rdonly PTR_TO_MEM.": [
                {
                    "description": "bpf: Make per_cpu_ptr return rdonly PTR_TO_MEM.",
                    "commit": "15166bb3000fc8b5faa8fa606eb25d300e6892ef",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.37",
                    "version": "5.15.37",
                    "upstream_commit": "34d3a78c681e8e7844b43d1a2f4671a04249c821",
                    "fixed": [
                        {
                            "fixed_commit": "63d9b80dcf2c",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "eaa6bcb71ef6",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "4976b718c355",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "bpf: Make per_cpu_ptr return rdonly PTR_TO_MEM.",
                    "commit": "199cdd057eb747b36a193ecf96d2452e36643163",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16.11",
                    "version": "5.16.11",
                    "upstream_commit": "34d3a78c681e8e7844b43d1a2f4671a04249c821",
                    "fixed": [
                        {
                            "fixed_commit": "63d9b80dcf2c",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "eaa6bcb71ef6",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "4976b718c355",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "bpf: Make per_cpu_ptr return rdonly PTR_TO_MEM.",
                    "commit": "34d3a78c681e8e7844b43d1a2f4671a04249c821",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17",
                    "version": "5.17",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "63d9b80dcf2c",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "eaa6bcb71ef6",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "4976b718c355",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10",
                            "fixed_commit_version": "5.10",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ],
            "bpf: Convert PTR_TO_MEM_OR_NULL to composable types.": [
                {
                    "description": "bpf: Convert PTR_TO_MEM_OR_NULL to composable types.",
                    "commit": "b710f73704d61069b2f05358309290551e5a8732",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.37",
                    "version": "5.15.37",
                    "upstream_commit": "cf9f2f8d62eca810afbd1ee6cc0800202b000e57",
                    "fixed": []
                },
                {
                    "description": "bpf: Convert PTR_TO_MEM_OR_NULL to composable types.",
                    "commit": "6f6edc4211b379ef6de25d9182148c7ca26ffcfb",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16.11",
                    "version": "5.16.11",
                    "upstream_commit": "cf9f2f8d62eca810afbd1ee6cc0800202b000e57",
                    "fixed": []
                },
                {
                    "description": "bpf: Convert PTR_TO_MEM_OR_NULL to composable types.",
                    "commit": "cf9f2f8d62eca810afbd1ee6cc0800202b000e57",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17",
                    "version": "5.17",
                    "upstream_commit": "",
                    "fixed": []
                }
            ],
            "bpf: Introduce MEM_RDONLY flag": [
                {
                    "description": "bpf: Introduce MEM_RDONLY flag",
                    "commit": "b453361384c2db1c703dacb806d5fd36aec4ceca",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.37",
                    "version": "5.15.37",
                    "upstream_commit": "20b2aff4bc15bda809f994761d5719827d66c0b4",
                    "fixed": []
                },
                {
                    "description": "bpf: Introduce MEM_RDONLY flag",
                    "commit": "e982070f8970bb62e69ed7c9cafff886ed200349",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16.11",
                    "version": "5.16.11",
                    "upstream_commit": "20b2aff4bc15bda809f994761d5719827d66c0b4",
                    "fixed": []
                },
                {
                    "description": "bpf: Introduce MEM_RDONLY flag",
                    "commit": "20b2aff4bc15bda809f994761d5719827d66c0b4",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17",
                    "version": "5.17",
                    "upstream_commit": "",
                    "fixed": []
                }
            ],
            "bpf: Replace PTR_TO_XXX_OR_NULL with PTR_TO_XXX | PTR_MAYBE_NULL": [
                {
                    "description": "bpf: Replace PTR_TO_XXX_OR_NULL with PTR_TO_XXX | PTR_MAYBE_NULL",
                    "commit": "8d38cde47a7e17b646401fa92d916503caa5375e",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.37",
                    "version": "5.15.37",
                    "upstream_commit": "c25b2ae136039ffa820c26138ed4a5e5f3ab3841",
                    "fixed": []
                },
                {
                    "description": "bpf: Replace PTR_TO_XXX_OR_NULL with PTR_TO_XXX | PTR_MAYBE_NULL",
                    "commit": "77459bc4d5e2c6f24db845780b4d9d60cf82d06a",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16.11",
                    "version": "5.16.11",
                    "upstream_commit": "c25b2ae136039ffa820c26138ed4a5e5f3ab3841",
                    "fixed": []
                },
                {
                    "description": "bpf: Replace PTR_TO_XXX_OR_NULL with PTR_TO_XXX | PTR_MAYBE_NULL",
                    "commit": "c25b2ae136039ffa820c26138ed4a5e5f3ab3841",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17",
                    "version": "5.17",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "457f44363a88",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.8",
                            "fixed_commit_version": "5.8",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ],
            "bpf: Replace RET_XXX_OR_NULL with RET_XXX | PTR_MAYBE_NULL": [
                {
                    "description": "bpf: Replace RET_XXX_OR_NULL with RET_XXX | PTR_MAYBE_NULL",
                    "commit": "3c141c82b95807473d77079936769e04a84e4ca3",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.37",
                    "version": "5.15.37",
                    "upstream_commit": "3c4807322660d4290ac9062c034aed6b87243861",
                    "fixed": []
                },
                {
                    "description": "bpf: Replace RET_XXX_OR_NULL with RET_XXX | PTR_MAYBE_NULL",
                    "commit": "5b33e437dc6a02e3298858ca8591096f36b1421d",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16.11",
                    "version": "5.16.11",
                    "upstream_commit": "3c4807322660d4290ac9062c034aed6b87243861",
                    "fixed": []
                },
                {
                    "description": "bpf: Replace RET_XXX_OR_NULL with RET_XXX | PTR_MAYBE_NULL",
                    "commit": "3c4807322660d4290ac9062c034aed6b87243861",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17",
                    "version": "5.17",
                    "upstream_commit": "",
                    "fixed": []
                }
            ],
            "bpf: Replace ARG_XXX_OR_NULL with ARG_XXX | PTR_MAYBE_NULL": [
                {
                    "description": "bpf: Replace ARG_XXX_OR_NULL with ARG_XXX | PTR_MAYBE_NULL",
                    "commit": "d58a396fa6c98bde64772c1db715dfca32610597",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.37",
                    "version": "5.15.37",
                    "upstream_commit": "48946bd6a5d695c50b34546864b79c1f910a33c1",
                    "fixed": []
                },
                {
                    "description": "bpf: Replace ARG_XXX_OR_NULL with ARG_XXX | PTR_MAYBE_NULL",
                    "commit": "bcd98af3eb7527f6ba39c976cbcf4454fa1106e1",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16.11",
                    "version": "5.16.11",
                    "upstream_commit": "48946bd6a5d695c50b34546864b79c1f910a33c1",
                    "fixed": []
                },
                {
                    "description": "bpf: Replace ARG_XXX_OR_NULL with ARG_XXX | PTR_MAYBE_NULL",
                    "commit": "48946bd6a5d695c50b34546864b79c1f910a33c1",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17",
                    "version": "5.17",
                    "upstream_commit": "",
                    "fixed": []
                }
            ]
        }
    }
}