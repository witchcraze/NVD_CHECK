{
    "CVE-ID": "CVE-2024-35853",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nmlxsw: spectrum_acl_tcam: Fix memory leak during rehash\n\nThe rehash delayed work migrates filters from one region to another.\nThis is done by iterating over all chunks (all the filters with the same\npriority) in the region and in each chunk iterating over all the\nfilters.\n\nIf the migration fails, the code tries to migrate the filters back to\nthe old region. However, the rollback itself can also fail in which case\nanother migration will be erroneously performed. Besides the fact that\nthis ping pong is not a very good idea, it also creates a problem.\n\nEach virtual chunk references two chunks: The currently used one\n('vchunk->chunk') and a backup ('vchunk->chunk2'). During migration the\nfirst holds the chunk we want to migrate filters to and the second holds\nthe chunk we are migrating filters from.\n\nThe code currently assumes - but does not verify - that the backup chunk\ndoes not exist (NULL) if the currently used chunk does not reference the\ntarget region. This assumption breaks when we are trying to rollback a\nrollback, resulting in the backup chunk being overwritten and leaked\n[1].\n\nFix by not rolling back a failed rollback and add a warning to avoid\nfuture cases.\n\n[1]\nWARNING: CPU: 5 PID: 1063 at lib/parman.c:291 parman_destroy+0x17/0x20\nModules linked in:\nCPU: 5 PID: 1063 Comm: kworker/5:11 Tainted: G        W          6.9.0-rc2-custom-00784-gc6a05c468a0b #14\nHardware name: Mellanox Technologies Ltd. MSN3700/VMOD0005, BIOS 5.11 01/06/2019\nWorkqueue: mlxsw_core mlxsw_sp_acl_tcam_vregion_rehash_work\nRIP: 0010:parman_destroy+0x17/0x20\n[...]\nCall Trace:\n <TASK>\n mlxsw_sp_acl_atcam_region_fini+0x19/0x60\n mlxsw_sp_acl_tcam_region_destroy+0x49/0xf0\n mlxsw_sp_acl_tcam_vregion_rehash_work+0x1f1/0x470\n process_one_work+0x151/0x370\n worker_thread+0x2cb/0x3e0\n kthread+0xd0/0x100\n ret_from_fork+0x34/0x50\n ret_from_fork_asm+0x1a/0x30\n </TASK>",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 6.4,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.9:rc5",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.9:rc5:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.9:rc4",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.9:rc4:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.9:rc3",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.9:rc3:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.9:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.9:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.9:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.1",
                "VersionEndExcluding": "5.4.275",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.158",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.1.90",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.5",
                "VersionEndExcluding": "5.10.216",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.6.30",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.7",
                "VersionEndExcluding": "6.8.9",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:debian:debian_linux:10.0",
                "FormattedString": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.10.216": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.216"
            ]
        },
        "5.15.158": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.158"
            ]
        },
        "5.4.275": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.275"
            ]
        },
        "6.1.90": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.90"
            ]
        },
        "6.6.30": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.30"
            ]
        },
        "6.8.9": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.8.9"
            ]
        },
        "6.9": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.9"
            ]
        },
        "commit": {
            "mlxsw: spectrum_acl_tcam: Fix memory leak during rehash": [
                {
                    "description": "mlxsw: spectrum_acl_tcam: Fix memory leak during rehash",
                    "commit": "617e98ba4c50f4547c9eb0946b1cfc26937d70d1",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.216",
                    "version": "5.10.216",
                    "upstream_commit": "8ca3f7a7b61393804c46f170743c3b839df13977",
                    "fixed": [
                        {
                            "fixed_commit": "843500518509",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1",
                            "fixed_commit_version": "5.1",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "mlxsw: spectrum_acl_tcam: Fix memory leak during rehash",
                    "commit": "413a01886c3958d4b8aac23a3bff3d430b92093e",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.158",
                    "version": "5.15.158",
                    "upstream_commit": "8ca3f7a7b61393804c46f170743c3b839df13977",
                    "fixed": [
                        {
                            "fixed_commit": "843500518509",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1",
                            "fixed_commit_version": "5.1",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "mlxsw: spectrum_acl_tcam: Fix memory leak during rehash",
                    "commit": "c6f3fa7f5a748bf6e5c4eb742686d6952f854e76",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.275",
                    "version": "5.4.275",
                    "upstream_commit": "8ca3f7a7b61393804c46f170743c3b839df13977",
                    "fixed": [
                        {
                            "fixed_commit": "843500518509",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1",
                            "fixed_commit_version": "5.1",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "mlxsw: spectrum_acl_tcam: Fix memory leak during rehash",
                    "commit": "b822644fd90992ee362c5e0c8d2556efc8856c76",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.90",
                    "version": "6.1.90",
                    "upstream_commit": "8ca3f7a7b61393804c46f170743c3b839df13977",
                    "fixed": [
                        {
                            "fixed_commit": "843500518509",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1",
                            "fixed_commit_version": "5.1",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "mlxsw: spectrum_acl_tcam: Fix memory leak during rehash",
                    "commit": "0ae8ff7b6d42e33943af462910bdcfa2ec0cb8cf",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.30",
                    "version": "6.6.30",
                    "upstream_commit": "8ca3f7a7b61393804c46f170743c3b839df13977",
                    "fixed": [
                        {
                            "fixed_commit": "843500518509",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1",
                            "fixed_commit_version": "5.1",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "mlxsw: spectrum_acl_tcam: Fix memory leak during rehash",
                    "commit": "b3fd51f684a0711504f82de510da109ae639722d",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.8.9",
                    "version": "6.8.9",
                    "upstream_commit": "8ca3f7a7b61393804c46f170743c3b839df13977",
                    "fixed": [
                        {
                            "fixed_commit": "843500518509",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1",
                            "fixed_commit_version": "5.1",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "mlxsw: spectrum_acl_tcam: Fix memory leak during rehash",
                    "commit": "8ca3f7a7b61393804c46f170743c3b839df13977",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.9",
                    "version": "6.9",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "843500518509",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.1",
                            "fixed_commit_version": "5.1",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}