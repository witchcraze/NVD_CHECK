{
    "CVE-ID": "CVE-2024-50072",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nx86/bugs: Use code segment selector for VERW operand\n\nRobert Gill reported below #GP in 32-bit mode when dosemu software was\nexecuting vm86() system call:\n\n  general protection fault: 0000 [#1] PREEMPT SMP\n  CPU: 4 PID: 4610 Comm: dosemu.bin Not tainted 6.6.21-gentoo-x86 #1\n  Hardware name: Dell Inc. PowerEdge 1950/0H723K, BIOS 2.7.0 10/30/2010\n  EIP: restore_all_switch_stack+0xbe/0xcf\n  EAX: 00000000 EBX: 00000000 ECX: 00000000 EDX: 00000000\n  ESI: 00000000 EDI: 00000000 EBP: 00000000 ESP: ff8affdc\n  DS: 0000 ES: 0000 FS: 0000 GS: 0033 SS: 0068 EFLAGS: 00010046\n  CR0: 80050033 CR2: 00c2101c CR3: 04b6d000 CR4: 000406d0\n  Call Trace:\n   show_regs+0x70/0x78\n   die_addr+0x29/0x70\n   exc_general_protection+0x13c/0x348\n   exc_bounds+0x98/0x98\n   handle_exception+0x14d/0x14d\n   exc_bounds+0x98/0x98\n   restore_all_switch_stack+0xbe/0xcf\n   exc_bounds+0x98/0x98\n   restore_all_switch_stack+0xbe/0xcf\n\nThis only happens in 32-bit mode when VERW based mitigations like MDS/RFDS\nare enabled. This is because segment registers with an arbitrary user value\ncan result in #GP when executing VERW. Intel SDM vol. 2C documents the\nfollowing behavior for VERW instruction:\n\n  #GP(0) - If a memory operand effective address is outside the CS, DS, ES,\n\t   FS, or GS segment limit.\n\nCLEAR_CPU_BUFFERS macro executes VERW instruction before returning to user\nspace. Use %cs selector to reference VERW operand. This ensures VERW will\nnot #GP for an arbitrary user %ds.\n\n[ mingo: Fixed the SOB chain. ]",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc3",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc3:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.12:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.12:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.10.215",
                "VersionEndExcluding": "5.11",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.15.154",
                "VersionEndExcluding": "5.16",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.1.81",
                "VersionEndExcluding": "6.2",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.6.21",
                "VersionEndExcluding": "6.6.58",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.7",
                "VersionEndExcluding": "6.11.5",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.7.9",
                "VersionEndExcluding": "6.8",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "-": {
            "source": [
                "https://github.com/torvalds/linux/commit/e4d2102018542e3ae5e297bc6e229303abff8a0f"
            ]
        },
        "6.11.5": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.11.5"
            ]
        },
        "6.6.58": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.58"
            ]
        },
        "commit": {
            "x86/bugs: Use code segment selector for VERW operand": [
                {
                    "description": "x86/bugs: Use code segment selector for VERW operand",
                    "commit": "e4d2102018542e3ae5e297bc6e229303abff8a0f",
                    "source": "https://github.com/torvalds/linux/commit/e4d2102018542e3ae5e297bc6e229303abff8a0f",
                    "version": "-",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "a0e2dab44d22",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.8",
                            "fixed_commit_version": "6.8",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "50f021f0b985",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.215",
                            "fixed_commit_version": "5.10.215",
                            "fixed_commit_upstream_commit": "a0e2dab44d22b913b4c228c8b52b2a104434b0b3"
                        },
                        {
                            "fixed_commit": "d54de9f2a127",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.154",
                            "fixed_commit_version": "5.15.154",
                            "fixed_commit_upstream_commit": "a0e2dab44d22b913b4c228c8b52b2a104434b0b3"
                        },
                        {
                            "fixed_commit": "2e3087505ddb",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.81",
                            "fixed_commit_version": "6.1.81",
                            "fixed_commit_upstream_commit": "a0e2dab44d22b913b4c228c8b52b2a104434b0b3"
                        },
                        {
                            "fixed_commit": "ca13d8cd8dac",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.21",
                            "fixed_commit_version": "6.6.21",
                            "fixed_commit_upstream_commit": "a0e2dab44d22b913b4c228c8b52b2a104434b0b3"
                        },
                        {
                            "fixed_commit": "51eca9f1fd04",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.7.9",
                            "fixed_commit_version": "6.7.9",
                            "fixed_commit_upstream_commit": "a0e2dab44d22b913b4c228c8b52b2a104434b0b3"
                        }
                    ]
                },
                {
                    "description": "x86/bugs: Use code segment selector for VERW operand",
                    "commit": "bc576fbaf82deded606e69a00efe9752136bf91d",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.11.5",
                    "version": "6.11.5",
                    "upstream_commit": "e4d2102018542e3ae5e297bc6e229303abff8a0f",
                    "fixed": [
                        {
                            "fixed_commit": "a0e2dab44d22",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.8",
                            "fixed_commit_version": "6.8",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "50f021f0b985",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.215",
                            "fixed_commit_version": "5.10.215",
                            "fixed_commit_upstream_commit": "a0e2dab44d22b913b4c228c8b52b2a104434b0b3"
                        },
                        {
                            "fixed_commit": "d54de9f2a127",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.154",
                            "fixed_commit_version": "5.15.154",
                            "fixed_commit_upstream_commit": "a0e2dab44d22b913b4c228c8b52b2a104434b0b3"
                        },
                        {
                            "fixed_commit": "2e3087505ddb",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.81",
                            "fixed_commit_version": "6.1.81",
                            "fixed_commit_upstream_commit": "a0e2dab44d22b913b4c228c8b52b2a104434b0b3"
                        },
                        {
                            "fixed_commit": "ca13d8cd8dac",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.21",
                            "fixed_commit_version": "6.6.21",
                            "fixed_commit_upstream_commit": "a0e2dab44d22b913b4c228c8b52b2a104434b0b3"
                        },
                        {
                            "fixed_commit": "51eca9f1fd04",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.7.9",
                            "fixed_commit_version": "6.7.9",
                            "fixed_commit_upstream_commit": "a0e2dab44d22b913b4c228c8b52b2a104434b0b3"
                        }
                    ]
                },
                {
                    "description": "x86/bugs: Use code segment selector for VERW operand",
                    "commit": "481b477ab63c7245715a3e57ba79eb87c2dc0d02",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.58",
                    "version": "6.6.58",
                    "upstream_commit": "e4d2102018542e3ae5e297bc6e229303abff8a0f",
                    "fixed": [
                        {
                            "fixed_commit": "a0e2dab44d22",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.8",
                            "fixed_commit_version": "6.8",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "50f021f0b985",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.215",
                            "fixed_commit_version": "5.10.215",
                            "fixed_commit_upstream_commit": "a0e2dab44d22b913b4c228c8b52b2a104434b0b3"
                        },
                        {
                            "fixed_commit": "d54de9f2a127",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.154",
                            "fixed_commit_version": "5.15.154",
                            "fixed_commit_upstream_commit": "a0e2dab44d22b913b4c228c8b52b2a104434b0b3"
                        },
                        {
                            "fixed_commit": "2e3087505ddb",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.81",
                            "fixed_commit_version": "6.1.81",
                            "fixed_commit_upstream_commit": "a0e2dab44d22b913b4c228c8b52b2a104434b0b3"
                        },
                        {
                            "fixed_commit": "ca13d8cd8dac",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.21",
                            "fixed_commit_version": "6.6.21",
                            "fixed_commit_upstream_commit": "a0e2dab44d22b913b4c228c8b52b2a104434b0b3"
                        },
                        {
                            "fixed_commit": "51eca9f1fd04",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.7.9",
                            "fixed_commit_version": "6.7.9",
                            "fixed_commit_upstream_commit": "a0e2dab44d22b913b4c228c8b52b2a104434b0b3"
                        }
                    ]
                }
            ]
        }
    }
}