{
    "CVE-ID": "CVE-2025-71144",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nmptcp: ensure context reset on disconnect()\n\nAfter the blamed commit below, if the MPC subflow is already in TCP_CLOSE\nstatus or has fallback to TCP at mptcp_disconnect() time,\nmptcp_do_fastclose() skips setting the `send_fastclose flag` and the later\n__mptcp_close_ssk() does not reset anymore the related subflow context.\n\nAny later connection will be created with both the `request_mptcp` flag\nand the msk-level fallback status off (it is unconditionally cleared at\nMPTCP disconnect time), leading to a warning in subflow_data_ready():\n\n  WARNING: CPU: 26 PID: 8996 at net/mptcp/subflow.c:1519 subflow_data_ready (net/mptcp/subflow.c:1519 (discriminator 13))\n  Modules linked in:\n  CPU: 26 UID: 0 PID: 8996 Comm: syz.22.39 Not tainted 6.18.0-rc7-05427-g11fc074f6c36 #1 PREEMPT(voluntary)\n  Hardware name: Bochs Bochs, BIOS Bochs 01/01/2011\n  RIP: 0010:subflow_data_ready (net/mptcp/subflow.c:1519 (discriminator 13))\n  Code: 90 0f 0b 90 90 e9 04 fe ff ff e8 b7 1e f5 fe 89 ee bf 07 00 00 00 e8 db 19 f5 fe 83 fd 07 0f 84 35 ff ff ff e8 9d 1e f5 fe 90 <0f> 0b 90 e9 27 ff ff ff e8 8f 1e f5 fe 4c 89 e7 48 89 de e8 14 09\n  RSP: 0018:ffffc9002646fb30 EFLAGS: 00010293\n  RAX: 0000000000000000 RBX: ffff88813b218000 RCX: ffffffff825c8435\n  RDX: ffff8881300b3580 RSI: ffffffff825c8443 RDI: 0000000000000005\n  RBP: 000000000000000b R08: ffffffff825c8435 R09: 000000000000000b\n  R10: 0000000000000005 R11: 0000000000000007 R12: ffff888131ac0000\n  R13: 0000000000000000 R14: 0000000000000000 R15: 0000000000000000\n  FS:  00007f88330af6c0(0000) GS:ffff888a93dd2000(0000) knlGS:0000000000000000\n  CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n  CR2: 00007f88330aefe8 CR3: 000000010ff59000 CR4: 0000000000350ef0\n  Call Trace:\n   <TASK>\n   tcp_data_ready (net/ipv4/tcp_input.c:5356)\n   tcp_data_queue (net/ipv4/tcp_input.c:5445)\n   tcp_rcv_state_process (net/ipv4/tcp_input.c:7165)\n   tcp_v4_do_rcv (net/ipv4/tcp_ipv4.c:1955)\n   __release_sock (include/net/sock.h:1158 (discriminator 6) net/core/sock.c:3180 (discriminator 6))\n   release_sock (net/core/sock.c:3737)\n   mptcp_sendmsg (net/mptcp/protocol.c:1763 net/mptcp/protocol.c:1857)\n   inet_sendmsg (net/ipv4/af_inet.c:853 (discriminator 7))\n   __sys_sendto (net/socket.c:727 (discriminator 15) net/socket.c:742 (discriminator 15) net/socket.c:2244 (discriminator 15))\n   __x64_sys_sendto (net/socket.c:2247)\n   do_syscall_64 (arch/x86/entry/syscall_64.c:63 (discriminator 1) arch/x86/entry/syscall_64.c:94 (discriminator 1))\n   entry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:130)\n  RIP: 0033:0x7f883326702d\n\nAddress the issue setting an explicit `fastclosing` flag at fastclose\ntime, and checking such flag after mptcp_do_fastclose().",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.6.119",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.6.119:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.19:rc3",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.19:rc3:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.19:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.19:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.19:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.19:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.18:rc7",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.18:rc7:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.18:-",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.18:-:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.1.159",
                "VersionEndExcluding": "6.1.164",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.12.60",
                "VersionEndExcluding": "6.12.65",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.17.10",
                "VersionEndExcluding": "6.18",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.18.1",
                "VersionEndExcluding": "6.18.5",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "6.1.164": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.164"
            ]
        },
        "6.12.65": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.65"
            ]
        },
        "6.18.5": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.18.5"
            ]
        },
        "6.19": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.19"
            ]
        },
        "6.6.120": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.120"
            ]
        },
        "commit": {
            "mptcp: ensure context reset on disconnect()": [
                {
                    "description": "mptcp: ensure context reset on disconnect()",
                    "commit": "226fff52e7ed9fc8cd63327133739b3d92537ffd",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.164",
                    "version": "6.1.164",
                    "upstream_commit": "86730ac255b0497a272704de9a1df559f5d6602e",
                    "fixed": [
                        {
                            "fixed_commit": "ae155060247b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.18",
                            "fixed_commit_version": "6.18",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "9ea05fabce31",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.159",
                            "fixed_commit_version": "6.1.159",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        },
                        {
                            "fixed_commit": "f6fb2cbc91a8",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.60",
                            "fixed_commit_version": "6.12.60",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        },
                        {
                            "fixed_commit": "c4f7b0916b95",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.17.10",
                            "fixed_commit_version": "6.17.10",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        },
                        {
                            "fixed_commit": "3a13454fd098",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.119",
                            "fixed_commit_version": "6.6.119",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        }
                    ]
                },
                {
                    "description": "mptcp: ensure context reset on disconnect()",
                    "commit": "1c7c3a9314d8a7fc0e9a508606466a967c8e774a",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.65",
                    "version": "6.12.65",
                    "upstream_commit": "86730ac255b0497a272704de9a1df559f5d6602e",
                    "fixed": [
                        {
                            "fixed_commit": "ae155060247b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.18",
                            "fixed_commit_version": "6.18",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "9ea05fabce31",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.159",
                            "fixed_commit_version": "6.1.159",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        },
                        {
                            "fixed_commit": "f6fb2cbc91a8",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.60",
                            "fixed_commit_version": "6.12.60",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        },
                        {
                            "fixed_commit": "c4f7b0916b95",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.17.10",
                            "fixed_commit_version": "6.17.10",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        },
                        {
                            "fixed_commit": "3a13454fd098",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.119",
                            "fixed_commit_version": "6.6.119",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        }
                    ]
                },
                {
                    "description": "mptcp: ensure context reset on disconnect()",
                    "commit": "f1a77dfc3b045c3dd5f6e64189b9f52b90399f07",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.18.5",
                    "version": "6.18.5",
                    "upstream_commit": "86730ac255b0497a272704de9a1df559f5d6602e",
                    "fixed": [
                        {
                            "fixed_commit": "ae155060247b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.18",
                            "fixed_commit_version": "6.18",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "9ea05fabce31",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.159",
                            "fixed_commit_version": "6.1.159",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        },
                        {
                            "fixed_commit": "f6fb2cbc91a8",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.60",
                            "fixed_commit_version": "6.12.60",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        },
                        {
                            "fixed_commit": "c4f7b0916b95",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.17.10",
                            "fixed_commit_version": "6.17.10",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        },
                        {
                            "fixed_commit": "3a13454fd098",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.119",
                            "fixed_commit_version": "6.6.119",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        }
                    ]
                },
                {
                    "description": "mptcp: ensure context reset on disconnect()",
                    "commit": "86730ac255b0497a272704de9a1df559f5d6602e",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.19",
                    "version": "6.19",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "ae155060247b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.18",
                            "fixed_commit_version": "6.18",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "9ea05fabce31",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.159",
                            "fixed_commit_version": "6.1.159",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        },
                        {
                            "fixed_commit": "f6fb2cbc91a8",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.60",
                            "fixed_commit_version": "6.12.60",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        },
                        {
                            "fixed_commit": "c4f7b0916b95",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.17.10",
                            "fixed_commit_version": "6.17.10",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        },
                        {
                            "fixed_commit": "3a13454fd098",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.119",
                            "fixed_commit_version": "6.6.119",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        }
                    ]
                },
                {
                    "description": "mptcp: ensure context reset on disconnect()",
                    "commit": "5c7c7135468f3fc6379cde9777a2c18bfe92d82f",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.120",
                    "version": "6.6.120",
                    "upstream_commit": "86730ac255b0497a272704de9a1df559f5d6602e",
                    "fixed": [
                        {
                            "fixed_commit": "ae155060247b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.18",
                            "fixed_commit_version": "6.18",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "9ea05fabce31",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.159",
                            "fixed_commit_version": "6.1.159",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        },
                        {
                            "fixed_commit": "f6fb2cbc91a8",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.60",
                            "fixed_commit_version": "6.12.60",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        },
                        {
                            "fixed_commit": "c4f7b0916b95",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.17.10",
                            "fixed_commit_version": "6.17.10",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        },
                        {
                            "fixed_commit": "3a13454fd098",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.119",
                            "fixed_commit_version": "6.6.119",
                            "fixed_commit_upstream_commit": "ae155060247be8dcae3802a95bd1bdf93ab3215d"
                        }
                    ]
                }
            ]
        }
    }
}