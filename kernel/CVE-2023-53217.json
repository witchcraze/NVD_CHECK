{
    "CVE-ID": "CVE-2023-53217",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nnubus: Partially revert proc_create_single_data() conversion\n\nThe conversion to proc_create_single_data() introduced a regression\nwhereby reading a file in /proc/bus/nubus results in a seg fault:\n\n    # grep -r . /proc/bus/nubus/e/\n    Data read fault at 0x00000020 in Super Data (pc=0x1074c2)\n    BAD KERNEL BUSERR\n    Oops: 00000000\n    Modules linked in:\n    PC: [<001074c2>] PDE_DATA+0xc/0x16\n    SR: 2010  SP: 38284958  a2: 01152370\n    d0: 00000001    d1: 01013000    d2: 01002790    d3: 00000000\n    d4: 00000001    d5: 0008ce2e    a0: 00000000    a1: 00222a40\n    Process grep (pid: 45, task=142f8727)\n    Frame format=B ssw=074d isc=2008 isb=4e5e daddr=00000020 dobuf=01199e70\n    baddr=001074c8 dibuf=ffffffff ver=f\n    Stack from 01199e48:\n\t    01199e70 00222a58 01002790 00000000 011a3000 01199eb0 015000c0 00000000\n\t    00000000 01199ec0 01199ec0 000d551a 011a3000 00000001 00000000 00018000\n\t    d003f000 00000003 00000001 0002800d 01052840 01199fa8 c01f8000 00000000\n\t    00000029 0b532b80 00000000 00000000 00000029 0b532b80 01199ee4 00103640\n\t    011198c0 d003f000 00018000 01199fa8 00000000 011198c0 00000000 01199f4c\n\t    000b3344 011198c0 d003f000 00018000 01199fa8 00000000 00018000 011198c0\n    Call Trace: [<00222a58>] nubus_proc_rsrc_show+0x18/0xa0\n     [<000d551a>] seq_read+0xc4/0x510\n     [<00018000>] fp_fcos+0x2/0x82\n     [<0002800d>] __sys_setreuid+0x115/0x1c6\n     [<00103640>] proc_reg_read+0x5c/0xb0\n     [<00018000>] fp_fcos+0x2/0x82\n     [<000b3344>] __vfs_read+0x2c/0x13c\n     [<00018000>] fp_fcos+0x2/0x82\n     [<00018000>] fp_fcos+0x2/0x82\n     [<000b8aa2>] sys_statx+0x60/0x7e\n     [<000b34b6>] vfs_read+0x62/0x12a\n     [<00018000>] fp_fcos+0x2/0x82\n     [<00018000>] fp_fcos+0x2/0x82\n     [<000b39c2>] ksys_read+0x48/0xbe\n     [<00018000>] fp_fcos+0x2/0x82\n     [<000b3a4e>] sys_read+0x16/0x1a\n     [<00018000>] fp_fcos+0x2/0x82\n     [<00002b84>] syscall+0x8/0xc\n     [<00018000>] fp_fcos+0x2/0x82\n     [<0000c016>] not_ext+0xa/0x18\n    Code: 4e5e 4e75 4e56 0000 206e 0008 2068 ffe8 <2068> 0020 2008 4e5e 4e75 4e56 0000 2f0b 206e 0008 2068 0004 2668 0020 206b ffe8\n    Disabling lock debugging due to kernel taint\n\n    Segmentation fault\n\nThe proc_create_single_data() conversion does not work because\nsingle_open(file, nubus_proc_rsrc_show, PDE_DATA(inode)) is not\nequivalent to the original code.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 7.8,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.18",
                "VersionEndExcluding": "5.10.188",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.120",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.1.38",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.3.12",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.4",
                "VersionEndExcluding": "6.4.2",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.10.188": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.188"
            ]
        },
        "5.15.120": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.120"
            ]
        },
        "6.1.38": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.38"
            ]
        },
        "6.3.12": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.3.12"
            ]
        },
        "6.4.2": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.4.2"
            ]
        },
        "6.5": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.5"
            ]
        },
        "commit": {
            "nubus: Partially revert proc_create_single_data() conversion": [
                {
                    "description": "nubus: Partially revert proc_create_single_data() conversion",
                    "commit": "f70407e8e0272e00d133c5e039168ff1bae6bcac",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.188",
                    "version": "5.10.188",
                    "upstream_commit": "0e96647cff9224db564a1cee6efccb13dbe11ee2",
                    "fixed": [
                        {
                            "fixed_commit": "3f3942aca6da",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/3f3942aca6da",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "nubus: Partially revert proc_create_single_data() conversion",
                    "commit": "c06edf13f4cf7f9e8ff4bc6f7e951e4f074dc105",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.120",
                    "version": "5.15.120",
                    "upstream_commit": "0e96647cff9224db564a1cee6efccb13dbe11ee2",
                    "fixed": [
                        {
                            "fixed_commit": "3f3942aca6da",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/3f3942aca6da",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "nubus: Partially revert proc_create_single_data() conversion",
                    "commit": "67e3b5230cefed1eca470c460a2035f02986cebb",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.38",
                    "version": "6.1.38",
                    "upstream_commit": "0e96647cff9224db564a1cee6efccb13dbe11ee2",
                    "fixed": [
                        {
                            "fixed_commit": "3f3942aca6da",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/3f3942aca6da",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "nubus: Partially revert proc_create_single_data() conversion",
                    "commit": "9877533e1401dbbb2c7da8badda05d196aa07623",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.3.12",
                    "version": "6.3.12",
                    "upstream_commit": "0e96647cff9224db564a1cee6efccb13dbe11ee2",
                    "fixed": [
                        {
                            "fixed_commit": "3f3942aca6da",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/3f3942aca6da",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "nubus: Partially revert proc_create_single_data() conversion",
                    "commit": "a03f2f4bd49030f57849227be9ba38a3eb1edb61",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.4.2",
                    "version": "6.4.2",
                    "upstream_commit": "0e96647cff9224db564a1cee6efccb13dbe11ee2",
                    "fixed": [
                        {
                            "fixed_commit": "3f3942aca6da",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/3f3942aca6da",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "nubus: Partially revert proc_create_single_data() conversion",
                    "commit": "0e96647cff9224db564a1cee6efccb13dbe11ee2",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.5",
                    "version": "6.5",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "3f3942aca6da",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/3f3942aca6da",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}