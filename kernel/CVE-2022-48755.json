{
    "CVE-ID": "CVE-2022-48755",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\npowerpc64/bpf: Limit 'ldbrx' to processors compliant with ISA v2.06\n\nJohan reported the below crash with test_bpf on ppc64 e5500:\n\n  test_bpf: #296 ALU_END_FROM_LE 64: 0x0123456789abcdef -> 0x67452301 jited:1\n  Oops: Exception in kernel mode, sig: 4 [#1]\n  BE PAGE_SIZE=4K SMP NR_CPUS=24 QEMU e500\n  Modules linked in: test_bpf(+)\n  CPU: 0 PID: 76 Comm: insmod Not tainted 5.14.0-03771-g98c2059e008a-dirty #1\n  NIP:  8000000000061c3c LR: 80000000006dea64 CTR: 8000000000061c18\n  REGS: c0000000032d3420 TRAP: 0700   Not tainted (5.14.0-03771-g98c2059e008a-dirty)\n  MSR:  0000000080089000 <EE,ME>  CR: 88002822  XER: 20000000 IRQMASK: 0\n  <...>\n  NIP [8000000000061c3c] 0x8000000000061c3c\n  LR [80000000006dea64] .__run_one+0x104/0x17c [test_bpf]\n  Call Trace:\n   .__run_one+0x60/0x17c [test_bpf] (unreliable)\n   .test_bpf_init+0x6a8/0xdc8 [test_bpf]\n   .do_one_initcall+0x6c/0x28c\n   .do_init_module+0x68/0x28c\n   .load_module+0x2460/0x2abc\n   .__do_sys_init_module+0x120/0x18c\n   .system_call_exception+0x110/0x1b8\n   system_call_common+0xf0/0x210\n  --- interrupt: c00 at 0x101d0acc\n  <...>\n  ---[ end trace 47b2bf19090bb3d0 ]---\n\n  Illegal instruction\n\nThe illegal instruction turned out to be 'ldbrx' emitted for\nBPF_FROM_[L|B]E, which was only introduced in ISA v2.06. Guard use of\nthe same and implement an alternative approach for older processors.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:5.17:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:5.17:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.8",
                "VersionEndExcluding": "5.10.96",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.19",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "5.16.5",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "5.10.96": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.96"
            ]
        },
        "5.15.19": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.19"
            ]
        },
        "5.16.5": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16.5"
            ]
        },
        "5.17": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17"
            ]
        },
        "commit": {
            "powerpc64/bpf: Limit 'ldbrx' to processors compliant with ISA v2.06": [
                {
                    "description": "powerpc64/bpf: Limit 'ldbrx' to processors compliant with ISA v2.06",
                    "commit": "129c71829d7f46423d95c19e8d87ce956d4c6e1c",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.96",
                    "version": "5.10.96",
                    "upstream_commit": "3f5f766d5f7f95a69a630da3544a1a0cee1cdddf",
                    "fixed": [
                        {
                            "fixed_commit": "156d0e290e96",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/156d0e290e96",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "powerpc64/bpf: Limit 'ldbrx' to processors compliant with ISA v2.06",
                    "commit": "3bfbc00587dc883eaed383558ae512a351c2cd09",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.19",
                    "version": "5.15.19",
                    "upstream_commit": "3f5f766d5f7f95a69a630da3544a1a0cee1cdddf",
                    "fixed": [
                        {
                            "fixed_commit": "156d0e290e96",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/156d0e290e96",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "powerpc64/bpf: Limit 'ldbrx' to processors compliant with ISA v2.06",
                    "commit": "aaccfeeee1630b155e8ff0d6c449d3de1ef86e73",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.16.5",
                    "version": "5.16.5",
                    "upstream_commit": "3f5f766d5f7f95a69a630da3544a1a0cee1cdddf",
                    "fixed": [
                        {
                            "fixed_commit": "156d0e290e96",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/156d0e290e96",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                },
                {
                    "description": "powerpc64/bpf: Limit 'ldbrx' to processors compliant with ISA v2.06",
                    "commit": "3f5f766d5f7f95a69a630da3544a1a0cee1cdddf",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.17",
                    "version": "5.17",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "156d0e290e96",
                            "fixed_commit_source": "https://github.com/torvalds/linux/commit/156d0e290e96",
                            "fixed_commit_version": "-",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}