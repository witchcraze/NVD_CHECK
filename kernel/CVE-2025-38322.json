{
    "CVE-ID": "CVE-2025-38322",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nperf/x86/intel: Fix crash in icl_update_topdown_event()\n\nThe perf_fuzzer found a hard-lockup crash on a RaptorLake machine:\n\n  Oops: general protection fault, maybe for address 0xffff89aeceab400: 0000\n  CPU: 23 UID: 0 PID: 0 Comm: swapper/23\n  Tainted: [W]=WARN\n  Hardware name: Dell Inc. Precision 9660/0VJ762\n  RIP: 0010:native_read_pmc+0x7/0x40\n  Code: cc e8 8d a9 01 00 48 89 03 5b cd cc cc cc cc 0f 1f ...\n  RSP: 000:fffb03100273de8 EFLAGS: 00010046\n  ....\n  Call Trace:\n    <TASK>\n    icl_update_topdown_event+0x165/0x190\n    ? ktime_get+0x38/0xd0\n    intel_pmu_read_event+0xf9/0x210\n    __perf_event_read+0xf9/0x210\n\nCPUs 16-23 are E-core CPUs that don't support the perf metrics feature.\nThe icl_update_topdown_event() should not be invoked on these CPUs.\n\nIt's a regression of commit:\n\n  f9bdf1f95339 (\"perf/x86/intel: Avoid disable PMU if !cpuc->enabled in sample read\")\n\nThe bug introduced by that commit is that the is_topdown_event() function\nis mistakenly used to replace the is_topdown_count() call to check if the\ntopdown functions for the perf metrics feature should be invoked.\n\nFix it.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 5.5,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel:6.16:rc2",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.16:rc2:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel:6.16:rc1",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:6.16:rc1:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.1.134",
                "VersionEndExcluding": "6.1.149",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.12.23",
                "VersionEndExcluding": "6.12.49",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.13.11",
                "VersionEndExcluding": "6.14",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.14.2",
                "VersionEndExcluding": "6.15.4",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.6.87",
                "VersionEndExcluding": "6.6.101",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:debian:debian_linux:11.0",
                "FormattedString": "cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "6.1.149": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.149"
            ]
        },
        "6.12.49": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.49"
            ]
        },
        "6.15.4": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.15.4"
            ]
        },
        "6.16": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.16"
            ]
        },
        "6.6.101": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.101"
            ]
        },
        "commit": {
            "perf/x86/intel: Fix crash in icl_update_topdown_event()": [
                {
                    "description": "perf/x86/intel: Fix crash in icl_update_topdown_event()",
                    "commit": "702ea6028032d6c1fe96c2d4762a3575e3654819",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.149",
                    "version": "6.1.149",
                    "upstream_commit": "b0823d5fbacb1c551d793cbfe7af24e0d1fa45ed",
                    "fixed": [
                        {
                            "fixed_commit": "f9bdf1f95339",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.15",
                            "fixed_commit_version": "6.15",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "781b2db0eb77",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.134",
                            "fixed_commit_version": "6.1.134",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "3a8bec6583e5",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.23",
                            "fixed_commit_version": "6.12.23",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "06cd7bfbb86e",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.13.11",
                            "fixed_commit_version": "6.13.11",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "d8370aa704bd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.14.2",
                            "fixed_commit_version": "6.14.2",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "e7f6922c8a5b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.87",
                            "fixed_commit_version": "6.6.87",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        }
                    ]
                },
                {
                    "description": "perf/x86/intel: Fix crash in icl_update_topdown_event()",
                    "commit": "e97c45c770f5e56c784a46c2a96ab968d26b97d9",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.49",
                    "version": "6.12.49",
                    "upstream_commit": "b0823d5fbacb1c551d793cbfe7af24e0d1fa45ed",
                    "fixed": [
                        {
                            "fixed_commit": "f9bdf1f95339",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.15",
                            "fixed_commit_version": "6.15",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "781b2db0eb77",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.134",
                            "fixed_commit_version": "6.1.134",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "3a8bec6583e5",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.23",
                            "fixed_commit_version": "6.12.23",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "06cd7bfbb86e",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.13.11",
                            "fixed_commit_version": "6.13.11",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "d8370aa704bd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.14.2",
                            "fixed_commit_version": "6.14.2",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "e7f6922c8a5b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.87",
                            "fixed_commit_version": "6.6.87",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        }
                    ]
                },
                {
                    "description": "perf/x86/intel: Fix crash in icl_update_topdown_event()",
                    "commit": "a85cc69acdcb05f8cd226b8ea0778b8e2e887e6f",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.15.4",
                    "version": "6.15.4",
                    "upstream_commit": "b0823d5fbacb1c551d793cbfe7af24e0d1fa45ed",
                    "fixed": [
                        {
                            "fixed_commit": "f9bdf1f95339",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.15",
                            "fixed_commit_version": "6.15",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "781b2db0eb77",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.134",
                            "fixed_commit_version": "6.1.134",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "3a8bec6583e5",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.23",
                            "fixed_commit_version": "6.12.23",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "06cd7bfbb86e",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.13.11",
                            "fixed_commit_version": "6.13.11",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "d8370aa704bd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.14.2",
                            "fixed_commit_version": "6.14.2",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "e7f6922c8a5b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.87",
                            "fixed_commit_version": "6.6.87",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        }
                    ]
                },
                {
                    "description": "perf/x86/intel: Fix crash in icl_update_topdown_event()",
                    "commit": "b0823d5fbacb1c551d793cbfe7af24e0d1fa45ed",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.16",
                    "version": "6.16",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "f9bdf1f95339",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.15",
                            "fixed_commit_version": "6.15",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "781b2db0eb77",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.134",
                            "fixed_commit_version": "6.1.134",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "3a8bec6583e5",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.23",
                            "fixed_commit_version": "6.12.23",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "06cd7bfbb86e",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.13.11",
                            "fixed_commit_version": "6.13.11",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "d8370aa704bd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.14.2",
                            "fixed_commit_version": "6.14.2",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "e7f6922c8a5b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.87",
                            "fixed_commit_version": "6.6.87",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        }
                    ]
                },
                {
                    "description": "perf/x86/intel: Fix crash in icl_update_topdown_event()",
                    "commit": "79e2dd573116d3338507c311460da9669095c94d",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.101",
                    "version": "6.6.101",
                    "upstream_commit": "b0823d5fbacb1c551d793cbfe7af24e0d1fa45ed",
                    "fixed": [
                        {
                            "fixed_commit": "f9bdf1f95339",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.15",
                            "fixed_commit_version": "6.15",
                            "fixed_commit_upstream_commit": []
                        },
                        {
                            "fixed_commit": "781b2db0eb77",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.134",
                            "fixed_commit_version": "6.1.134",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "3a8bec6583e5",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.12.23",
                            "fixed_commit_version": "6.12.23",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "06cd7bfbb86e",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.13.11",
                            "fixed_commit_version": "6.13.11",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "d8370aa704bd",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.14.2",
                            "fixed_commit_version": "6.14.2",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        },
                        {
                            "fixed_commit": "e7f6922c8a5b",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.6.87",
                            "fixed_commit_version": "6.6.87",
                            "fixed_commit_upstream_commit": "f9bdf1f953392c9edd69a7f884f78c0390127029"
                        }
                    ]
                }
            ]
        }
    }
}