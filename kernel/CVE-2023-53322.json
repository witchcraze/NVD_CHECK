{
    "CVE-ID": "CVE-2023-53322",
    "NVD": {
        "Descriptions": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: qla2xxx: Wait for io return on terminate rport\n\nSystem crash due to use after free.\nCurrent code allows terminate_rport_io to exit before making\nsure all IOs has returned. For FCP-2 device, IO's can hang\non in HW because driver has not tear down the session in FW at\nfirst sign of cable pull. When dev_loss_tmo timer pops,\nterminate_rport_io is called and upper layer is about to\nfree various resources. Terminate_rport_io trigger qla to do\nthe final cleanup, but the cleanup might not be fast enough where it\nleave qla still holding on to the same resource.\n\nWait for IO's to return to upper layer before resources are freed.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 7.8,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
        "CPEs": [
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "",
                "VersionEndExcluding": "4.14.322",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.15",
                "VersionEndExcluding": "4.19.291",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "4.20",
                "VersionEndExcluding": "5.4.251",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.11",
                "VersionEndExcluding": "5.15.121",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.16",
                "VersionEndExcluding": "6.1.40",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "5.5",
                "VersionEndExcluding": "5.10.188",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/o:linux:linux_kernel",
                "FormattedString": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "6.2",
                "VersionEndExcluding": "6.4.5",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "4.14.322": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.14.322"
            ]
        },
        "4.19.291": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.291"
            ]
        },
        "5.10.188": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.188"
            ]
        },
        "5.15.121": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.121"
            ]
        },
        "5.4.251": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.251"
            ]
        },
        "6.1.40": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.40"
            ]
        },
        "6.4.5": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.4.5"
            ]
        },
        "6.5": {
            "source": [
                "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.5"
            ]
        },
        "commit": {
            "scsi: qla2xxx: Wait for io return on terminate rport": [
                {
                    "description": "scsi: qla2xxx: Wait for io return on terminate rport",
                    "commit": "8a55556cd7e0220486163b1285ce11a8be2ce5fa",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.14.322",
                    "version": "4.14.322",
                    "upstream_commit": "fc0cba0c7be8261a1625098bd1d695077ec621c9",
                    "fixed": []
                },
                {
                    "description": "scsi: qla2xxx: Wait for io return on terminate rport",
                    "commit": "4647d2e88918a078359d1532d90c417a38542c9e",
                    "source": "https://www.kernel.org/pub//linux/kernel/v4.x/ChangeLog-4.19.291",
                    "version": "4.19.291",
                    "upstream_commit": "fc0cba0c7be8261a1625098bd1d695077ec621c9",
                    "fixed": []
                },
                {
                    "description": "scsi: qla2xxx: Wait for io return on terminate rport",
                    "commit": "a9fe97fb7b4ee21bffb76f2acb05769bad27ae70",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.10.188",
                    "version": "5.10.188",
                    "upstream_commit": "fc0cba0c7be8261a1625098bd1d695077ec621c9",
                    "fixed": []
                },
                {
                    "description": "scsi: qla2xxx: Wait for io return on terminate rport",
                    "commit": "079c8264ed9fea8cbcac01ad29040f901cbc3692",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.15.121",
                    "version": "5.15.121",
                    "upstream_commit": "fc0cba0c7be8261a1625098bd1d695077ec621c9",
                    "fixed": []
                },
                {
                    "description": "scsi: qla2xxx: Wait for io return on terminate rport",
                    "commit": "d25fded78d88e1515439b3ba581684d683e0b6ab",
                    "source": "https://www.kernel.org/pub//linux/kernel/v5.x/ChangeLog-5.4.251",
                    "version": "5.4.251",
                    "upstream_commit": "fc0cba0c7be8261a1625098bd1d695077ec621c9",
                    "fixed": []
                },
                {
                    "description": "scsi: qla2xxx: Wait for io return on terminate rport",
                    "commit": "90770dad1eb30967ebd8d37d82830bcf270b3293",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.1.40",
                    "version": "6.1.40",
                    "upstream_commit": "fc0cba0c7be8261a1625098bd1d695077ec621c9",
                    "fixed": []
                },
                {
                    "description": "scsi: qla2xxx: Wait for io return on terminate rport",
                    "commit": "5bcdaafd92be6035ddc77fa76650cf9dd5b864c4",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.4.5",
                    "version": "6.4.5",
                    "upstream_commit": "fc0cba0c7be8261a1625098bd1d695077ec621c9",
                    "fixed": []
                },
                {
                    "description": "scsi: qla2xxx: Wait for io return on terminate rport",
                    "commit": "fc0cba0c7be8261a1625098bd1d695077ec621c9",
                    "source": "https://www.kernel.org/pub//linux/kernel/v6.x/ChangeLog-6.5",
                    "version": "6.5",
                    "upstream_commit": "",
                    "fixed": [
                        {
                            "fixed_commit": "1da177e4c3f4",
                            "fixed_commit_source": "https://www.kernel.org/pub//linux/kernel/v2.6/ChangeLog-2.6.12",
                            "fixed_commit_version": "2.6.12",
                            "fixed_commit_upstream_commit": []
                        }
                    ]
                }
            ]
        }
    }
}