{
    "CVE-ID": "CVE-2024-7348",
    "NVD": {
        "Descriptions": "Time-of-check Time-of-use (TOCTOU) race condition in pg_dump in PostgreSQL allows an object creator to execute arbitrary SQL functions as the user running pg_dump, which is often a superuser. The attack involves replacing another relation type with a view or foreign table. The attack requires waiting for pg_dump to start, but winning the race condition is trivial if the attacker retains an open transaction. Versions before PostgreSQL 16.4, 15.8, 14.13, 13.16, and 12.20 are affected.",
        "Cvss2_BaseScore": 0,
        "Cvss3_BaseScore": 8.8,
        "Cvss2_VectorString": "",
        "Cvss3_VectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
        "CPEs": [
            {
                "URI": "cpe:/a:postgresql:postgresql",
                "FormattedString": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "12.0",
                "VersionEndExcluding": "12.20",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/a:postgresql:postgresql",
                "FormattedString": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "13.0",
                "VersionEndExcluding": "13.16",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/a:postgresql:postgresql",
                "FormattedString": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "14.0",
                "VersionEndExcluding": "14.13",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/a:postgresql:postgresql",
                "FormattedString": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "15.0",
                "VersionEndExcluding": "15.8",
                "VersionEndIncluding": ""
            },
            {
                "URI": "cpe:/a:postgresql:postgresql",
                "FormattedString": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
                "VersionStartExcluding": "",
                "VersionStartIncluding": "16.0",
                "VersionEndExcluding": "16.4",
                "VersionEndIncluding": ""
            }
        ]
    },
    "Official": {
        "12.20": {
            "source": [
                "https://www.postgresql.org/support/security/12/",
                "https://www.postgresql.org/docs/release/12.20/"
            ]
        },
        "13.16": {
            "source": [
                "https://www.postgresql.org/support/security/13/",
                "https://www.postgresql.org/docs/release/13.16/"
            ]
        },
        "14.13": {
            "source": [
                "https://www.postgresql.org/support/security/14/",
                "https://www.postgresql.org/docs/release/14.13/"
            ]
        },
        "15.8": {
            "source": [
                "https://www.postgresql.org/support/security/15/",
                "https://www.postgresql.org/docs/release/15.8/"
            ]
        },
        "16.4": {
            "source": [
                "https://www.postgresql.org/support/security/16/",
                "https://www.postgresql.org/docs/release/16.4/"
            ]
        }
    }
}